<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_ipu9j6v6y2z4-3>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-3}ol.lst-kix_ipu9j6v6y2z4-7.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-7 0}ul.lst-kix_461jdmrtv6n0-0{list-style-type:none}.lst-kix_ipu9j6v6y2z4-8>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-8}.lst-kix_ayy1qmcnnzr1-8>li:before{content:"\0025a0  "}.lst-kix_ipu9j6v6y2z4-2>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-2}ul.lst-kix_461jdmrtv6n0-8{list-style-type:none}ul.lst-kix_461jdmrtv6n0-7{list-style-type:none}ul.lst-kix_461jdmrtv6n0-6{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-0.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-0 0}ol.lst-kix_ipu9j6v6y2z4-3.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-3 0}.lst-kix_ayy1qmcnnzr1-6>li:before{content:"\0025cf  "}ul.lst-kix_461jdmrtv6n0-5{list-style-type:none}ul.lst-kix_461jdmrtv6n0-4{list-style-type:none}.lst-kix_ayy1qmcnnzr1-7>li:before{content:"\0025cb  "}ul.lst-kix_461jdmrtv6n0-3{list-style-type:none}ul.lst-kix_461jdmrtv6n0-2{list-style-type:none}ul.lst-kix_461jdmrtv6n0-1{list-style-type:none}.lst-kix_461jdmrtv6n0-4>li:before{content:"\0025cb  "}ul.lst-kix_ayy1qmcnnzr1-5{list-style-type:none}.lst-kix_gx09mwwjq6mr-6>li:before{content:"\0025cf  "}.lst-kix_gx09mwwjq6mr-7>li:before{content:"\0025cb  "}ul.lst-kix_ayy1qmcnnzr1-6{list-style-type:none}.lst-kix_461jdmrtv6n0-3>li:before{content:"\0025cf  "}.lst-kix_461jdmrtv6n0-5>li:before{content:"\0025a0  "}ul.lst-kix_ayy1qmcnnzr1-3{list-style-type:none}ul.lst-kix_ayy1qmcnnzr1-4{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-5{list-style-type:none}ul.lst-kix_ayy1qmcnnzr1-1{list-style-type:none}.lst-kix_gx09mwwjq6mr-4>li:before{content:"\0025cb  "}.lst-kix_gx09mwwjq6mr-5>li:before{content:"\0025a0  "}.lst-kix_gx09mwwjq6mr-8>li:before{content:"\0025a0  "}ol.lst-kix_ipu9j6v6y2z4-6{list-style-type:none}ul.lst-kix_ayy1qmcnnzr1-2{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-7{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-8{list-style-type:none}ul.lst-kix_ayy1qmcnnzr1-0{list-style-type:none}.lst-kix_461jdmrtv6n0-0>li:before{content:"\0025cf  "}ol.lst-kix_ipu9j6v6y2z4-1{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-2{list-style-type:none}.lst-kix_461jdmrtv6n0-1>li:before{content:"\0025cb  "}ol.lst-kix_ipu9j6v6y2z4-3{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-4{list-style-type:none}.lst-kix_461jdmrtv6n0-2>li:before{content:"\0025a0  "}ul.lst-kix_ayy1qmcnnzr1-7{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-0{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-6.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-6 0}ul.lst-kix_ayy1qmcnnzr1-8{list-style-type:none}.lst-kix_gx09mwwjq6mr-0>li:before{content:"\0025cf  "}.lst-kix_gx09mwwjq6mr-1>li:before{content:"\0025cb  "}.lst-kix_gx09mwwjq6mr-2>li:before{content:"\0025a0  "}.lst-kix_gx09mwwjq6mr-3>li:before{content:"\0025cf  "}.lst-kix_ipu9j6v6y2z4-0>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-0}ol.lst-kix_ipu9j6v6y2z4-2.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-2 0}.lst-kix_ipu9j6v6y2z4-6>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-6}ul.lst-kix_gx09mwwjq6mr-7{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-5.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-5 0}ul.lst-kix_gx09mwwjq6mr-6{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-5{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-4{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-3{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-2{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-1{list-style-type:none}ul.lst-kix_gx09mwwjq6mr-0{list-style-type:none}.lst-kix_ipu9j6v6y2z4-6>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-6,decimal) ". "}.lst-kix_461jdmrtv6n0-7>li:before{content:"\0025cb  "}.lst-kix_461jdmrtv6n0-6>li:before{content:"\0025cf  "}.lst-kix_ipu9j6v6y2z4-5>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-5}.lst-kix_ipu9j6v6y2z4-7>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-7,lower-latin) ". "}.lst-kix_ipu9j6v6y2z4-8>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-8,lower-roman) ". "}ul.lst-kix_gx09mwwjq6mr-8{list-style-type:none}ol.lst-kix_ipu9j6v6y2z4-8.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-8 0}.lst-kix_ayy1qmcnnzr1-1>li:before{content:"\0025cb  "}.lst-kix_ayy1qmcnnzr1-0>li:before{content:"\0025cf  "}.lst-kix_ayy1qmcnnzr1-2>li:before{content:"\0025a0  "}.lst-kix_461jdmrtv6n0-8>li:before{content:"\0025a0  "}.lst-kix_ayy1qmcnnzr1-5>li:before{content:"\0025a0  "}.lst-kix_ipu9j6v6y2z4-4>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-4}.lst-kix_ipu9j6v6y2z4-7>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-7}.lst-kix_ipu9j6v6y2z4-1>li{counter-increment:lst-ctn-kix_ipu9j6v6y2z4-1}.lst-kix_ipu9j6v6y2z4-5>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-5,lower-roman) ". "}.lst-kix_ayy1qmcnnzr1-4>li:before{content:"\0025cb  "}ol.lst-kix_ipu9j6v6y2z4-1.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-1 0}.lst-kix_ipu9j6v6y2z4-4>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-4,lower-latin) ". "}.lst-kix_ayy1qmcnnzr1-3>li:before{content:"\0025cf  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_ipu9j6v6y2z4-2>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-2,lower-roman) ". "}.lst-kix_ipu9j6v6y2z4-1>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-1,lower-latin) ". "}.lst-kix_ipu9j6v6y2z4-3>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-3,decimal) ". "}.lst-kix_ipu9j6v6y2z4-0>li:before{content:"" counter(lst-ctn-kix_ipu9j6v6y2z4-0,decimal) ". "}ol.lst-kix_ipu9j6v6y2z4-4.start{counter-reset:lst-ctn-kix_ipu9j6v6y2z4-4 0}ol{margin:0;padding:0}table td,table th{padding:0}.c15{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c7{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c12{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c38{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c36{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.0;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c1{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-top-style:solid;background-color:#ffffff;margin-left:54pt;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c46{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:128.2pt;border-top-color:#000000;border-bottom-style:solid}.c26{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:216.8pt;border-top-color:#000000;border-bottom-style:solid}.c33{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:80.2pt;border-top-color:#000000;border-bottom-style:solid}.c48{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:128.2pt;border-top-color:#000000;border-bottom-style:solid}.c31{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:216.8pt;border-top-color:#000000;border-bottom-style:solid}.c50{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:80.2pt;border-top-color:#000000;border-bottom-style:solid}.c9{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c16{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c2{background-color:#eef2f6;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Courier New";font-style:normal}.c19{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:54pt;font-family:"Times New Roman";font-style:normal}.c34{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman"}.c5{color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c22{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman"}.c10{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:23.5pt;font-family:"Times New Roman";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c0{padding-top:24pt;padding-bottom:42pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c18{color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman"}.c11{padding-top:24pt;padding-bottom:24pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c35{padding-top:18pt;padding-bottom:18pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c23{color:#3d3b49;font-weight:700;font-size:14.5pt;font-family:"Times New Roman";font-style:normal}.c6{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c39{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:400}.c44{color:#3d3b49;font-weight:700;font-size:40.5pt;font-family:"Times New Roman";font-style:normal}.c21{background-color:#eef2f6;color:#188038;font-weight:400;font-size:9pt;font-family:"Courier New"}.c52{background-color:#000000;color:#ffffff;font-weight:700;font-size:10pt;font-family:"Arial"}.c51{background-color:#000000;color:#ffffff;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c30{font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c40{border-spacing:0;border-collapse:collapse;margin-right:auto}.c8{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c29{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c41{color:#3d3b49;font-weight:400;font-size:9pt;font-family:"Times New Roman"}.c53{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c32{font-size:12pt;color:#3d3b49;font-weight:700}.c43{background-color:#eef2f6;font-family:"Courier New";font-style:normal}.c4{color:inherit;text-decoration:inherit}.c20{text-decoration:none;vertical-align:baseline}.c27{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c13{background-color:#ffffff;text-indent:12pt}.c28{padding:0;margin:0}.c45{background-color:#eef2f6;font-family:"Courier New"}.c42{margin-right:18pt;margin-left:18pt}.c37{height:11pt}.c17{background-color:#ffffff}.c25{height:63pt}.c49{height:147pt}.c14{font-style:italic}.c24{height:42pt}.c47{font-style:normal}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c17 c27 doc-content"><h1 class="c38" id="h.7i1561bq8xmw"><span class="c17 c19">7</span></h1><h1 class="c38" id="h.7i1561bq8xmw-1"><span class="c20 c17 c44">ENDPOINT ANALYSIS</span></h1><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 610.67px; height: 800.00px;"><img alt="" src="images/image12.png" style="width: 610.67px; height: 800.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7 c17"><span class="c5">Now that you&rsquo;ve discovered a few APIs, it&rsquo;s time to begin using and testing the endpoints you&rsquo;ve found. This chapter will cover interacting with endpoints, testing them for vulnerabilities, and maybe even scoring some early wins.</span></p><p class="c7 c13"><span class="c5">By &ldquo;early wins,&rdquo; I mean critical vulnerabilities or data leaks sometimes present during this stage of testing. APIs are a special sort of target because you may not need advanced skills to bypass firewalls and endpoint security; instead, you may just need to know how to use an endpoint as it was designed.</span></p><p class="c7 c13"><span class="c5">We&rsquo;ll begin by learning how to discover the format of an API&rsquo;s numerous requests from its documentation, its specification, and reverse engineering, and we&rsquo;ll use these sources to build Postman collections so we can perform analysis across each request. Then we&rsquo;ll walk through a simple process you can use to begin your API testing and discuss how you might find your first vulnerabilities, such as information disclosures, security misconfigurations, excessive data exposures, and business logic flaws.</span></p><h2 class="c15" id="h.2fd3dds9u804"><span class="c10">Finding Request Information</span></h2><p class="c7 c17"><span class="c5">If you&rsquo;re used to attacking web applications, your hunt for API vulnerabilities should be somewhat familiar. The primary difference is that you no longer have obvious GUI cues such as search bars, login fields, and buttons for uploading files. API hacking relies on the backend operations of those items that are found in the GUI&mdash;namely, GET requests with query parameters and most POST/PUT/UPDATE/DELETE requests.</span></p><p class="c7 c13"><span class="c5">Before you craft requests to an API, you&rsquo;ll need an understanding of its endpoints, request parameters, necessary headers, authentication requirements, and administrative functionality. Documentation will often point us to those elements. Therefore, to succeed as an API hacker, you&rsquo;ll need to know how to read and use API documentation, as well as how to find it. Even better, if you can find a specification for an API, you can import it directly into Postman to automatically craft requests.</span></p><p class="c7 c13"><span class="c5">When you&rsquo;re performing a black box API test and the documentation is truly unavailable, you&rsquo;ll be left to reverse engineer the API requests on your own. You will need to thoroughly fuzz your way through the API to discover endpoints, parameters, and header requirements in order to map out the API and its functionality.</span></p><h3 class="c15" id="h.1cqyw04h13n6"><span class="c23 c20">Finding Information in Documentation</span></h3><p class="c7 c17"><span class="c5">As you know by now, an API&rsquo;s documentation is a set of instructions published by the API provider for the API consumer. Because public and partner APIs are designed with self-service in mind, a public user or a partner should be able to find the documentation, understand how to use the API, and do so without assistance from the provider. It is quite common for the documentation to be located under directories like the following:</span></p><ol class="c28 lst-kix_ipu9j6v6y2z4-0 start" start="1"><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://example.com/docs</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://example.com/api/docs</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://docs.example.com</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://dev.example.com/docs</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://developer.example.com/docs</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://api.example.com/docs</span></li><li class="c1 li-bullet-0"><span class="c8 c20 c14">https://example.com/developers/documentation</span></li></ol><p class="c7 c13"><span class="c8">When the documentation is not publicly available, try creating an account and searching for the documentation while authenticated. If you still cannot find the docs, I have provided a couple API wordlists on GitHub that can help you discover API documentation through the use of a fuzzing technique called </span><span class="c8 c14">directory brute force</span><span class="c8">&nbsp;(</span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://github.com/hAPI-hacker/Hacking-APIs&amp;sa=D&amp;source=editors&amp;ust=1681144458090128&amp;usg=AOvVaw1vtIMCETPMfji7QewtvDLl">https://github.com/hAPI-hacker/Hacking-APIs</a></span><span class="c8">). You can use the </span><span class="c6">subdomains_list</span><span class="c8">&nbsp;and the </span><span class="c6">dir_list</span><span class="c5">&nbsp;to brute-force web application subdomains and domains and potentially find API docs hosted on the site. There is a good chance you&rsquo;ll be able to discover documentation during reconnaissance and web application scanning.</span></p><p class="c7 c13"><span class="c8">If an organization&rsquo;s documentation really is locked down, you still have a few options. First, try using your Google hacking skills to find it on search engines and in other recon tools. Second, use the Wayback Machine (</span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://web.archive.org/&amp;sa=D&amp;source=editors&amp;ust=1681144458090703&amp;usg=AOvVaw1GLl2chYH2WO_IBO_9758I">https://web.archive.org/</a></span><span class="c5">). If your target once posted their API documentation publicly and later retracted it, there may be an archive of their docs available. Archived documentation will likely be outdated, but it should give you an idea of the authentication requirements, naming schemes, and endpoint locations. Third, when permitted, try social engineering techniques to trick an organization into sharing its documentation. These techniques are beyond the scope of this book, but you can get creative with smishing, vishing, and phishing developers, sales departments, and organization partners for access to the API documentation. Act like a new customer trying to work with the target API.</span></p><h2 class="c36" id="h.l1yu3b3y6cqd"><span class="c20 c47 c52">NOTE</span></h2><p class="c7"><span class="c8 c17 c14 c20">API documentation is only a starting point. Never trust that the docs are accurate and up-to-date or that they include everything there is to know about the endpoints. Always test for methods, endpoints, and parameters that are not included in documentation. Distrust and verify.</span></p><p class="c7 c13"><span class="c8">Although API documentation is straightforward, there are a few elements to look out for. The</span><span class="c29">&nbsp;</span><span class="c8 c14">overview</span><span class="c29">&nbsp;</span><span class="c8">is</span><span class="c29">&nbsp;</span><span class="c5">typically the first section of API documentation. Normally found at the beginning of the doc, the overview will provide a high-level introduction of how to connect and use the API. In addition, it could contain information about authentication and rate limiting.</span></p><p class="c7 c13"><span class="c8">Review the documentation for </span><span class="c8 c14">functionality</span><span class="c5">, or the actions that you can take using the given API. These will be represented by a combination of an HTTP method (GET, PUT, POST, DELETE) and an endpoint. Every organization&rsquo;s APIs will be different, but you can expect to find functionality related to user account management, options to upload and download data, different ways to request information, and so on.</span></p><p class="c7 c13"><span class="c8">When making a request to an endpoint, make sure you note the request </span><span class="c8 c14">requirements</span><span class="c8">. Requirements could include some form of authentication, parameters, path variables, headers, and information included in the body of the request. The API documentation should tell you what it requires of you and mention in which part of the request that information belongs. If the documentation provides examples, use them to help you. Typically, you can replace the sample values with the ones you&rsquo;re looking for. </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23table7-1&amp;sa=D&amp;source=editors&amp;ust=1681144458092040&amp;usg=AOvVaw1S6c1BWFEhcOcSCFBADn6i">Table 7-1</a></span><span class="c5">&nbsp;describes some of the conventions often used in these examples.</span></p><p class="c12"><span class="c17 c34">Table 7-1</span><span class="c18 c17 c14">: API Documentation Conventions</span></p><a id="t.e3e89ff5e7288617cfae39bb9ffe9b4cdb367850"></a><a id="t.0"></a><table class="c40"><tr class="c24"><td class="c50" colspan="1" rowspan="1"><p class="c0"><span class="c32 c17">Convention</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c0"><span class="c17 c32">Example</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c0"><span class="c32 c17">Meaning</span></p></td></tr><tr class="c49"><td class="c33" colspan="1" rowspan="1"><p class="c0"><span class="c6">:</span><span class="c8 c17">&nbsp;or </span><span class="c6">{}</span></p></td><td class="c48" colspan="1" rowspan="1"><p class="c0"><span class="c8 c20 c17 c14">/user/:id</span></p><p class="c0"><span class="c8 c20 c17 c14">/user/{id}</span></p><p class="c0"><span class="c8 c20 c17 c14">/user/2727</span></p><p class="c0"><span class="c8 c20 c17 c14">/account/:username</span></p><p class="c0"><span class="c8 c20 c17 c14">/account/{username}</span></p><p class="c0"><span class="c8 c17 c14">/account/scuttleph1sh</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">The colon or curly brackets are used by some APIs to indicate a path variable. In other words, &ldquo;:id&rdquo; represents the variable for an ID number and &ldquo;{username}&rdquo; represents the account username you are trying to access.</span></p></td></tr><tr class="c25"><td class="c33" colspan="1" rowspan="1"><p class="c0"><span class="c17 c30">[]</span></p></td><td class="c48" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17 c14">/api/v1/user?find=[name]</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">Square brackets indicate that the input is optional.</span></p></td></tr><tr class="c25"><td class="c33" colspan="1" rowspan="1"><p class="c0"><span class="c6">||</span></p></td><td class="c48" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">&ldquo;blue&rdquo; || &ldquo;green&rdquo; || &ldquo;red&rdquo;</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">Double bars represent different possible values that can be used.</span></p></td></tr><tr class="c25"><td class="c33" colspan="1" rowspan="1"><p class="c0"><span class="c30 c17">&lt; &gt;</span></p></td><td class="c48" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">&lt;find-function&gt;</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c0"><span class="c8 c17">Angle brackets represent a DomString, which is a 16-bit string.</span></p></td></tr></table><p class="c7 c13"><span class="c5">For example, the following is a GET request from the vulnerable Pixi API documentation:</span></p><p class="c3"><span class="c2">&#10102; GET &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#10103;/api/picture/{picture_id}/likes &nbsp; &nbsp;get a list of likes by user</span></p><p class="c3 c37"><span class="c2"></span></p><p class="c3"><span class="c2">&#10104; Parameters</span></p><p class="c3 c37"><span class="c2"></span></p><p class="c3"><span class="c2">Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Description</span></p><p class="c3 c37"><span class="c2"></span></p><p class="c3"><span class="c2">x-access-token *</span></p><p class="c3"><span class="c2">string &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Users JWT Token</span></p><p class="c3"><span class="c2">(header)</span></p><p class="c3 c37"><span class="c2"></span></p><p class="c3"><span class="c2">picture_id * &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in URL string</span></p><p class="c3 c37"><span class="c2"></span></p><p class="c3"><span class="c2">number</span></p><p class="c35"><span class="c2">(path)</span></p><p class="c7 c13"><span class="c8">You can see that the method is GET &#10102;, the endpoint is </span><span class="c8 c14">/api/picture/{picture_id}/likes</span><span class="c8">&nbsp;&#10103;, and the only requirements are the </span><span class="c6">x-access-token</span><span class="c8">&nbsp;header and the </span><span class="c6">picture_id</span><span class="c8">&nbsp;variable to be updated in the path &#10104;. Now you know that, in order to test this endpoint, you&rsquo;ll need to figure out how to obtain a JSON Web Token (JWT) and what form the </span><span class="c6">picture_id</span><span class="c5">&nbsp;should be in.</span></p><p class="c7 c13"><span class="c8">You can then take these instructions and insert the information into an API browser such as Postman (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-1&amp;sa=D&amp;source=editors&amp;ust=1681144458101474&amp;usg=AOvVaw3WmN1D1qdUz6W3ZhVyk959">Figure 7-1</a></span><span class="c8">). As you&rsquo;ll see, all of the headers besides </span><span class="c6">x-access-token</span><span class="c5">&nbsp;will be automatically generated by Postman.</span></p><p class="c7 c13"><span class="c8">Here, I authenticated to the web page and found the </span><span class="c6">picture_id</span><span class="c8">&nbsp;listed under the pictures. I used the documentation to find the API registration process, which generated a JWT. I then took the JWT and saved it as the variable </span><span class="c6">hapi_token</span><span class="c8">; we will be using variables throughout this chapter. Once the token is saved as a variable, you can call it by using the variable name surrounded by curly brackets: </span><span class="c6">{{hapi_token}}</span><span class="c5">. (Note that if you are working with several collections, you&rsquo;ll want to use environmental variables instead.) Put together, it forms a successful API request. You can see that the provider responded with a &ldquo;200 OK,&rdquo; along with the requested information.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 528.00px;"><img alt="Screenshot of Postman with a list of headers checked and an automatically generated request containing those fields" src="images/image13.png" style="width: 624.00px; height: 528.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-1</span><span class="c18 c17 c14">: The fully crafted request to the Pixi endpoint /api/{picture_id}/likes</span></p><p class="c7 c13"><span class="c8">In situations where your request is improperly formed, the provider will usually let you know what you&rsquo;ve done wrong. For instance, if you make a request to the same endpoint without the </span><span class="c6">x-access-token</span><span class="c5">, Pixi will respond with the following:</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c39">&nbsp; &nbsp; &quot;success&quot;: </span><span class="c32 c45">false,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &quot;message&quot;: &quot;No token provided.&quot;</span></p><p class="c35"><span class="c2">}</span></p><p class="c7 c13"><span class="c8">You should be able to understand the response and make any necessary adjustments. If you had attempted to copy and paste the endpoint without replacing the </span><span class="c6">{picture_id}</span><span class="c8">&nbsp;variable, the provider would respond with a status code of 200 OK and a body with square brackets (</span><span class="c6">[]</span><span class="c5">). If you are stumped by a response, return to the documentation and compare your request with the requirements.</span></p><h3 class="c15" id="h.kfv83y2dejwr"><span class="c23 c20">Importing API Specifications</span></h3><p class="c7 c17"><span class="c5">If your target has a specification, in a format like OpenAPI (Swagger), RAML, or API Blueprint or in a Postman collection, finding this will be even more useful than finding the documentation. When provided with a specification, you can simply import it into Postman and review the requests that make up the collection, as well as their endpoints, headers, parameters, and some required variables.</span></p><p class="c7 c13"><span class="c8">Specifications should be as easy or as hard to find as their API documentation counterparts. They&rsquo;ll often look like the page in </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-2&amp;sa=D&amp;source=editors&amp;ust=1681144458103983&amp;usg=AOvVaw3edGqMlZV_hxW1hxxOhQuj">Figure 7-2</a></span><span class="c8">. The specification will contain plaintext and typically be in JSON format, but it could also be in YAML, RAML, or XML format. If the URL path doesn&rsquo;t give away the type of specification, scan the beginning of the file for a descriptor, such as </span><span class="c6">&quot;swagger&quot;:&quot;2.0&quot;</span><span class="c5">, to find the specification and version.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 224.00px;"><img alt="Screenshot of a Pixi web page containing a large amount of unformatted JSON data" src="images/image6.png" style="width: 624.00px; height: 224.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-2</span><span class="c18 c17 c14">: The Pixi swagger definition page</span></p><p class="c7 c13"><span class="c8">To import the specification, begin by launching Postman. Under the Workspace Collection section, click </span><span class="c29">Import</span><span class="c8">, select </span><span class="c29">Link</span><span class="c8">, and then add the location of the specification (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-3&amp;sa=D&amp;source=editors&amp;ust=1681144458105050&amp;usg=AOvVaw08aqMakF1CWDx6phm1AAdA">Figure 7-3</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 413.33px; height: 270.67px;"><img alt="Screenshot of a Postman menu item with an &ldquo;enter a URL&rdquo; field and a Continue button" src="images/image2.png" style="width: 413.33px; height: 270.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-3</span><span class="c18 c17 c14">: The Import Link functionality within Postman</span></p><p class="c7 c13"><span class="c8">Click </span><span class="c29">Continue</span><span class="c8">, and on the final window, select </span><span class="c29">Import</span><span class="c8">. Postman will detect the specification and import the file as a collection. Once the collection has been imported into Postman, you can review the functionality here (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-4&amp;sa=D&amp;source=editors&amp;ust=1681144458106036&amp;usg=AOvVaw2fJdMu7I9JEqyXn-oR5xr-">Figure 7-4</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 420.00px; height: 334.67px;"><img alt="Screenshot of the Postman Collections tab showing a directory structure for the Pixi App API. Includes subfolders and a list of POST and GET requests." src="images/image19.png" style="width: 420.00px; height: 334.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-4</span><span class="c18 c17 c14">: The imported Pixi App collection</span></p><p class="c7 c13"><span class="c8">After you&rsquo;ve imported a new collection, make sure to check the collection variables. You can display the collection editor by selecting the three horizontal circles at the top level of a collection and choosing </span><span class="c29">Edit</span><span class="c8">. Here, you can select the Variables tab within the collection editor to see the variables. You can adjust the variables to fit your needs and add any new variables you would like to this collection. In </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-5&amp;sa=D&amp;source=editors&amp;ust=1681144458106731&amp;usg=AOvVaw3tQBHcJ_g4GKDsAr5-ML6E">Figure 7-5</a></span><span class="c8">, you can see where I have added the </span><span class="c6">hapi_token</span><span class="c5">&nbsp;JWT variable to my Pixi App collection.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 525.33px; height: 202.67px;"><img alt="Screenshot of the Postman Variables tab with two variables, baseUrl and hapi_token, checked" src="images/image4.png" style="width: 525.33px; height: 202.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-5</span><span class="c18 c17 c14">: The Postman collection variables editor</span></p><p class="c7 c13"><span class="c8">Once you&rsquo;ve finished making updates, save your changes using the </span><span class="c29">Save</span><span class="c5">&nbsp;button at the top-right corner. Importing API specifications to Postman like this could save you hours of manually adding all endpoints, request methods, headers, and requirements.</span></p><h3 class="c15" id="h.e63bbqqonm5g"><span class="c23 c20">Reverse Engineering APIs</span></h3><p class="c7 c17"><span class="c5">In the instance where there is no documentation and no specification, you will have to reverse engineer the API based on your interactions with it. We will touch on this process in more detail in Chapter 7. Mapping an API with several endpoints and a few methods can quickly grow into quite a beast to attack. To manage this process, build the requests under a collection in order to thoroughly hack the API. Postman can help you keep track of all these requests.</span></p><p class="c7 c13"><span class="c5">There are two ways to reverse engineer an API with Postman. One way is by manually constructing each request. While this can be a bit cumbersome, it allows you to capture the precise requests you care about. The other way is to proxy web traffic through Postman and then use it to capture a stream of requests. This process makes it much easier to construct requests within Postman, but you&rsquo;ll have to remove or ignore unrelated requests. Finally, if you obtain a valid authentication header, such as a token, API key, or other authentication value, add that to Kiterunner to help map out API endpoints.</span></p><h4 class="c15" id="h.94f7e8szz18r"><span class="c29 c20 c47">Manually Building a Postman Collection</span></h4><p class="c7 c17"><span class="c8">To manually build your own collection in Postman, select </span><span class="c29">New</span><span class="c8">&nbsp;under My Workspace, as seen at the top right of </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-6&amp;sa=D&amp;source=editors&amp;ust=1681144458108812&amp;usg=AOvVaw3oUmmR8mp85BAjn1HQUwe-">Figure 7-6</a></span><span class="c5">.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 398.67px; height: 230.67px;"><img alt="The Postman &ldquo;My Workspace&rdquo; tab, with New and Import buttons in the upper right" src="images/image7.png" style="width: 398.67px; height: 230.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-6</span><span class="c17 c14 c18">: The workspace section of Postman</span></p><p class="c7 c13"><span class="c8">In the Create New window, create a new collection and then set up a </span><span class="c6">baseURL</span><span class="c8">&nbsp;variable containing your target&rsquo;s URL. Creating a </span><span class="c6">baseURL</span><span class="c8">&nbsp;variable (or using one that is already present) will help you quickly make alterations to the URL across an entire collection. APIs can be quite large, and making small changes to many requests can be time-consuming. For example, suppose you want to test out different API path versions (such as </span><span class="c8 c14">v1/v2/v3</span><span class="c5">) across an API with hundreds of unique requests. Replacing the URL with a variable means you would only need to update the variable in order to change the path for all requests using the variable.</span></p><p class="c7 c13"><span class="c8">Now, any time you discover an API request, you can add it to the collection (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-7&amp;sa=D&amp;source=editors&amp;ust=1681144458110023&amp;usg=AOvVaw1S-qLSAqCbY8CToIzi0lF4">Figure 7-7</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 445.33px; height: 238.67px;"><img alt="Screenshot of Postman showing the menu item &ldquo;Reqres Testing&rdquo; right-clicked and &ldquo;Add Request&rdquo; selected in a pop-up menu" src="images/image14.png" style="width: 445.33px; height: 238.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-7</span><span class="c18 c17 c14">: The Add Request option within a new Postman collection</span></p><p class="c7 c13"><span class="c8">Select the collection options button (the three horizontal circles) and select </span><span class="c29">Add Request</span><span class="c5">. If you want to further organize the requests, you can create folders to group the requests together. Once you have built a collection, you can use it as though it were documentation.</span></p><h4 class="c15" id="h.ur0kibxm10wo"><span class="c29 c20 c47">Building a Postman Collection by Proxy</span></h4><p class="c7 c17"><span class="c5">The second way to reverse engineer an API is to proxy web browser traffic through Postman and clean up the requests so that only the API-related ones remain. Let&rsquo;s reverse engineer the crAPI API by proxying our browser traffic to Postman.</span></p><p class="c7 c13"><span class="c8">First, open Postman and create a collection for crAPI. At the top right of Postman is a signal button that you can select to open the Capture requests and cookies window (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-8&amp;sa=D&amp;source=editors&amp;ust=1681144458111256&amp;usg=AOvVaw2ycRaggpOGXPmk8RmZkbSp">Figure 7-8</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 533.33px; height: 614.67px;"><img alt="The Postman &ldquo;Capture Requests and Cookies&rdquo; window with &ldquo;Capture requests&rdquo; set to On, the port set to 5555, and the requests saved to the crAPI collection" src="images/image5.png" style="width: 533.33px; height: 614.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-8</span><span class="c18 c17 c14">: The Postman Capture requests and cookies window</span></p><p class="c7 c13"><span class="c8">Make sure the port number matches the one you&rsquo;ve configured in FoxyProxy. Back in Chapter 4, we set this to port 5555. Save requests to your crAPI collection. Finally, set Capture Requests to </span><span class="c29">On</span><span class="c5">. Now navigate to the crAPI web application and set FoxyProxy to forward traffic to Postman.</span></p><p class="c7 c13"><span class="c5">As you start using the web application, every request will be sent through Postman and added to the selected collection. Use every feature of the web application, including registering a new account, authenticating, performing a password reset, clicking every link, updating your profile, using the community forum, and navigating to the shop. Once you&rsquo;ve finished thoroughly using the web application, stop your proxy and review the crAPI collection made within Postman.</span></p><p class="c7 c13"><span class="c8">One downside of building a collection this way is that you&rsquo;ll have captured several requests that aren&rsquo;t API related. You will need to delete these requests and organize the collection. Postman allows you to create folders to group similar requests, and you can rename as many requests as you&rsquo;d like. In </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-9&amp;sa=D&amp;source=editors&amp;ust=1681144458112159&amp;usg=AOvVaw2DHTxC9PUmMhUqqDsS4JbP">Figure 7-9</a></span><span class="c5">, you can see that I grouped requests by the different endpoints.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 625.33px;"><img alt="Screenshot of crAPI requests in Postman, grouped into Community, Identity, and Workshop folders" src="images/image3.png" style="width: 384.00px; height: 625.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-9</span><span class="c18 c17 c14">: An organized crAPI collection</span></p><h2 class="c15" id="h.wy9rw6eii0nf"><span class="c10">Adding API Authentication Requirements to Postman</span></h2><p class="c7 c17"><span class="c5">Once you&rsquo;ve compiled the basic request information in Postman, look for the API&rsquo;s authentication requirements. Most APIs with authentication requirements will have a process for obtaining access, typically by sending credentials over a POST request or OAuth or else by using a method separate from the API, such as email, to obtain a token. Decent documentation should make the authentication process clear. In the next chapter, we will dedicate time to testing the API authentication processes. For now, we will use the API authentication requirements to start using the API as it was intended.</span></p><p class="c7 c13"><span class="c8">As an example of a somewhat typical authentication process, let&rsquo;s register and authenticate to the Pixi API. Pixi&rsquo;s Swagger documentation tells us that we need to make a request with both </span><span class="c6">user</span><span class="c8">&nbsp;and </span><span class="c6">pass</span><span class="c8">&nbsp;parameters to the </span><span class="c8 c14">/api/register</span><span class="c8">&nbsp;endpoint to receive a JWT. If you&rsquo;ve imported the collection, you should be able to find and select the &ldquo;Create Authentication Token&rdquo; request in Postman (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-10&amp;sa=D&amp;source=editors&amp;ust=1681144458113229&amp;usg=AOvVaw2U_qDPgNTKdkL2-IpkLoOl">Figure 7-10</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 344.00px;"><img alt="Screenshot of a POST request in Postman, with a long, highlighted string value for the &ldquo;token&rdquo; header value" src="images/image17.png" style="width: 624.00px; height: 344.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-10</span><span class="c18 c17 c14">: A successful registration request to the Pixi API</span></p><p class="c7 c13"><span class="c8">The preconfigured request contains parameters you may not be aware of and are not required for authentication. Instead of using the preconfigured information, I crafted the response by selecting the </span><span class="c6">x-www-form-urlencoded</span><span class="c8">&nbsp;option with the only parameters necessary (</span><span class="c6">user</span><span class="c8">&nbsp;and </span><span class="c6">pass</span><span class="c8">). I then added the keys </span><span class="c6">user</span><span class="c8">&nbsp;and </span><span class="c6">pass</span><span class="c8">&nbsp;and filled in the values shown in </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-10&amp;sa=D&amp;source=editors&amp;ust=1681144458114397&amp;usg=AOvVaw1x_HT7iSyjZEuTDH8OekXP">Figure 7-10</a></span><span class="c5">. This process resulted in successful registration, as indicated by the 200 OK status code and the response of a token.</span></p><p class="c7 c13"><span class="c5">It&rsquo;s a good idea to save successful authentication requests so you can repeat them when needed, as tokens could be set to expire quickly. Additionally, API security controls could detect malicious activity and revoke your token. As long as your account isn&rsquo;t blocked, you should be able to generate another token and continue your testing. Also, be sure to save your token as a collection or environmental variable. That way, you&rsquo;ll be able to quickly reference it in subsequent requests instead of having to continuously copy in the giant string.</span></p><p class="c7 c13"><span class="c5">The next thing you should do when you get an authentication token or API key is to add it to Kiterunner. We used Kiterunner in Chapter 6 to map out a target&rsquo;s attack surface as an unauthenticated user, but adding an authentication header to the tool will greatly improve your results. Not only will Kiterunner provide you with a list of valid endpoints, but it will also hand you interesting HTTP methods and parameters.</span></p><p class="c7 c13"><span class="c8">In the following example, we use the </span><span class="c6">x-access-token</span><span class="c8">&nbsp;provided to us during the Pixi registration process. Take the full authorization header and add it to your Kiterunner scan with the </span><span class="c6">-H</span><span class="c5">&nbsp;option:</span></p><p class="c3"><span class="c39">$ </span><span class="c32 c45">kr scan http://192.168.50.35:8090 -w ~/api/wordlists/data/kiterunner/routes-large.kite -H &#39;x-access-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7Il9pZCI6NDUsImVtYWlsIjoiaGFwaUBoYWNrZXIuY29tIiwicGFzc3dvcmQiOiJQYXNzd29yZDEhIiwibmFtZSI6Im15c2VsZmNyeSIsInBpYyI6Imh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS91aWZhY2VzL2ZhY2VzL3R3aXR0ZXIvZ2FicmllbHJvc3Nlci8xMjguanBnIiwiaXNfYWRtaW4iOmZhbHNlLCJhY2NvdW50X2JhbGFuY2UiOjUwLCJhbGxfcGljdHVyZXMiOltdfSwiaWF0IjoxNjMxNDE2OTYwfQ._qoC_kgv6qlbPLFuH07-DXRUm9wHgBn_GD7QWYwvzFk&#39;</span></p><p class="c3"><span class="c2">This scan will result in identifying the following endpoints:</span></p><p class="c3"><span class="c2">GET &nbsp; &nbsp; 200 [ &nbsp; &nbsp;217, &nbsp; &nbsp;1, &nbsp; 1] http://192.168.50.35:8090/api/user/info</span></p><p class="c3"><span class="c2">GET &nbsp; &nbsp; 200 [ 101471, 1871, &nbsp; 1] http://192.168.50.35:8090/api/pictures/</span></p><p class="c3"><span class="c2">GET &nbsp; &nbsp; 200 [ &nbsp; &nbsp;217, &nbsp; &nbsp;1, &nbsp; 1] http://192.168.50.35:8090/api/user/info/</span></p><p class="c35"><span class="c2">GET &nbsp; &nbsp; 200 [ 101471, 1871, &nbsp; 1] http://192.168.50.35:8090/api/pictures</span></p><p class="c7 c13"><span class="c5">Adding authorization headers to your Kiterunner requests should improve your scan results, as it will allow the scanner to access endpoints it otherwise wouldn&rsquo;t have access to.</span></p><h2 class="c15" id="h.crbbm5csqpsr"><span class="c10">Analyzing Functionality</span></h2><p class="c7 c17"><span class="c5">Once you have the API&rsquo;s information loaded into Postman, you should begin to look for issues. This section covers a method for initially testing the functionality of API endpoints. You&rsquo;ll begin by using the API as it was intended. In the process, you&rsquo;ll pay attention to the responses and their status codes and error messages. In particular, you&rsquo;ll seek out functionality that interests you as an attacker, especially if there are indications of information disclosure, excessive data exposure, and other low-hanging vulnerabilities. Look for endpoints that could provide you with sensitive information, requests that allow you to interact with resources, areas of the API that allow you to inject a payload, and administrative actions. Beyond that, look for any endpoint that allows you to upload your own payload and interact with resources.</span></p><p class="c7 c13"><span class="c5">To streamline this process, I recommend proxying Kiterunner&rsquo;s results through Burp Suite so you can replay interesting requests. In past chapters, I showed you the replay feature of Kiterunner, which lets you review individual API requests and responses. To proxy a replay through another tool, you will need to specify the address of the proxy receiver:</span></p><p class="c35"><span class="c39">$ </span><span class="c32 c20 c43">kr kb replay -w ~/api/wordlists/data/kiterunner/routes-large.kite --proxy=http://127.0.0.1:8080 &quot;GET &nbsp; &nbsp; 403 [ &nbsp; &nbsp; 48, &nbsp; &nbsp;3, &nbsp; 1] http://192.168.50.35:8090/api/picture/detail.php 0cf6889d2fba4be08930547f145649ffead29edb&quot;</span></p><p class="c7 c13"><span class="c8">This request uses Kiterunner&rsquo;s replay option, as specified by </span><span class="c6">kb replay</span><span class="c8">. The </span><span class="c6">-w</span><span class="c8">&nbsp;option specifies the wordlist used, and </span><span class="c6">proxy</span><span class="c8">&nbsp;specifies the Burp Suite proxy. The remainder of the command is the original Kiterunner output. In </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-11&amp;sa=D&amp;source=editors&amp;ust=1681144458117196&amp;usg=AOvVaw1Iqctf04zx-JYbd7JxuDQE">Figure 7-11</a></span><span class="c5">, you can see that the Kiterunner replay was successfully captured in Burp Suite.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 597.33px; height: 302.67px;"><img alt="Screenshot of a GET request in Burp Suite" src="images/image21.png" style="width: 597.33px; height: 302.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-11</span><span class="c18 c17 c14">: A Kiterunner request intercepted with Burp Suite</span></p><p class="c7 c13"><span class="c5">Now you can analyze the requests and use Burp Suite to repeat all interesting results captured in Kiterunner.</span></p><h3 class="c15" id="h.ynv9q7crqpw7"><span class="c23 c20">Testing Intended Use</span></h3><p class="c7 c17"><span class="c5">Start by using the API endpoints as intended. You could begin this process with a web browser, but web browsers were not meant to interact with APIs, so you might want to switch to Postman. Use the API documentation to see how you should structure your requests, what headers to include, what parameters to add, and what to supply for authentication. Then send the requests. Adjust your requests until you receive successful responses from the provider.</span></p><p class="c7 c13"><span class="c5">As you proceed, ask yourself these questions:</span></p><ul class="c28 lst-kix_gx09mwwjq6mr-0 start"><li class="c1 li-bullet-0"><span class="c5">What sorts of actions can I take?</span></li><li class="c1 li-bullet-0"><span class="c5">Can I interact with other user accounts?</span></li><li class="c1 li-bullet-0"><span class="c5">What kinds of resources are available?</span></li><li class="c1 li-bullet-0"><span class="c5">When I create a new resource, how is that resource identified?</span></li><li class="c1 li-bullet-0"><span class="c5">Can I upload a file? Can I edit a file?</span></li></ul><p class="c7 c13"><span class="c5">There is no need to make every possible request if you are manually working with the API, but make a few. Of course, if you have built a collection in Postman, you can easily make every possible request and see what response you get from the provider.</span></p><p class="c7 c13"><span class="c8">For example, send a request to Pixi&rsquo;s </span><span class="c8 c14">/api/user/info</span><span class="c8">&nbsp;endpoint to see what sort of response you receive from the application (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-12&amp;sa=D&amp;source=editors&amp;ust=1681144458119834&amp;usg=AOvVaw3OAXknljxxQozxNhdniGZr">Figure 7-12</a></span><span class="c5">).</span></p><p class="c7 c13"><span class="c8">In order to make a request to this endpoint, you must use the GET method. Add the </span><span class="c8 c14">{{baseUrl}}/api/user/info</span><span class="c8">&nbsp;endpoint to the URL field. Then add the </span><span class="c6">x-access-token</span><span class="c8">&nbsp;to the request header. As you can see, I have set the JWT as the variable </span><span class="c6">{{hapi_token}}</span><span class="c5">. If you are successful, you should receive a 200 OK status code, seen just above the response.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 572.00px; height: 522.67px;"><img alt="Screenshot of a request in Postman with the x-access-token variable selected" src="images/image11.png" style="width: 572.00px; height: 522.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-12</span><span class="c17 c14 c41">: Setting the </span><span class="c14 c21">x-access-token</span><span class="c18 c17 c14">&nbsp;as the variable for the JWT</span></p><h3 class="c15" id="h.z8njht52izu"><span class="c23 c20">Performing Privileged Actions</span></h3><p class="c7 c17"><span class="c5">If you&rsquo;ve gained access to an API&rsquo;s documentation, any sort of administrative actions listed there should grab your attention. Privileged actions will often lead to additional functionality, information, and control. For example, admin requests could give you the ability to create and delete users, search for sensitive user information, enable and disable accounts, add users to groups, manage tokens, access logs, and more. Luckily for us, admin API documentation information is often available for all to see due to the self-service nature of APIs.</span></p><p class="c7 c13"><span class="c5">If security controls are in place, administrative actions should have authorization requirements, but never assume that they actually do. My recommendation is to test these actions in several phases: first as an unauthenticated user, then as a low-privileged user, and finally as an administrative user. When you make the administrative requests as documented but without any authorization requirements, you should receive some sort of unauthorized response if any security controls are in place.</span></p><p class="c7 c13"><span class="c8">You&rsquo;ll likely have to find a way to gain access to the administrative requirements. In the case of the Pixi, the documentation in </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-13&amp;sa=D&amp;source=editors&amp;ust=1681144458121216&amp;usg=AOvVaw1t6HyW5d2OSOBGa7Oq-NPb">Figure 7-13</a></span><span class="c8">&nbsp;clearly shows us that we need an </span><span class="c6">x-access-token</span><span class="c8">&nbsp;to perform the GET request to the </span><span class="c8 c14">/api/admin/users/search</span><span class="c5">&nbsp;endpoint. When you test this administrative endpoint, you&rsquo;ll see that Pixi has basic security controls in place to prevent unauthorized users from using administrative endpoints.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 445.33px; height: 390.67px;"><img alt="Screenshot of the Pixi documentation for the admins endpoint" src="images/image16.png" style="width: 445.33px; height: 390.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-13</span><span class="c18 c17 c14">: The requirements for a Pixi administrative endpoint</span></p><p class="c7 c13"><span class="c5">Making sure that the most basic security controls are in place is a useful practice. More importantly, protected administrative endpoints establish a goal for us for the next steps in our testing; we now know that in order to use this functionality, we need to obtain an admin JWT.</span></p><h3 class="c15" id="h.o1oa8vmk473q"><span class="c23 c20">Analyzing API Responses</span></h3><p class="c7 c17"><span class="c5">As most APIs are meant to be self-service, developers will often leave some hint in the API responses when things don&rsquo;t go as planned. One of the most basic skills you&rsquo;ll need as an API hacker is the ability to analyze the responses you receive. This is initially done by issuing a request and reviewing the response status code, headers, and content included in the body.</span></p><p class="c7 c13"><span class="c5">First check that you are receiving the responses you expect. API documentation can sometimes provide examples of what you could receive as a response. However, once you begin using the API in unintended ways, you will no longer know what you&rsquo;ll get as a response, which is why it helps to first use the API as it was intended before moving into attack mode. Developing a sense of regular and irregular behavior will make vulnerabilities obvious.</span></p><p class="c7 c13"><span class="c5">At this point, your search for vulnerabilities begins. Now that you&rsquo;re interacting with the API, you should be able to find information disclosures, security misconfigurations, excessive data exposures, and business logic flaws, all without too much technical finesse. It&rsquo;s time to introduce the most important ingredient of hacking: the adversarial mindset. In the following sections, I will show you what to look for.</span></p><h2 class="c15" id="h.br7k3w694tau"><span class="c10">Finding Information Disclosures</span></h2><p class="c7 c17"><span class="c5">Information disclosure will often be the fuel for our testing. Anything that helps our exploitation of an API can be considered an information disclosure, whether it&rsquo;s interesting status codes, headers, or user data. When making requests, you should review responses for software information, usernames, email addresses, phone numbers, password requirements, account numbers, partner company names, and any information that your target claims is useful.</span></p><p class="c7 c13"><span class="c8">Headers can inadvertently reveal more information about the application than necessary. Some, like </span><span class="c6">X-powered-by</span><span class="c5">, do not serve much of a purpose and often disclose information about the backend. Of course, this alone won&rsquo;t lead to exploitation, but it can help us know what sort of payload to craft and reveal potential application weaknesses.</span></p><p class="c7 c13"><span class="c5">Status codes can also disclose useful information. If you were to brute-force the paths of different endpoints and receive responses with the status codes 404 Not Found and 401 Unauthorized, you could map out the API&rsquo;s endpoints as an unauthorized user. This simple information disclosure can get much worse if these status codes were returned for requests with different query parameters. Say you were able to use a query parameter for a customer&rsquo;s phone number, account number, and email address. Then you could brute-force these items, treating the 404s as nonexistent values and the 401s as existing ones. Now, it probably shouldn&rsquo;t take too much imagination to see how this sort of information could assist you. You could perform password spraying; test password resend mechanisms, or conduct phishing, vishing, and smishing. There is also a chance you could pair query parameters together and extract personally identifiable information from the unique status codes.</span></p><p class="c7 c13"><span class="c5">API documentation can itself be an information disclosure risk. For instance, it is often an excellent source of information about business logic vulnerabilities, as discussed in Chapter 3. Moreover, administrative API documentation will often tell you the admin endpoints, the parameters required, and the method to obtain the specified parameters. This information can be used to aid you in authorization attacks (such as BOLA and BFLA), which are covered in later chapters.</span></p><p class="c7 c13"><span class="c5">When you start exploiting API vulnerabilities, be sure to track which headers, unique status codes, documentation, or other hints were handed to you by the API provider.</span></p><h2 class="c15" id="h.vh6z4cap6vpu"><span class="c10">Finding Security Misconfigurations</span></h2><p class="c7 c17"><span class="c5">Security misconfigurations represent a large variety of items. At this stage of your testing, look for verbose error messaging, poor transit encryption, and other problematic configurations. Each of these issues can be useful later for exploiting the API.</span></p><h3 class="c15" id="h.4ihaoo6ae0up"><span class="c20 c23">Verbose Errors</span></h3><p class="c7 c17"><span class="c5">Error messages exist to help the developers on both the provider and consumer sides understand what has gone wrong. For example, if the API requires you to POST a username and password in order to obtain an API token, check how the provider responds to both existing and nonexistent usernames. A common way to respond to nonexistent usernames is with the error &ldquo;User does not exist, please provide a valid username.&rdquo; When a user does exist but you&rsquo;ve used the wrong password, you may get the error &ldquo;Invalid password.&rdquo; This small difference in error response is an information disclosure that you can use to brute-force usernames, which can then be leveraged in later attacks.</span></p><h3 class="c15" id="h.ij2vz3wcokpf"><span class="c23 c20">Poor Transit Encryption</span></h3><p class="c7 c17"><span class="c5">Finding an API in the wild without transit encryption is rare. I&rsquo;ve only come across this in instances when the provider believes its API contains only nonsensitive public information. In situations like this, the challenge is to see whether you can discover any sensitive information by using the API. In all other situations, make sure to check that the API has valid transit encryption. If the API is transmitting any sensitive information, HTTPS should be in use.</span></p><p class="c7 c13"><span class="c8">In order to attack an API with transit insecurities, you would need to perform a </span><span class="c8 c14">man-in-the-middle (MITM) </span><span class="c5">attack in which you somehow intercept the traffic between a provider and a consumer. Because HTTP sends unencrypted traffic, you&rsquo;ll be able to read the intercept requests and responses. Even if HTTPS is in use on the provider&rsquo;s end, check whether a consumer can initiate HTTP requests and share their tokens in the clear.</span></p><p class="c7 c13"><span class="c8">Use a tool like Wireshark to capture network traffic and spot plaintext API requests passing across the network you&rsquo;re connected to. In </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-14&amp;sa=D&amp;source=editors&amp;ust=1681144458124518&amp;usg=AOvVaw2zF_p0BVDG3IqloB792bvQ">Figure 7-14</a></span><span class="c8">, a consumer has made an HTTP request to the HTTPS-protected </span><span class="c8 c14">reqres.in</span><span class="c5">. As you can see, the API token within the path is clear as day.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 242.67px;"><img alt="Screenshot of Wireshark showing a GET request with a user token included in the URL" src="images/image18.png" style="width: 624.00px; height: 242.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-14</span><span class="c18 c17 c14">: A Wireshark capture of a user&rsquo;s token in an HTTP request</span></p><h3 class="c15" id="h.l7mi5l1xba44"><span class="c23 c20">Problematic Configurations</span></h3><p class="c7 c17"><span class="c8">Debugging pages are a form of security misconfiguration that can expose plenty of useful information. I have come across many APIs that had debugging enabled. You have a better chance of finding this sort of misconfiguration in newly developed APIs and in testing environments. For example, in </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-15&amp;sa=D&amp;source=editors&amp;ust=1681144458125549&amp;usg=AOvVaw2UiUn3ZtbxOYR9lL3vgEBL">Figure 7-15</a></span><span class="c5">, not only can you see the default landing page for 404 errors and all of this provider&rsquo;s endpoints, but you can also see that the application is powered by Django.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 400.00px;"><img alt="Screenshot of webpage displaying a 404 error, a list of API endpoints, and a message that reads &ldquo;You are seeing this error because you have DEBUG = True in your Django settings file.&rdquo;" src="images/image20.png" style="width: 624.00px; height: 400.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-15</span><span class="c18 c17 c14">: The debug page of Tiredful API</span></p><p class="c7 c13"><span class="c5">This finding could trigger you to research what sorts of malicious things can be done when the Django debug mode is enabled.</span></p><h2 class="c15" id="h.h4nb30jioe4"><span class="c10">Finding Excessive Data Exposures</span></h2><p class="c7 c17"><span class="c5">As discussed in Chapter 3, excessive data exposure is a vulnerability that takes place when the API provider sends more information than the API consumer requests. This happens because the developers designed the API to depend on the consumer to filter results.</span></p><p class="c7 c13"><span class="c5">When testing for excessive data exposure on a large scale, it&rsquo;s best to use a tool like Postman&rsquo;s Collection Runner, which helps you make many requests quickly and provides you with an easy way to review the results. If the provider responds with more information than you needed, you could have found a vulnerability.</span></p><p class="c7 c13"><span class="c8">Of course, not every excess byte of data should be considered a vulnerability; watch for excess information that can be useful in an attack. True excessive data exposure vulnerabilities are often fairly obvious because of the sheer quantity of data provided. Imagine an endpoint with the ability to search for usernames. If you queried for a username and received the username plus a timestamp of the user&rsquo;s last login, this is excess data, but it&rsquo;s hardly useful. Now, if you queried for the username and were provided with a username plus the user&rsquo;s full name, email, and birthday, you have a finding. For example, say a GET request to </span><span class="c8 c14">https://secure.example.com/api/users/hapi_hacker</span><span class="c5">&nbsp;was supposed to give you information about our hapi_hacker account, but it responded with the following:</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp;&quot;user&quot;: {</span></p><p class="c3"><span class="c2">&quot;id&quot;: 1124,</span></p><p class="c3"><span class="c2">&quot;admin&quot;: false,</span></p><p class="c3"><span class="c2">&quot;username&quot;: hapi_hacker,</span></p><p class="c3"><span class="c2">&quot;multifactor&quot;: false</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">&quot;sales_assoc&quot;: {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;&quot;email&quot;: &quot;admin@example.com&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;admin&quot;: true,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;username&quot;: super_sales_admin,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;multifactor&quot;: false</span></p><p class="c35"><span class="c2">}</span></p><p class="c7 c13"><span class="c5">As you can see, a request was made for the hapi_hacker account, but the administrator&rsquo;s account and security settings were included in the response. Not only does the response provide you with an administrator&rsquo;s email address and username, but it also lets you know whether they are an administrator without multifactor authentication enabled. This vulnerability is fairly common and can be extremely useful for obtaining private information. Also, if there is an excessive data exposure vulnerability on one endpoint and method, you can bet there are others.</span></p><h2 class="c15" id="h.hy1yjy9qi3x6"><span class="c10">Finding Business Logic Flaws</span></h2><p class="c7 c17"><span class="c8">OWASP provides the following advice about testing for business logic flaws (</span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability&amp;sa=D&amp;source=editors&amp;ust=1681144458128362&amp;usg=AOvVaw3Ooz28yxzz2W2HvKM_1gLW">https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability</a></span><span class="c5">):</span></p><p class="c7 c42"><span class="c8 c20 c17 c14">You&rsquo;ll need to evaluate the threat agents who could possibly exploit the problem and whether it would be detected. Again, this will take a strong understanding of the business. The vulnerabilities themselves are often quite easy to discover and exploit without any special tools or techniques, as they are a supported part of the application.</span></p><p class="c7 c13"><span class="c5">In other words, because business logic flaws are unique to each business and its logic, it is difficult to anticipate the specifics of the flaws you will find. Finding and exploiting these flaws is usually a matter of turning the features of an API against the API provider.</span></p><p class="c7 c13"><span class="c5">Business logic flaws could be discovered as early as when you review the API documentation and find directions for how not to use the application. (Chapter 3 lists the kinds of descriptions that should instantly make your vulnerability sensors go off.) When you find these, your next step should be obvious: do the opposite of what the documentation recommends! Consider the following examples:</span></p><ul class="c28 lst-kix_461jdmrtv6n0-0 start"><li class="c1 li-bullet-0"><span class="c8 c14">If the documentation tells you not to perform action X</span><span class="c5">, perform action X.</span></li><li class="c1 li-bullet-0"><span class="c8 c14">If the documentation tells you that data sent in a certain format isn&rsquo;t validated</span><span class="c5">, upload a reverse shell payload and try to find ways to execute it. Test the size of file that can be uploaded. If rate limiting is lacking and file size is not validated, you&rsquo;ve discovered a serious business logic flaw that will lead to a denial of service.</span></li><li class="c1 li-bullet-0"><span class="c8 c14">If the documentation tells you that all file formats are accepted</span><span class="c8">, upload files and test all file extensions. You can find a list of file extensions for this purpose called </span><span class="c8 c14">file-ext</span><span class="c8">&nbsp;(</span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://github.com/hAPI-hacker/Hacking-APIs/tree/main/Wordlists&amp;sa=D&amp;source=editors&amp;ust=1681144458129722&amp;usg=AOvVaw30Dp1Sw_0O36fClMncfn6A">https://github.com/hAPI-hacker/Hacking-APIs/tree/main/Wordlists</a></span><span class="c5">). If you can upload these sorts of files, the next step would be to see if you can execute them.</span></li></ul><p class="c7 c13"><span class="c5">In addition to relying on clues in the documentation, consider the features of a given endpoint to determine how a nefarious person could use them to their advantage. The challenging part about business logic flaws is that they are unique to each business. Identifying features as vulnerabilities will require putting on your evil genius cap and using your imagination.</span></p><h2 class="c15" id="h.5wwahdkn5to2"><span class="c10">Summary</span></h2><p class="c7 c17"><span class="c5">In this chapter, you learned how to find information about API requests so you can load it into Postman and begin your testing. Then you learned to use an API as it was intended and analyze responses for common vulnerabilities. You can use the described techniques to begin testing APIs for vulnerabilities. Sometimes all it takes is using the API with an adversarial mindset to make critical findings. In the next chapter, we will attack the API&rsquo;s authentication mechanisms.</span></p><h2 class="c15" id="h.akyyhxau7h2r"><span class="c20 c47 c51">Lab #4: Building a crAPI Collection and Discovering Excessive Data Exposure</span></h2><p class="c7 c17"><span class="c5">In Chapter 6, we discovered the existence of the crAPI API. Now we will use what we&rsquo;ve learned from this chapter to begin analyzing crAPI endpoints. In this lab, we will register an account, authenticate to crAPI, and analyze various features of the application. In Chapter 8, we&rsquo;ll attack the API&rsquo;s authentication process. For now, I will guide you through the natural progression from browsing a web application to analyzing API endpoints. We&rsquo;ll start by building a request collection from scratch and then work our way toward finding an excessive data exposure vulnerability with serious implications.</span></p><p class="c7 c13"><span class="c8">In the web browser of your Kali machine, navigate to the crAPI web application. In my case, the vulnerable app is located at 192.168.195.130, but yours might be different. Register an account with the crAPI web application. The crAPI registration page requires all fields to be filled out with password complexity requirements (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-16&amp;sa=D&amp;source=editors&amp;ust=1681144458131150&amp;usg=AOvVaw2dtBmpwP72TGskCTny34la">Figure 7-16</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 285.33px; height: 358.67px;"><img alt="Screenshot of the crAPI Signup page" src="images/image15.png" style="width: 285.33px; height: 358.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-16</span><span class="c18 c17 c14">: The crAPI account registration page</span></p><p class="c7 c13"><span class="c8">Since we know nothing about the APIs used in this application, we&rsquo;ll want to proxy the requests through Burp Suite to see what&rsquo;s going on below the GUI. Set up your proxy and click </span><span class="c29">Signup</span><span class="c8">&nbsp;to initiate the request. You should see that the application submits a POST request to the </span><span class="c8 c14">/identity/api/auth/signup</span><span class="c8">&nbsp;endpoint (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-17&amp;sa=D&amp;source=editors&amp;ust=1681144458132167&amp;usg=AOvVaw35FdEF2JULx--_pY-ynTSC">Figure 7-17</a></span><span class="c5">).</span></p><p class="c7 c13"><span class="c5">Notice that the request includes a JSON payload with all of the answers you provided in the registration form.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 494.67px; height: 310.67px;"><img alt="Screenshot of a POST request in Burp Suite" src="images/image8.png" style="width: 494.67px; height: 310.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-17</span><span class="c18 c17 c14">: An intercepted crAPI authentication request</span></p><p class="c7 c13"><span class="c8">Now that we&rsquo;ve discovered our first crAPI API request, we&rsquo;ll start building a Postman collection. Click the </span><span class="c29">Options</span><span class="c8">&nbsp;button under the collection and then add a new request. Make sure that the request you build in Postman matches the request you intercepted: a POST request to the </span><span class="c8 c14">/identity/api/auth/signup</span><span class="c8">&nbsp;endpoint with a JSON object as the body (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-18&amp;sa=D&amp;source=editors&amp;ust=1681144458133804&amp;usg=AOvVaw0HeVheVnP6pUbNYFrRdNs3">Figure 7-18</a></span><span class="c5">).</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 277.33px;"><img alt="Screenshot of a POST request body in Postman" src="images/image1.png" style="width: 624.00px; height: 277.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-18</span><span class="c18 c17 c14">: The crAPI registration request in Postman</span></p><p class="c7 c13"><span class="c5">Test the request to make sure you&rsquo;ve crafted it correctly, as there is actually a lot that you could get wrong at this point. For example, your endpoint or body could contain a typo, you could forget to change the request method from GET to POST, or maybe you didn&rsquo;t match the headers of the original request. The only way to find out if you copied it correctly is to send a request, see how the provider responds, and troubleshoot if needed. Here are a couple hints for troubleshooting this first request:</span></p><ul class="c28 lst-kix_ayy1qmcnnzr1-0 start"><li class="c1 li-bullet-0"><span class="c8">If you receive the status code 415 Unsupported Media Type, you need to update the </span><span class="c6">Content-Type</span><span class="c8">&nbsp;header so that the value is </span><span class="c8 c14">application/json</span><span class="c5">.</span></li><li class="c1 li-bullet-0"><span class="c5">The crAPI application won&rsquo;t allow you to create two accounts using the same number or email, so you may need to alter those values in the body of your request if you already registered in the GUI.</span></li></ul><p class="c7 c13"><span class="c5">You&rsquo;ll know your request is ready when you receive a status 200 OK as a response. Once you receive a successful response, make sure to save your request!</span></p><p class="c7 c13"><span class="c8">Now that we&rsquo;ve saved the registration request to our crAPI collection, log in to the web app to see what other API artifacts there are to discover. Proxy the login request using the email and password you registered. When you submit a successful login request, you should receive a Bearer token from the application (see </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-19&amp;sa=D&amp;source=editors&amp;ust=1681144458135094&amp;usg=AOvVaw2KXATwuDbfA7rbE29Wjbzz">Figure 7-19</a></span><span class="c5">). You&rsquo;ll need to include this Bearer token in all of your authenticated requests moving forward.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 533.33px; height: 264.00px;"><img alt="Screenshot of an HTTP response in Burp Suite with the Authorization field of the body highlighted" src="images/image10.png" style="width: 533.33px; height: 264.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-19</span><span class="c18 c17 c14">: An intercepted request after a successful login to crAPI</span></p><p class="c7 c13"><span class="c8">Add this Bearer token to your collection, either as an authorization method or a variable. I saved mine as an authorization method with the Type set to Bearer Token, as seen in </span><span class="c22 c14"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23figure7-20&amp;sa=D&amp;source=editors&amp;ust=1681144458136084&amp;usg=AOvVaw3YeK3NkuUP57b2JLzyFG6v">Figure 7-20</a></span><span class="c5">.</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 526.67px; height: 312.00px;"><img alt="Screenshot of the Postman &ldquo;Edit Collection&rdquo; tab with a Bearer Token saved in the Authorization menu item" src="images/image9.png" style="width: 526.67px; height: 312.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12"><span class="c9">Figure 7-20</span><span class="c18 c17 c14">: The Postman collection editor</span></p><p class="c7 c13"><span class="c5">Continue using the application in the browser, proxying its traffic, and saving the requests you discover to your collection. Try using different parts of the application, such as the dashboard, shop, and community, to name a few. Be sure to look for the kind of interesting functionality we discussed in this chapter.</span></p><p class="c7 c13"><span class="c8">One endpoint in particular should catch your attention simply based on the fact that it involves other crAPI users: the forum. Use the crAPI forum as it was intended in your browser and intercept the request. Submitting a comment to the forum will generate a POST request. Save the POST request to the collection. Now send the request used to populate the community forum to the </span><span class="c8 c14">/community/api/v2/community/posts/recent</span><span class="c8">&nbsp;endpoint. Notice anything significant in the JSON response body in </span><span class="c14 c22"><a class="c4" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c07.xhtml%23listing7-1&amp;sa=D&amp;source=editors&amp;ust=1681144458137702&amp;usg=AOvVaw2kPQOOQAMFpdLCyMhLc2Hm">Listing 7-1</a></span><span class="c5">?</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;&quot;id&quot;: &quot;fyRGJWyeEjKexxyYpQcRdZ&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;title&quot;: &quot;test&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;content&quot;: &quot;test&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;author&quot;: {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;nickname&quot;: &quot;hapi hacker&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;email&quot;: &quot;a@b.com&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;vehicleid&quot;: &quot;493f426c-a820-402e-8be8-bbfc52999e7c&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;profile_pic_url&quot;: &quot;&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;created_at&quot;: &quot;2021-02-14T21:38:07.126Z&quot;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; },</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;comments&quot;: [],</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;authorid&quot;: 6,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;CreatedAt&quot;: &quot;2021-02-14T21:38:07.126Z&quot;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; },</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;id&quot;: &quot;CLnAGQPR4qDCwLPgTSTAQU&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;title&quot;: &quot;Title 3&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;content&quot;: &quot;Hello world 3&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;author&quot;: {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;nickname&quot;: &quot;Robot&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;email&quot;: &quot;robot001@example.com&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;vehicleid&quot;: &quot;76442a32-f32f-4d7d-ae05-3e8c995f68ce&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;profile_pic_url&quot;: &quot;&quot;,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;created_at&quot;: &quot;2021-02-14T19:02:42.907Z&quot;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; },</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;comments&quot;: [],</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;authorid&quot;: 3,</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &quot;CreatedAt&quot;: &quot;2021-02-14T19:02:42.907Z&quot;</span></p><p class="c35"><span class="c2">&nbsp; &nbsp; &nbsp;}</span></p><p class="c7 c17"><span class="c22 c14">Listing 7-1</span><span class="c8 c20 c14">: A sample of the JSON response received from the /community/api/v2/community/posts/recent endpoint</span></p><p class="c7 c13"><span class="c5">Not only do you receive the JSON object for your post, you also receive the information about every post on the forum. Those objects contain much more information than is necessary, including sensitive information such as user IDs, email addresses, and vehicle IDs. If you&rsquo;ve made it this far, congratulations; this means you&rsquo;ve discovered an excessive data exposure vulnerability. Great job! There are many more vulnerabilities affecting crAPI, and we&rsquo;ll definitely use our findings here to help locate even more severe vulnerabilities in the upcoming chapters.</span></p><p class="c3 c37"><span class="c20 c47 c53"></span></p></body></html>