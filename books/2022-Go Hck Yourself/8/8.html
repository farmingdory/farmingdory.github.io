<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_ycw8g7wm6soy-0.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-0 0}ol.lst-kix_1ar2b9e9l6a1-2.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-2 0}ol.lst-kix_ct7i9ci1pnxr-7.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-7 0}.lst-kix_ycw8g7wm6soy-7>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-7,lower-latin) ". "}ol.lst-kix_7eh7u0wtjs6-2.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-2 0}.lst-kix_ycw8g7wm6soy-6>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-6,decimal) ". "}ol.lst-kix_fuu4lpch6vbo-7.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-7 0}ol.lst-kix_ct7i9ci1pnxr-7{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-6{list-style-type:none}.lst-kix_fuu4lpch6vbo-3>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-3}.lst-kix_ycw8g7wm6soy-0>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-0}ol.lst-kix_ct7i9ci1pnxr-8{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-3{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-2{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-5{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-4{list-style-type:none}.lst-kix_ycw8g7wm6soy-8>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-8,lower-roman) ". "}ol.lst-kix_ct7i9ci1pnxr-1{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-0{list-style-type:none}.lst-kix_ct7i9ci1pnxr-3>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-3}.lst-kix_co0f9gw2xaxb-2>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-2}ol.lst-kix_ycw8g7wm6soy-6.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-6 0}.lst-kix_fuu4lpch6vbo-1>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-1}.lst-kix_ycw8g7wm6soy-2>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-2}ol.lst-kix_1ar2b9e9l6a1-8.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-8 0}.lst-kix_7eh7u0wtjs6-7>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-7}.lst-kix_1ar2b9e9l6a1-4>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-4}ol.lst-kix_7eh7u0wtjs6-7.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-7 0}ol.lst-kix_ct7i9ci1pnxr-2.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-2 0}ol.lst-kix_co0f9gw2xaxb-1.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-1 0}.lst-kix_1ar2b9e9l6a1-2>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-2}ol.lst-kix_co0f9gw2xaxb-5{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-6{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-7{list-style-type:none}.lst-kix_1ar2b9e9l6a1-8>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-8}ol.lst-kix_co0f9gw2xaxb-8{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-1{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-2{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-7.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-7 0}ol.lst-kix_co0f9gw2xaxb-3{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-0.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-0 0}ol.lst-kix_co0f9gw2xaxb-4{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-7.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-7 0}ol.lst-kix_co0f9gw2xaxb-0{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-5.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-5 0}ol.lst-kix_7eh7u0wtjs6-7{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-8{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-5{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-6{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-3{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-4{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-1{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-2{list-style-type:none}ol.lst-kix_7eh7u0wtjs6-0{list-style-type:none}ol.lst-kix_ct7i9ci1pnxr-1.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-1 0}ol.lst-kix_1ar2b9e9l6a1-1.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-1 0}ol.lst-kix_co0f9gw2xaxb-6.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-6 0}.lst-kix_fuu4lpch6vbo-8>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-8,lower-roman) ". "}ol.lst-kix_ct7i9ci1pnxr-6.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-6 0}.lst-kix_ct7i9ci1pnxr-5>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-5}.lst-kix_fuu4lpch6vbo-5>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-5,lower-roman) ". "}.lst-kix_fuu4lpch6vbo-6>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-6,decimal) ". "}.lst-kix_fuu4lpch6vbo-7>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-7,lower-latin) ". "}.lst-kix_ycw8g7wm6soy-4>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-4,lower-latin) ". "}.lst-kix_fuu4lpch6vbo-1>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-1,lower-latin) ". "}.lst-kix_fuu4lpch6vbo-2>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-2,lower-roman) ". "}.lst-kix_ycw8g7wm6soy-3>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-3,decimal) ". "}.lst-kix_ycw8g7wm6soy-5>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-5,lower-roman) ". "}.lst-kix_7eh7u0wtjs6-0>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-0}.lst-kix_co0f9gw2xaxb-0>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-0}.lst-kix_fuu4lpch6vbo-0>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-0,decimal) ". "}.lst-kix_fuu4lpch6vbo-4>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-4,lower-latin) ". "}.lst-kix_7eh7u0wtjs6-3>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-3}.lst-kix_ycw8g7wm6soy-0>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-0,decimal) ". "}.lst-kix_co0f9gw2xaxb-6>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-6}.lst-kix_fuu4lpch6vbo-5>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-5}.lst-kix_ycw8g7wm6soy-1>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-1,lower-latin) ". "}.lst-kix_ycw8g7wm6soy-2>li:before{content:"" counter(lst-ctn-kix_ycw8g7wm6soy-2,lower-roman) ". "}.lst-kix_fuu4lpch6vbo-3>li:before{content:"" counter(lst-ctn-kix_fuu4lpch6vbo-3,decimal) ". "}.lst-kix_7eh7u0wtjs6-1>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-1,lower-latin) ". "}ol.lst-kix_ct7i9ci1pnxr-0.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-0 0}.lst-kix_7eh7u0wtjs6-3>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-3,decimal) ". "}.lst-kix_7eh7u0wtjs6-7>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-7,lower-latin) ". "}.lst-kix_ct7i9ci1pnxr-3>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-3,decimal) ". "}.lst-kix_7eh7u0wtjs6-5>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-5,lower-roman) ". "}ol.lst-kix_ycw8g7wm6soy-4.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-4 0}ol.lst-kix_co0f9gw2xaxb-2.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-2 0}.lst-kix_co0f9gw2xaxb-7>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-7}ol.lst-kix_fuu4lpch6vbo-0.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-0 0}ol.lst-kix_fuu4lpch6vbo-8{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-7{list-style-type:none}.lst-kix_ct7i9ci1pnxr-5>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-5,lower-roman) ". "}.lst-kix_ct7i9ci1pnxr-7>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-7,lower-latin) ". "}ol.lst-kix_co0f9gw2xaxb-5.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-5 0}ol.lst-kix_fuu4lpch6vbo-6{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-5{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-4{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-3{list-style-type:none}.lst-kix_7eh7u0wtjs6-4>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-4}.lst-kix_co0f9gw2xaxb-8>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-8}.lst-kix_ycw8g7wm6soy-5>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-5}ol.lst-kix_fuu4lpch6vbo-3.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-3 0}.lst-kix_ct7i9ci1pnxr-1>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-1,lower-latin) ". "}ol.lst-kix_ct7i9ci1pnxr-8.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-8 0}ol.lst-kix_fuu4lpch6vbo-2.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-2 0}.lst-kix_ct7i9ci1pnxr-1>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-1}.lst-kix_ct7i9ci1pnxr-7>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-7}.lst-kix_ct7i9ci1pnxr-6>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-6}.lst-kix_ct7i9ci1pnxr-0>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-0}ol.lst-kix_7eh7u0wtjs6-8.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-8 0}ol.lst-kix_ycw8g7wm6soy-2.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-2 0}.lst-kix_ycw8g7wm6soy-4>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-4}.lst-kix_7eh7u0wtjs6-5>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-5}ol.lst-kix_fuu4lpch6vbo-1.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-1 0}ol.lst-kix_ycw8g7wm6soy-1.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-1 0}ol.lst-kix_co0f9gw2xaxb-3.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-3 0}.lst-kix_1ar2b9e9l6a1-3>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-3}.lst-kix_ct7i9ci1pnxr-4>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-4}.lst-kix_7eh7u0wtjs6-8>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-8}.lst-kix_ycw8g7wm6soy-1>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-1}ol.lst-kix_7eh7u0wtjs6-5.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-5 0}.lst-kix_1ar2b9e9l6a1-5>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-5}.lst-kix_co0f9gw2xaxb-1>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-1}ol.lst-kix_ycw8g7wm6soy-8{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-7{list-style-type:none}.lst-kix_fuu4lpch6vbo-4>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-4}ol.lst-kix_ycw8g7wm6soy-2{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-1{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-0{list-style-type:none}ol.lst-kix_co0f9gw2xaxb-4.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-4 0}ol.lst-kix_ycw8g7wm6soy-6{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-5{list-style-type:none}ol.lst-kix_ycw8g7wm6soy-4{list-style-type:none}.lst-kix_co0f9gw2xaxb-2>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-2,lower-roman) ". "}ol.lst-kix_ycw8g7wm6soy-3{list-style-type:none}.lst-kix_1ar2b9e9l6a1-1>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-1,lower-latin) ". "}ol.lst-kix_1ar2b9e9l6a1-5.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-5 0}.lst-kix_1ar2b9e9l6a1-3>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-3,decimal) ". "}.lst-kix_co0f9gw2xaxb-1>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-1,lower-latin) ". "}.lst-kix_1ar2b9e9l6a1-0>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-0,decimal) ". "}.lst-kix_1ar2b9e9l6a1-4>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-4,lower-latin) ". "}.lst-kix_1ar2b9e9l6a1-7>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-7}.lst-kix_co0f9gw2xaxb-0>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-0,decimal) ". "}.lst-kix_1ar2b9e9l6a1-2>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-2,lower-roman) ". "}ol.lst-kix_ycw8g7wm6soy-3.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-3 0}.lst-kix_1ar2b9e9l6a1-7>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-7,lower-latin) ". "}.lst-kix_1ar2b9e9l6a1-8>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-8,lower-roman) ". "}.lst-kix_co0f9gw2xaxb-8>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-8,lower-roman) ". "}.lst-kix_1ar2b9e9l6a1-5>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-5,lower-roman) ". "}.lst-kix_1ar2b9e9l6a1-6>li:before{content:"" counter(lst-ctn-kix_1ar2b9e9l6a1-6,decimal) ". "}.lst-kix_ycw8g7wm6soy-3>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-3}.lst-kix_co0f9gw2xaxb-3>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-3,decimal) ". "}.lst-kix_co0f9gw2xaxb-5>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-5,lower-roman) ". "}.lst-kix_co0f9gw2xaxb-4>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-4,lower-latin) ". "}.lst-kix_co0f9gw2xaxb-7>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-7,lower-latin) ". "}ol.lst-kix_7eh7u0wtjs6-0.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-0 0}.lst-kix_co0f9gw2xaxb-6>li:before{content:"" counter(lst-ctn-kix_co0f9gw2xaxb-6,decimal) ". "}ol.lst-kix_fuu4lpch6vbo-5.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-5 0}ol.lst-kix_fuu4lpch6vbo-2{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-1{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-0{list-style-type:none}.lst-kix_ct7i9ci1pnxr-2>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-2}.lst-kix_7eh7u0wtjs6-6>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-6}ol.lst-kix_1ar2b9e9l6a1-0.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-0 0}ol.lst-kix_7eh7u0wtjs6-6.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-6 0}.lst-kix_co0f9gw2xaxb-3>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-3}ol.lst-kix_fuu4lpch6vbo-4.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-4 0}.lst-kix_fuu4lpch6vbo-2>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-2}.lst-kix_ct7i9ci1pnxr-8>li{counter-increment:lst-ctn-kix_ct7i9ci1pnxr-8}.lst-kix_fuu4lpch6vbo-8>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-8}.lst-kix_7eh7u0wtjs6-0>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-0,decimal) ". "}.lst-kix_ycw8g7wm6soy-6>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-6}.lst-kix_7eh7u0wtjs6-2>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-2,lower-roman) ". "}ol.lst-kix_ct7i9ci1pnxr-3.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-3 0}ol.lst-kix_1ar2b9e9l6a1-6.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-6 0}.lst-kix_7eh7u0wtjs6-4>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-4,lower-latin) ". "}.lst-kix_7eh7u0wtjs6-8>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-8,lower-roman) ". "}.lst-kix_ct7i9ci1pnxr-4>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-4,lower-latin) ". "}.lst-kix_7eh7u0wtjs6-2>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-2}ol.lst-kix_ycw8g7wm6soy-7.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-7 0}.lst-kix_fuu4lpch6vbo-7>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-7}.lst-kix_7eh7u0wtjs6-6>li:before{content:"" counter(lst-ctn-kix_7eh7u0wtjs6-6,decimal) ". "}.lst-kix_ct7i9ci1pnxr-6>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-6,decimal) ". "}.lst-kix_ycw8g7wm6soy-7>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-7}.lst-kix_co0f9gw2xaxb-5>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-5}.lst-kix_ycw8g7wm6soy-8>li{counter-increment:lst-ctn-kix_ycw8g7wm6soy-8}.lst-kix_7eh7u0wtjs6-1>li{counter-increment:lst-ctn-kix_7eh7u0wtjs6-1}.lst-kix_1ar2b9e9l6a1-1>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-1}ol.lst-kix_co0f9gw2xaxb-8.start{counter-reset:lst-ctn-kix_co0f9gw2xaxb-8 0}.lst-kix_fuu4lpch6vbo-6>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-6}.lst-kix_ct7i9ci1pnxr-2>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-2,lower-roman) ". "}ol.lst-kix_7eh7u0wtjs6-1.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-1 0}.lst-kix_ct7i9ci1pnxr-0>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-0,decimal) ". "}ol.lst-kix_fuu4lpch6vbo-6.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-6 0}ol.lst-kix_ct7i9ci1pnxr-5.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-5 0}ol.lst-kix_7eh7u0wtjs6-4.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-4 0}ol.lst-kix_1ar2b9e9l6a1-4.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-4 0}ol.lst-kix_1ar2b9e9l6a1-1{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-0{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-5{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-4{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-3{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-2{list-style-type:none}.lst-kix_fuu4lpch6vbo-0>li{counter-increment:lst-ctn-kix_fuu4lpch6vbo-0}ol.lst-kix_1ar2b9e9l6a1-8{list-style-type:none}.lst-kix_co0f9gw2xaxb-4>li{counter-increment:lst-ctn-kix_co0f9gw2xaxb-4}ol.lst-kix_1ar2b9e9l6a1-7{list-style-type:none}ol.lst-kix_1ar2b9e9l6a1-6{list-style-type:none}ol.lst-kix_fuu4lpch6vbo-8.start{counter-reset:lst-ctn-kix_fuu4lpch6vbo-8 0}ol.lst-kix_ct7i9ci1pnxr-4.start{counter-reset:lst-ctn-kix_ct7i9ci1pnxr-4 0}.lst-kix_ct7i9ci1pnxr-8>li:before{content:"" counter(lst-ctn-kix_ct7i9ci1pnxr-8,lower-roman) ". "}.lst-kix_1ar2b9e9l6a1-6>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-6}ol.lst-kix_7eh7u0wtjs6-3.start{counter-reset:lst-ctn-kix_7eh7u0wtjs6-3 0}ol.lst-kix_1ar2b9e9l6a1-3.start{counter-reset:lst-ctn-kix_1ar2b9e9l6a1-3 0}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_ycw8g7wm6soy-8.start{counter-reset:lst-ctn-kix_ycw8g7wm6soy-8 0}.lst-kix_1ar2b9e9l6a1-0>li{counter-increment:lst-ctn-kix_1ar2b9e9l6a1-0}ol{margin:0;padding:0}table td,table th{padding:0}.c9{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;text-indent:12pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c14{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c20{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c26{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c23{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c5{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-top-style:solid;background-color:#ffffff;margin-left:54pt;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c1{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c11{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman"}.c8{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman"}.c15{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c21{padding-top:18pt;padding-bottom:18pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c19{padding-top:24pt;padding-bottom:24pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c27{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:54pt;font-family:"Times New Roman"}.c25{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:40.5pt;font-family:"Times New Roman"}.c2{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c10{background-color:#eef2f6;color:#3d3b49;font-weight:400;font-size:12pt;font-family:"Courier New"}.c0{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c17{color:#3d3b49;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c12{font-size:9.5pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c22{color:#3d3b49;font-weight:700;font-size:14.5pt;font-family:"Times New Roman"}.c24{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c28{background-color:#000000;font-size:10pt;color:#ffffff;font-weight:700}.c3{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c7{text-decoration:none;vertical-align:baseline;font-style:normal}.c18{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c16{padding:0;margin:0}.c6{color:inherit;text-decoration:inherit}.c13{text-decoration:none;vertical-align:baseline}.c29{height:11pt}.c4{font-style:italic}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c18 doc-content"><h1 class="c26" id="h.fv1eiimkrlx"><span class="c7 c27">8</span></h1><h1 class="c26" id="h.fv1eiimkrlx-1"><span class="c25 c7">WEB HACKING</span></h1><p class="c19"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 200.00px; height: 200.00px;"><img alt="" src="images/image6.png" style="width: 200.00px; height: 200.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c14"><span class="c0">Hacking an individual computer might yield a handful of usernames, passwords, and other data. But hacking a web server could give an attacker </span><span class="c0 c4">millions</span><span class="c0 c7">&nbsp;of usernames and passwords to test on banking sites, email servers, and more.</span></p><p class="c9"><span class="c0">A 2019 attack on Quest Diagnostics through a flaw in its web payment page exposed 12 million patients&rsquo; records. In 2017, the credit bureau Equifax failed to protect 150 million people&rsquo;s credit information, including birth dates, Social Security numbers, and addresses. A hack against Marriott in 2018 compromised 500 million travelers&rsquo; data, including credit card numbers and passport data. The largest data breach to date&mdash;the 2013 attack on web search engine and email platform Yahoo!&mdash;exposed all 3 </span><span class="c0 c4">billion</span><span class="c0 c7">&nbsp;users&rsquo; accounts, including email addresses and passwords.</span></p><p class="c9"><span class="c0 c7">In this chapter, you&rsquo;ll see how malicious hackers attack web applications with only a web browser and a few lines of code. You&rsquo;ll also learn some common ways security professionals defend against web attacks, safeguarding millions (perhaps billions!) of people&rsquo;s data from cybercriminals.</span></p><h2 class="c20" id="h.1bhiu3873ozj"><span class="c17 c7">The Metasploitable VM</span></h2><p class="c14"><span class="c0 c7">We want to practice web hacking safely and ethically, so we&rsquo;ll set up a web server in our virtual hacking lab. The creators of Metasploit also created an intentionally vulnerable web server, called Metasploitable, for training purposes. We&rsquo;re going to use a version of that server that I&rsquo;ve customized for you. Let&rsquo;s add it to your virtual hacking lab:</span></p><ol class="c16 lst-kix_1ar2b9e9l6a1-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">Go to </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://www.nostarch.com/go-hck-yourself/&amp;sa=D&amp;source=editors&amp;ust=1679432065294135&amp;usg=AOvVaw1Wfw6izj6QJtyhqUTSIKo_">https://www.nostarch.com/go-hck-yourself/</a></span><span class="c0">&nbsp;and click the link to download the </span><span class="c0 c4">Metasploitable2-gohack.ova</span><span class="c0 c7">&nbsp;file to your host computer.</span></li><li class="c5 li-bullet-0"><span class="c0">Double-click the downloaded file to open it in VirtualBox. The Import Virtual Appliance window will open, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-1&amp;sa=D&amp;source=editors&amp;ust=1679432065295037&amp;usg=AOvVaw3tJSGiyd8eH-PiFc5VFD1U">Figure 8-1</a></span><span class="c0">. Click </span><span class="c3">Import</span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 600.00px;"><img alt="f08001" src="images/image2.png" style="width: 624.00px; height: 600.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-1</span><span class="c0 c13 c4">: Importing the Metasploitable2-gohack.ova file into VirtualBox</span></li><li class="c5 li-bullet-0"><span class="c0">Select the Metasploitable2 VM in the VirtualBox VM Manager and click </span><span class="c3">Settings</span><span class="c0 c7">.</span></li><li class="c5 li-bullet-0"><span class="c0">Go to the </span><span class="c3">Network</span><span class="c0">&nbsp;tab and make sure the Enable Network Adapter box is checked and shows Attached to: NAT Network and Name: PublicNAT, just as for our other VMs. The correct settings are shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-2&amp;sa=D&amp;source=editors&amp;ust=1679432065296365&amp;usg=AOvVaw2DeLsix4AV5nvLfAc7BW5n">Figure 8-2</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 333.33px;"><img alt="f08002" src="images/image3.png" style="width: 624.00px; height: 333.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-2</span><span class="c0 c13 c4">: Making sure the Metasploitable VM is connected to the PublicNAT network</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">OK</span><span class="c0 c7">&nbsp;to save these network settings. Your new Metasploitable VM is now ready to run!</span></li><li class="c5 li-bullet-0"><span class="c0">Select Metasploitable in VirtualBox Manager and click </span><span class="c3">Start</span><span class="c0">. Because Metasploitable is a web server, not a desktop computer, it uses a text-based interface instead of a graphical user interface. If the interface is too small to read, go to the VM&rsquo;s menu bar and select </span><span class="c3">View</span><span class="c12">&#9654;</span><span class="c3">Virtual Screen 1</span><span class="c12">&#9654;</span><span class="c3">Scale to 200%</span><span class="c0 c7">&nbsp;(or another value that fits your screen).</span></li><li class="c5 li-bullet-0"><span class="c0">Enter the username </span><span class="c2">msfadmin</span><span class="c0">&nbsp;and password </span><span class="c2">msfadmin</span><span class="c0">. The password won&rsquo;t show up as you type in the terminal window on Metasploitable, but if you enter it correctly, the prompt will change from the login to a shell prompt like this one:<br></span><span class="c10 c7">msfadmin@metasploitable:~$</span></li></ol><p class="c15"><span class="c0">Enter this command:<br></span><span class="c10">msfadmin@metasploitable:~$ </span><span class="c2">ip a<br></span><span class="c0">Metasploitable will respond with its IP address (</span><span class="c2">10.0.9.8</span><span class="c0">&nbsp;in my case):<br></span><span class="c10 c7">--snip--</span></p><p class="c15"><span class="c10 c7">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp; link/ether 08:00:27:11:23:67 brd ff:ff:ff:ff:ff:ff</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp; inet 1 10.0.9.8/24 brd 10.0.9.255 scope global eth0 </span></p><ol class="c16 lst-kix_1ar2b9e9l6a1-0" start="8"><li class="c5 li-bullet-0"><span class="c10">--snip--<br></span><span class="c0 c7">Take note of the IP address 1. You&rsquo;ll need it to surf to the Metasploitable VM&rsquo;s web server from your other virtual machines.</span></li></ol><h2 class="c20" id="h.ol8vwvqp5871"><span class="c17 c7">Web Hacking from a Browser</span></h2><p class="c14"><span class="c0">Web hacking is very common because it&rsquo;s rewarding for attackers (remember, a successful attack against a web server can yield </span><span class="c0 c4">millions</span><span class="c0 c7">&nbsp;of users&rsquo; information at once), web servers are always on and connected to the internet, and the attacker needs only a web browser to do it. To see how it works, we&rsquo;ll hack the Metasploitable server from the Edge browser in our Windows 10 VM.</span></p><p class="c9"><span class="c0">Start your Windows 10 VM in VirtualBox Manager. Log in with the credentials </span><span class="c2">IEUser</span><span class="c0">&nbsp;and </span><span class="c2">Passw0rd!</span><span class="c0">. Open the Edge browser (it&rsquo;s the blue </span><span class="c0 c4">e</span><span class="c0">&nbsp;swirl icon on the taskbar) and enter your Metasploitable VM&rsquo;s IP address into the address bar. You&rsquo;ll see the Metasploitable 2 home page shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-3&amp;sa=D&amp;source=editors&amp;ust=1679432065306412&amp;usg=AOvVaw1ZHq-j7I9izWKZIYXSX8UK">Figure 8-3</a></span><span class="c0 c7">.</span></p><p class="c19"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08003" src="images/image4.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c23"><span class="c1">Figure 8-3</span><span class="c11 c4">: From your Windows 10 VM, enter your Metasploitable VM&rsquo;s IP address to see this home page.</span></p><p class="c9"><span class="c0 c7">Metasploitable 2 contains five vulnerable web applications, but we&rsquo;ll focus on just one of them: DVWA, or Darn Vulnerable Web App. This intentionally vulnerable open source web application was built to help web developers and security professionals learn basic hacks, as well as how to protect a web application from them. DVWA has different vulnerability levels so users can try hacking applications with varying degrees of security. We&rsquo;ll set the security level to low, to simulate a web application with no added security.</span></p><ol class="c16 lst-kix_ct7i9ci1pnxr-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">Click the </span><span class="c3">DVWA</span><span class="c0">&nbsp;link on the Metasploitable 2 home page. You&rsquo;ll see the app&rsquo;s login screen, shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-4&amp;sa=D&amp;source=editors&amp;ust=1679432065308081&amp;usg=AOvVaw1WxXYZ28s92wfpZ7dax6jH">Figure 8-4</a></span><span class="c0 c7">.</span></li><li class="c5 li-bullet-0"><span class="c0">Enter </span><span class="c2">admin</span><span class="c0">&nbsp;as the username and </span><span class="c2">password</span><span class="c0">&nbsp;as the password to access DVWA.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08004" src="images/image9.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-4</span><span class="c0 c13 c4">: The DVWA login screen with our credentials</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">DVWA Security </span><span class="c0 c7">on the left.</span></li><li class="c5 li-bullet-0"><span class="c0">Under the Script Security section, set the security level to </span><span class="c3">low</span><span class="c0">&nbsp;and click </span><span class="c3">Submit</span><span class="c0">, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-5&amp;sa=D&amp;source=editors&amp;ust=1679432065309841&amp;usg=AOvVaw1WK3rpHWPPoMzx8DsyR89Q">Figure 8-5</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08005" src="images/image1.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-5</span><span class="c0 c13 c4">: Setting the DVWA script security level to low</span></li></ol><p class="c9"><span class="c0 c7">Now we&rsquo;re ready to try out two kinds of web attacks on DVWA: cross-site scripting attacks and SQL injection attacks.</span></p><h3 class="c20" id="h.e9pmm4s164s3"><span class="c7 c22">Launching Cross-Site Scripting Attacks</span></h3><p class="c14"><span class="c0">In a</span><span class="c0 c4">&nbsp;cross-site scripting (XSS) attack</span><span class="c0">, a hacker enters malicious code into a web page through a field intended for regular text input, such as a login form or a search field. XSS attacks are also known as </span><span class="c0 c4">code injection</span><span class="c0">&nbsp;attacks, because hackers are able to enter, or </span><span class="c0 c4">inject</span><span class="c0 c7">, their own code into the web application. We&rsquo;ll use two web languages&mdash;JavaScript and HyperText Markup Language (HTML)&mdash;to inject a script into DVWA.</span></p><p class="c9"><span class="c0 c7">To test a web application for XSS vulnerabilities, you need only a single JavaScript command:</span></p><p class="c21"><span class="c10 c7">alert(&quot;You&#39;ve been hacked!&quot;);</span></p><p class="c9"><span class="c0">The command pops up an alert box reading &ldquo;You&rsquo;ve been hacked!&rdquo; To inject it into a web page, we wrap the JavaScript code in the proper HTML tags, </span><span class="c2">&lt;script&gt;</span><span class="c0">&nbsp;and </span><span class="c2">&lt;/script&gt;</span><span class="c0 c7">, like this:</span></p><p class="c21"><span class="c10 c7">&lt;script&gt;alert(&quot;You&#39;ve been hacked!&quot;);&lt;/script&gt;</span></p><p class="c9"><span class="c0">The HTML </span><span class="c2">&lt;script&gt;</span><span class="c0">&nbsp;tag tells a web page that a </span><span class="c0 c4">script</span><span class="c0">&nbsp;(a short piece of code), usually in JavaScript, is beginning. The </span><span class="c2">&lt;/script&gt;</span><span class="c0 c7">&nbsp;tag is called a closing tag, and it lets the web page know the script code is finished.</span></p><h4 class="c20" id="h.8f6ff7wotwsj"><span class="c3 c7">Reflected Cross-Site Scripting</span></h4><p class="c14"><span class="c0">A </span><span class="c0 c4">reflected XSS attack</span><span class="c0">&nbsp;takes advantage of pages that display, or </span><span class="c0 c4">reflect</span><span class="c0 c7">, a user&rsquo;s input directly back to them on the web page, like an order form that asks for your name and address and then displays them to you to confirm that you typed them correctly. Attackers use reflected cross-site scripting to inject malicious HTML or JavaScript code into an unprotected web application. Let&rsquo;s try it out!</span></p><ol class="c16 lst-kix_7eh7u0wtjs6-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">In DVWA on your Windows 10 VM, click </span><span class="c3">XSS reflected </span><span class="c0">on the left to open the Vulnerability: Reflected Cross Site Scripting (XSS) web page.<br>This page is designed to reflect your input into the What&rsquo;s your name? text field by displaying it to you, after the word </span><span class="c0 c4">Hello</span><span class="c0">. For example, if you enter the name </span><span class="c2">Bryson</span><span class="c0">, the page will respond with </span><span class="c2">Hello Bryson</span><span class="c0 c7">.</span></li><li class="c5 li-bullet-0"><span class="c0">Instead of your name, enter the HTML/JavaScript command from the previous section into the name text field, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-6&amp;sa=D&amp;source=editors&amp;ust=1679432065314442&amp;usg=AOvVaw00DflxytvmqQV9lxIb6Zbj">Figure 8-6</a></span><span class="c0">:<br></span><span class="c2">&lt;script&gt;alert(&quot;You&#39;ve been hacked!&quot;);&lt;/script&gt;<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08006" src="images/image12.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2"><br></span><span class="c8 c4">Figure 8-6</span><span class="c0 c13 c4">: Attacking the reflected XSS page by entering HTML and JavaScript into the text box</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">Submit</span><span class="c0">, and the web page will reload, popping up the message &ldquo;You&rsquo;ve been hacked!&rdquo; as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-7&amp;sa=D&amp;source=editors&amp;ust=1679432065315665&amp;usg=AOvVaw28WKtPz5zjpPzvcwqk4inx">Figure 8-7</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 458.67px; height: 137.33px;"><img alt="f08007" src="images/image11.png" style="width: 458.67px; height: 137.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-7</span><span class="c0 c13 c4">: The vulnerable web page pops up a message saying we&rsquo;ve been hacked!</span></li></ol><p class="c9"><span class="c0 c7">By combining a single line of HTML and JavaScript and entering it into an unprotected text box in DVWA, we injected our code into the web page. A malicious attacker could use the same technique to convince a user that their computer is really under attack and get them to call a toll-free number for &ldquo;technical support.&rdquo; In this common scam, criminals rent a call center to take worried victims&rsquo; credit card information and charge them for fake computer services.</span></p><h4 class="c20" id="h.i1uyj2cuv0uo"><span class="c3 c7">Stored Cross-Site Scripting</span></h4><p class="c14"><span class="c0">Most websites use databases to store user input or information that changes often, such as product information or customer data. If an attacker injects malicious code into a web form tied to a database, that malicious code gets stored in the database and becomes a permanent part of the web page. This type of attack, called a </span><span class="c0 c4">stored XSS attack</span><span class="c0 c7">, ensures that the malicious code will run every time someone views the affected web page. By contrast, our reflected XSS attack didn&rsquo;t permanently change the web page since our injected code wasn&rsquo;t saved to a database. We&rsquo;ll try out a stored XSS attack now.</span></p><ol class="c16 lst-kix_ycw8g7wm6soy-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">XSS stored</span><span class="c0 c7">&nbsp;in the DVWA menu at the left. You&rsquo;ll see a guestbook-like application that allows a user to save their name and a short message to the page.</span></li><li class="c5 li-bullet-0"><span class="c0">Instead of signing the guestbook with your name and a nice message, enter just your name. Then, in the Message text box, enter the XSS attack code that we want to store in this page&rsquo;s database, </span><span class="c2">&lt;script&gt;alert(&quot;You&#39;ve been hacked!&quot;);&lt;/script&gt;</span><span class="c0">, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-8&amp;sa=D&amp;source=editors&amp;ust=1679432065317758&amp;usg=AOvVaw0ZtJgvg7FT-O-4_oUMbN9d">Figure 8-8</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08008" src="images/image8.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c4 c8">Figure 8-8</span><span class="c0 c13 c4">: Storing our malicious script in the XSS stored page in DVWA</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">Sign Guestbook</span><span class="c0">, and you&rsquo;ll see the alert pop up, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-9&amp;sa=D&amp;source=editors&amp;ust=1679432065318890&amp;usg=AOvVaw3OSDHgERM56USM37i3uy-d">Figure 8-9</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 457.33px; height: 180.00px;"><img alt="f08009" src="images/image10.png" style="width: 457.33px; height: 180.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-9</span><span class="c0 c4 c13">: Our JavaScript alert will tell every visitor, &ldquo;You&rsquo;ve been hacked!&rdquo;</span></li></ol><p class="c9"><span class="c0 c7">Unlike in the reflected attack, this alert will pop up every time someone visits the Stored Cross Site Scripting (XSS) guestbook page. You&rsquo;ve used a database-driven web page to permanently store a malicious script in the DVWA website.</span></p><p class="c9"><span class="c0">JavaScript can do much more than pop up an alert message, though. Let&rsquo;s change the browser&rsquo;s </span><span class="c2">window.location</span><span class="c0 c7">&nbsp;to redirect users to a completely different website:</span></p><ol class="c16 lst-kix_co0f9gw2xaxb-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">Load the XSS stored web page again and click </span><span class="c3">OK</span><span class="c0 c7">&nbsp;to close the alert message pop-up.</span></li><li class="c5 li-bullet-0"><span class="c0">This time, after entering your name as usual, enter the following code into the Message text box, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-10&amp;sa=D&amp;source=editors&amp;ust=1679432065320616&amp;usg=AOvVaw3BhfJrMTXv638kGGjoNrEe">Figure 8-10</a></span><span class="c0">:<br></span><span class="c2">&lt;script&gt;window.location.href=&quot;https://www.nostarch.com/go-hck-yourself&quot;;&lt;/script&gt;<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 173.33px;"><img alt="f08010alt" src="images/image15.png" style="width: 624.00px; height: 173.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2"><br></span><span class="c8 c4">Figure 8-10</span><span class="c0 c13 c4">: Entering a more malicious script that will redirect the user to a completely different web page</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">Sign Guestbook</span><span class="c0">, and you&rsquo;ll see the alert pop-up we injected before. But as soon as you close the alert, you&rsquo;ll be taken to </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://www.nostarch.com/go-hck-yourself/&amp;sa=D&amp;source=editors&amp;ust=1679432065321686&amp;usg=AOvVaw1l8ZLwtdS7h9C4auq8msNR">https://www.nostarch.com/go-hck-yourself/</a></span><span class="c0">. You can&rsquo;t go back to the DVWA XSS stored page because every time you reload the page, it redirects to the </span><span class="c0 c4">Go H*ck Yourself</span><span class="c0 c7">&nbsp;web page.</span></li></ol><p class="c9"><span class="c0 c7">We&rsquo;ve permanently hijacked the XSS stored page so that every visitor will be redirected to this book&rsquo;s website instead. An attacker could do the same, or worse, to an unprotected web application in your employer&rsquo;s website, your favorite online game or social media app, or even your local government website. To restore the site&rsquo;s original functionality, the site administrator would have to access the database and delete the stored XSS code entirely.</span></p><p class="c9"><span class="c0">To reset the database in DVWA to delete the malicious code we entered, click </span><span class="c3">Setup </span><span class="c0">in the DVWA menu on the left, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-11&amp;sa=D&amp;source=editors&amp;ust=1679432065322796&amp;usg=AOvVaw2PEe9Zmug8_HY-BC_R-dQE">Figure 8-11</a></span><span class="c0">. Then click </span><span class="c3">Create / Reset Database</span><span class="c0 c7">, and DVWA will reset the database to its original state.</span></p><p class="c19"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08011" src="images/image5.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c23"><span class="c1">Figure 8-11</span><span class="c11 c4">: Clearing your stored XSS hacks</span></p><h3 class="c20" id="h.hue4mrf17f89"><span class="c22 c7">Launching SQL Injection Attacks on Databases</span></h3><p class="c14"><span class="c0">Injecting malicious code </span><span class="c0 c4">into</span><span class="c0">&nbsp;a website was scary, but how do hackers take sensitive data </span><span class="c0 c4">from</span><span class="c0">&nbsp;a website? In this section, you&rsquo;ll learn how web hackers use Structured Query Language (SQL) injection attacks to steal information directly from a website&rsquo;s database. SQL is the language used to access most databases, and a </span><span class="c0 c4">SQL injection</span><span class="c0">&nbsp;</span><span class="c0 c4">(SQLi)</span><span class="c0 c7">&nbsp;involves inserting malicious SQL code into a web application to trick the application&rsquo;s database into revealing private information.</span></p><p class="c9"><span class="c0">Databases contain </span><span class="c0 c4">tables</span><span class="c0">, which look like spreadsheets of columns and rows. The columns are for different </span><span class="c0 c4">fields</span><span class="c0">&nbsp;or pieces of information, like first name, last name, username, password, email address, and so on. The rows are for individual </span><span class="c0 c4">records</span><span class="c0 c7">. For example, each user in a table of users would occupy a separate row.</span></p><p class="c9"><span class="c0">When we access a database, we use a SQL </span><span class="c0 c4">query</span><span class="c0 c7">, like this one:</span></p><p class="c21"><span class="c10 c7">SELECT password FROM users WHERE username=&#39;Bryson&#39;</span></p><p class="c9"><span class="c0">This query requests the </span><span class="c2">password</span><span class="c0">&nbsp;field from the </span><span class="c2">users</span><span class="c0">&nbsp;table from the row or rows where the </span><span class="c2">username</span><span class="c0">&nbsp;field is </span><span class="c2">Bryson</span><span class="c0">. We can modify the query slightly to ask for </span><span class="c0 c4">all</span><span class="c0 c7">&nbsp;users&rsquo; passwords:</span></p><p class="c21"><span class="c7 c10">SELECT password FROM users WHERE username=&#39;Bryson&#39; OR 1=&#39;1&#39;</span></p><p class="c9"><span class="c0">By adding an </span><span class="c2">OR</span><span class="c0">&nbsp;condition to the query, we&rsquo;ve asked the database to select all the passwords from the </span><span class="c2">users</span><span class="c0">&nbsp;table. At every row, SQL will ask whether </span><span class="c2">username</span><span class="c0">&nbsp;equals </span><span class="c2">&#39;Bryson&#39;</span><span class="c0">&nbsp;or whether </span><span class="c2">1</span><span class="c0">&nbsp;equals </span><span class="c2">&#39;1&#39;</span><span class="c0">&nbsp;for that row. If either of these conditions is true, SQL will return the password for that row. Because one of the conditions is </span><span class="c0 c4">always</span><span class="c0">&nbsp;true (1 is always equal to 1), the database will return </span><span class="c0 c4">every</span><span class="c0">&nbsp;password in the </span><span class="c2">users</span><span class="c0 c7">&nbsp;table.</span></p><p class="c9"><span class="c0 c7">Let&rsquo;s inject some SQL queries into DVWA to steal information from the website&rsquo;s database.</span></p><ol class="c16 lst-kix_fuu4lpch6vbo-0 start" start="1"><li class="c5 li-bullet-0"><span class="c0">In your Windows 10 VM&rsquo;s Edge browser, make sure DVWA Script Security is set to low (as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-5&amp;sa=D&amp;source=editors&amp;ust=1679432065327713&amp;usg=AOvVaw1apA5ke32UKyrxqRGu8k_N">Figure 8-5</a></span><span class="c0 c7">&nbsp;on page 95).</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">SQL Injection</span><span class="c0">&nbsp;in the DVWA menu on the left. You&rsquo;ll see a user lookup page like the one in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-12&amp;sa=D&amp;source=editors&amp;ust=1679432065328745&amp;usg=AOvVaw34JLRJTur5Hj50xJ-soHYF">Figure 8-12</a></span><span class="c0 c7">.<br>Normally, entering a User ID (such as 1) into the text box and clicking Submit reveals that particular user&rsquo;s information. However, we&rsquo;ll hack the form to show all the users.</span></li><li class="c5 li-bullet-0"><span class="c0">Reload the SQL Injection page if you&rsquo;ve tried looking up a user. Then enter </span><span class="c2">&#39; OR 1=&#39;1</span><span class="c0">&nbsp;into the User ID: text box, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-12&amp;sa=D&amp;source=editors&amp;ust=1679432065329490&amp;usg=AOvVaw0Ds72gfMj1tzfakrZ97S_M">Figure 8-12</a></span><span class="c0">.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08012" src="images/image7.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0"><br></span><span class="c8 c4">Figure 8-12</span><span class="c0 c4">: Attacking the database by injecting SQL code into a vulnerable database search form<br></span><span class="c28">NOTE<br></span><span class="c0 c4">Notice that the final quote (after </span><span class="c2 c4">1=&#39;1</span><span class="c0 c4">) doesn&rsquo;t need to be entered. This is because the form inserts the user ID into SQL code that already has single quotes around it, like </span><span class="c2 c4">user_id=&#39;2&#39;</span><span class="c0 c4">, so </span><span class="c2 c4">&#39; OR 1=&#39;1</span><span class="c0 c4">&nbsp;enters the database as </span><span class="c2 c4">user_id=&#39;&#39; OR 1=&#39;1&#39;</span><span class="c0 c13 c4">, yielding a statement that&rsquo;s always true.</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">Submit</span><span class="c0">, and you should see a listing of all users&rsquo; first names and last names (surnames), as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-13&amp;sa=D&amp;source=editors&amp;ust=1679432065331061&amp;usg=AOvVaw3Ls5nIGizIzEf7xAIvj7bJ">Figure 8-13</a></span><span class="c0 c7">.</span></li><li class="c5 li-bullet-0"><span class="c0">Now let&rsquo;s extract all the DVWA usernames and passwords. Reload the SQL Injection page and enter the following SQL code into the search box under User ID:<br></span><span class="c2">&#39; union select user, password from users#<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08013" src="images/image13.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2"><br></span><span class="c8 c4">Figure 8-13</span><span class="c0 c4">: We&rsquo;ve revealed all five users&rsquo; first and last names!<br></span><span class="c0">The </span><span class="c2">union</span><span class="c0">&nbsp;command in SQL joins two query statements to access multiple tables at the same time. In this case, we&rsquo;re combining the user ID lookup for first and last names with a query that will return usernames and passwords from the </span><span class="c2">users</span><span class="c0 c7">&nbsp;table.</span></li><li class="c5 li-bullet-0"><span class="c0">Click </span><span class="c3">Submit</span><span class="c0">, and you&rsquo;ll see all five users&rsquo; usernames and passwords in place of their first and last names, as shown in </span><span class="c8 c4"><a class="c6" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/go-h-ck-yourself/9781098129873/c08.xhtml%23figure8-14&amp;sa=D&amp;source=editors&amp;ust=1679432065332738&amp;usg=AOvVaw1faj66myUzfGgsjxySlFRu">Figure 8-14</a></span><span class="c0 c7">. All the passwords are in hashed form, but as you learned in Chapter 7, tools like Hashes.com or John the Ripper make short work of most password hashes.</span></li></ol><p class="c19"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 340.00px;"><img alt="f08014" src="images/image14.png" style="width: 624.00px; height: 340.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c23"><span class="c1">Figure 8-14</span><span class="c4 c11">: We&rsquo;ve stolen all the usernames and password hashes from DVWA using a SQL injection attack!</span></p><p class="c9"><span class="c0 c7">As you can see, a hacker armed with a few short lines of JavaScript or SQL can damage a web application, redirect users to a malicious site, steal data, or worse. Fortunately, ethical hackers can help website owners defend against these attacks, tremendously improving the security of everyone&rsquo;s online data.</span></p><h2 class="c20" id="h.klvog6aanjm6"><span class="c7 c17">Securing Web Applications from XSS, SQLi, and More</span></h2><p class="c14"><span class="c0">DVWA shows both how to hack </span><span class="c0 c4">and</span><span class="c0 c7">&nbsp;how to secure web applications. In the bottom-right corner of every vulnerable page, there&rsquo;s a View Source button that shows the page&rsquo;s code. We&rsquo;ll compare the source code of the low-security page with that of pages with higher security levels to learn how to protect against injection attacks.</span></p><p class="c9"><span class="c0">Still on the SQL Injection page with DVWA&rsquo;s Script Security set to low, click </span><span class="c3">View Source</span><span class="c0 c7">&nbsp;to see the source code for the user lookup application, including these two lines of code:</span></p><p class="c15"><span class="c10 c7">$id = $_GET[&#39;id&#39;]; </span></p><p class="c21"><span class="c10 c7">$getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39;&quot;;</span></p><p class="c9"><span class="c0">This web application is written in PHP, a popular web programming language. The first line of code gets the user&rsquo;s input from a form field named </span><span class="c2">&#39;id&#39;</span><span class="c0">&nbsp;and stores it in a variable called </span><span class="c2">$id</span><span class="c0 c7">. Then, it creates a SQL query using the user&rsquo;s input. The user&rsquo;s unmodified input becomes part of the code&mdash;this is a dangerous programming mistake, and it&rsquo;s what allowed us to hack into the database.</span></p><p class="c9"><span class="c0">Click </span><span class="c3">DVWA Security</span><span class="c0">&nbsp;on the left, change the Script Security level to </span><span class="c3">medium</span><span class="c0">, and click </span><span class="c3">Submit</span><span class="c0">. Click </span><span class="c3">SQL Injection</span><span class="c0">&nbsp;to return to the user lookup application and then click </span><span class="c3">View Source</span><span class="c0 c7">&nbsp;again. (If you have trouble switching security levels, close the Edge browser, reopen it, and log back in to DVWA.) This time, you&rsquo;ll see a new line of code inserted between the two just listed:</span></p><p class="c21"><span class="c10 c7">$id = mysql_real_escape_string($id);</span></p><p class="c9"><span class="c0">This line reformats the user&rsquo;s input to add </span><span class="c0 c4">escape characters</span><span class="c0">&nbsp;(like the backslash </span><span class="c2">\</span><span class="c0">) before any special characters the user typed, such as the single quote </span><span class="c2">&#39;</span><span class="c0">&nbsp;we used in the </span><span class="c2">&#39; OR 1=&#39;1</span><span class="c0">&nbsp;hack. Adding a backslash before a single quote tells the database to treat the single quote like it&rsquo;s a part of the text, not part of a command. The </span><span class="c2">mysql_real_escape_string()</span><span class="c0">&nbsp;command makes the form safer by changing the single quote and other potentially malicious characters into their harmless escape sequence forms (</span><span class="c2">\&#39;</span><span class="c0 c7">) so that the database doesn&rsquo;t treat them like code, but a motivated attacker could still get around this.</span></p><p class="c9"><span class="c0">Go back to the DVWA Security page and change the Script Security level to </span><span class="c3">high</span><span class="c0">. Then return to the SQL Injection page and click </span><span class="c3">View Source</span><span class="c0 c7">&nbsp;one last time. Look for this code:</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp;$id = $_GET[&#39;id&#39;];</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp; $id = stripslashes($id);</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp; $id = mysql_real_escape_string($id);</span></p><p class="c15"><span class="c10 c7">&nbsp; &nbsp; if (is_numeric($id)){ &nbsp;</span></p><p class="c21"><span class="c10 c7">--snip--</span></p><p class="c9"><span class="c0">The high-security code uses the </span><span class="c2">stripslashes()</span><span class="c0">&nbsp;command to remove backslashes from the user&rsquo;s text and </span><span class="c2">is_numeric()</span><span class="c0">&nbsp;to make sure you entered a number. Using </span><span class="c2">is_numeric()</span><span class="c0">&nbsp;is an example of form field </span><span class="c0 c4">validation</span><span class="c0">: the command </span><span class="c2">is_numeric()</span><span class="c0 c7">&nbsp;checks that the user&rsquo;s submission is in an acceptable, expected format&mdash;in this case a numeric ID&mdash;and proceeds only if it is.</span></p><p class="c9"><span class="c0">View the source of some of the other pages at low, medium, and high security to discover other layers of commands that web developers use to protect their apps. For example, the secure version of the XSS-reflected page includes </span><span class="c2">htmlspecialchars()</span><span class="c0">&nbsp;to protect against HTML and JavaScript injection. To prevent user input from breaking the website or database code, the added commands in the higher-security versions of the source code </span><span class="c0 c4">sanitize</span><span class="c0 c7">&nbsp;the input, or remove potentially malicious code symbols (like the single quote, backslash, and angle bracket characters) from it, before that input is used on the site or in the database.</span></p><h2 class="c20" id="h.3u6apyf3cvj6"><span class="c17 c7">The Takeaway</span></h2><p class="c14"><span class="c0 c7">In this chapter, you learned that web servers are online and available to hackers around the globe 24/7. Moreover, a single unprotected web form can expose millions of users&rsquo; data to an attacker. You built an intentionally vulnerable web server, the Metasploitable VM, in your virtual hacking lab, and you used the DVWA web application to train yourself to test websites for two types of code injection: cross-site scripting (XSS) and SQL injection (SQLi).</span></p><p class="c9"><span class="c0 c7">You used reflected and stored malicious JavaScript code to make a web page pop up an alert message and redirect the browser to a different website. You viewed the first and last names of all users in a database-driven web application using SQL, and then you learned how an attacker could steal usernames and password hashes from a web database. With the password-cracking tools we used in Chapter 7, an attacker could steal millions of usernames and passwords with very little skill or effort.</span></p><p class="c9"><span class="c0 c7">With so much at stake, securing web applications from attacks is an important role for ethical hackers. It takes multiple layers of security to adequately protect web applications. You learned about several functions in the popular web-programming language PHP that sanitize user input by removing special code-related characters, protecting the server and database. You also saw an example of form field validation, checking a text field to make sure that a user entered an acceptable value.</span></p><p class="c9"><span class="c0 c7">In the next chapter, you get to add one more set of skills to your ethical hacking toolbelt&mdash;mobile device hacking! You&rsquo;ll learn how to keep yourself and your loved ones safe from the increasing number of mobile attacks.</span></p><p class="c15 c29"><span class="c7 c24"></span></p></body></html>