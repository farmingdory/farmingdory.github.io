<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_kllreoz6kymk-7.start{counter-reset:lst-ctn-kix_kllreoz6kymk-7 0}.lst-kix_kllreoz6kymk-0>li{counter-increment:lst-ctn-kix_kllreoz6kymk-0}.lst-kix_r98bjupa5r1i-2>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-2}ol.lst-kix_kllreoz6kymk-4.start{counter-reset:lst-ctn-kix_kllreoz6kymk-4 0}.lst-kix_r98bjupa5r1i-3>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-3}ol.lst-kix_r98bjupa5r1i-0.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-0 0}ol.lst-kix_fz0qmuntlxok-2.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-2 0}ol.lst-kix_r98bjupa5r1i-3.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-3 0}ol.lst-kix_fz0qmuntlxok-6{list-style-type:none}ol.lst-kix_fz0qmuntlxok-7{list-style-type:none}ol.lst-kix_fz0qmuntlxok-4{list-style-type:none}ol.lst-kix_fz0qmuntlxok-5{list-style-type:none}.lst-kix_kllreoz6kymk-1>li{counter-increment:lst-ctn-kix_kllreoz6kymk-1}ol.lst-kix_fz0qmuntlxok-8{list-style-type:none}ol.lst-kix_fz0qmuntlxok-5.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-5 0}ol.lst-kix_r98bjupa5r1i-6.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-6 0}.lst-kix_r98bjupa5r1i-1>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-1}ol.lst-kix_fz0qmuntlxok-2{list-style-type:none}ol.lst-kix_fz0qmuntlxok-3{list-style-type:none}ol.lst-kix_fz0qmuntlxok-0{list-style-type:none}ol.lst-kix_fz0qmuntlxok-1{list-style-type:none}.lst-kix_r98bjupa5r1i-4>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-4}.lst-kix_fz0qmuntlxok-7>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-7}.lst-kix_r98bjupa5r1i-5>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-5}.lst-kix_r98bjupa5r1i-8>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-8,lower-roman) ". "}ol.lst-kix_kllreoz6kymk-2.start{counter-reset:lst-ctn-kix_kllreoz6kymk-2 0}ol.lst-kix_fz0qmuntlxok-1.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-1 0}.lst-kix_r98bjupa5r1i-6>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-6,decimal) ". "}ol.lst-kix_r98bjupa5r1i-5.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-5 0}.lst-kix_r98bjupa5r1i-7>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-7,lower-latin) ". "}.lst-kix_r98bjupa5r1i-1>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-1,lower-latin) ". "}.lst-kix_r98bjupa5r1i-0>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-0,decimal) ". "}.lst-kix_r98bjupa5r1i-2>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-2,lower-roman) ". "}.lst-kix_kllreoz6kymk-3>li{counter-increment:lst-ctn-kix_kllreoz6kymk-3}.lst-kix_r98bjupa5r1i-5>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-5,lower-roman) ". "}.lst-kix_r98bjupa5r1i-4>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-4,lower-latin) ". "}ol.lst-kix_fz0qmuntlxok-7.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-7 0}.lst-kix_r98bjupa5r1i-3>li:before{content:"" counter(lst-ctn-kix_r98bjupa5r1i-3,decimal) ". "}ol.lst-kix_kllreoz6kymk-1.start{counter-reset:lst-ctn-kix_kllreoz6kymk-1 0}.lst-kix_fz0qmuntlxok-8>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-8}ol.lst-kix_r98bjupa5r1i-4.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-4 0}.lst-kix_kllreoz6kymk-0>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-0,decimal) ". "}.lst-kix_kllreoz6kymk-1>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-1,lower-latin) ". "}.lst-kix_fz0qmuntlxok-2>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-2}.lst-kix_fz0qmuntlxok-5>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-5}ol.lst-kix_fz0qmuntlxok-0.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-0 0}.lst-kix_kllreoz6kymk-6>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-6,decimal) ". "}.lst-kix_kllreoz6kymk-4>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-4,lower-latin) ". "}.lst-kix_kllreoz6kymk-5>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-5,lower-roman) ". "}.lst-kix_kllreoz6kymk-2>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-2,lower-roman) ". "}.lst-kix_kllreoz6kymk-3>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-3,decimal) ". "}ol.lst-kix_kllreoz6kymk-8.start{counter-reset:lst-ctn-kix_kllreoz6kymk-8 0}.lst-kix_r98bjupa5r1i-8>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-8}ol.lst-kix_fz0qmuntlxok-6.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-6 0}ol.lst-kix_kllreoz6kymk-0.start{counter-reset:lst-ctn-kix_kllreoz6kymk-0 0}.lst-kix_kllreoz6kymk-7>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-7,lower-latin) ". "}.lst-kix_kllreoz6kymk-8>li:before{content:"" counter(lst-ctn-kix_kllreoz6kymk-8,lower-roman) ". "}.lst-kix_fz0qmuntlxok-3>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-3}.lst-kix_kllreoz6kymk-6>li{counter-increment:lst-ctn-kix_kllreoz6kymk-6}.lst-kix_kllreoz6kymk-7>li{counter-increment:lst-ctn-kix_kllreoz6kymk-7}.lst-kix_fz0qmuntlxok-0>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-0,decimal) ". "}.lst-kix_kllreoz6kymk-4>li{counter-increment:lst-ctn-kix_kllreoz6kymk-4}ol.lst-kix_kllreoz6kymk-6.start{counter-reset:lst-ctn-kix_kllreoz6kymk-6 0}.lst-kix_r98bjupa5r1i-7>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-7}ol.lst-kix_r98bjupa5r1i-7{list-style-type:none}ol.lst-kix_r98bjupa5r1i-8{list-style-type:none}ol.lst-kix_r98bjupa5r1i-5{list-style-type:none}ol.lst-kix_r98bjupa5r1i-2.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-2 0}ol.lst-kix_r98bjupa5r1i-6{list-style-type:none}.lst-kix_fz0qmuntlxok-4>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-4}.lst-kix_fz0qmuntlxok-1>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-1}ol.lst-kix_kllreoz6kymk-3.start{counter-reset:lst-ctn-kix_kllreoz6kymk-3 0}ol.lst-kix_r98bjupa5r1i-3{list-style-type:none}ol.lst-kix_fz0qmuntlxok-8.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-8 0}ol.lst-kix_r98bjupa5r1i-4{list-style-type:none}ol.lst-kix_r98bjupa5r1i-1{list-style-type:none}ol.lst-kix_kllreoz6kymk-5.start{counter-reset:lst-ctn-kix_kllreoz6kymk-5 0}ol.lst-kix_r98bjupa5r1i-2{list-style-type:none}ol.lst-kix_fz0qmuntlxok-4.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-4 0}ol.lst-kix_r98bjupa5r1i-0{list-style-type:none}.lst-kix_kllreoz6kymk-2>li{counter-increment:lst-ctn-kix_kllreoz6kymk-2}ol.lst-kix_r98bjupa5r1i-1.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-1 0}.lst-kix_fz0qmuntlxok-0>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-0}.lst-kix_fz0qmuntlxok-4>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-4,lower-latin) ". "}.lst-kix_fz0qmuntlxok-6>li{counter-increment:lst-ctn-kix_fz0qmuntlxok-6}.lst-kix_r98bjupa5r1i-6>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-6}.lst-kix_fz0qmuntlxok-3>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-3,decimal) ". "}.lst-kix_fz0qmuntlxok-2>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-2,lower-roman) ". "}ol.lst-kix_r98bjupa5r1i-8.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-8 0}.lst-kix_fz0qmuntlxok-1>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-1,lower-latin) ". "}.lst-kix_r98bjupa5r1i-0>li{counter-increment:lst-ctn-kix_r98bjupa5r1i-0}ol.lst-kix_kllreoz6kymk-8{list-style-type:none}ol.lst-kix_kllreoz6kymk-6{list-style-type:none}ol.lst-kix_kllreoz6kymk-7{list-style-type:none}ol.lst-kix_kllreoz6kymk-0{list-style-type:none}ol.lst-kix_kllreoz6kymk-1{list-style-type:none}ol.lst-kix_kllreoz6kymk-4{list-style-type:none}ol.lst-kix_kllreoz6kymk-5{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_kllreoz6kymk-2{list-style-type:none}ol.lst-kix_kllreoz6kymk-3{list-style-type:none}.lst-kix_fz0qmuntlxok-5>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-5,lower-roman) ". "}ol.lst-kix_fz0qmuntlxok-3.start{counter-reset:lst-ctn-kix_fz0qmuntlxok-3 0}.lst-kix_fz0qmuntlxok-6>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-6,decimal) ". "}ol.lst-kix_r98bjupa5r1i-7.start{counter-reset:lst-ctn-kix_r98bjupa5r1i-7 0}.lst-kix_kllreoz6kymk-5>li{counter-increment:lst-ctn-kix_kllreoz6kymk-5}.lst-kix_kllreoz6kymk-8>li{counter-increment:lst-ctn-kix_kllreoz6kymk-8}.lst-kix_fz0qmuntlxok-7>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-7,lower-latin) ". "}.lst-kix_fz0qmuntlxok-8>li:before{content:"" counter(lst-ctn-kix_fz0qmuntlxok-8,lower-roman) ". "}ol{margin:0;padding:0}table td,table th{padding:0}.c11{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c1{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c46{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c21{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c49{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c35{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.0;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c25{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-top-style:solid;margin-left:54pt;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c52{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:101.2pt;border-top-color:#000000;border-bottom-style:solid}.c61{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:197.2pt;border-top-color:#000000;border-bottom-style:solid}.c20{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:101.2pt;border-top-color:#000000;border-bottom-style:solid}.c44{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:216pt;border-top-color:#000000;border-bottom-style:solid}.c58{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:209.2pt;border-top-color:#000000;border-bottom-style:solid}.c45{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:197.2pt;border-top-color:#000000;border-bottom-style:solid}.c54{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:228.8pt;border-top-color:#000000;border-bottom-style:solid}.c40{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:228.8pt;border-top-color:#000000;border-bottom-style:solid}.c36{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:209.2pt;border-top-color:#000000;border-bottom-style:solid}.c24{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:171pt;border-top-color:#000000;border-bottom-style:solid}.c37{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:171pt;border-top-color:#000000;border-bottom-style:solid}.c9{border-right-style:solid;padding:11pt 11pt 11pt 11pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:216pt;border-top-color:#000000;border-bottom-style:solid}.c14{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c18{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c15{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman";font-style:italic}.c48{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman"}.c0{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14.5pt;font-family:"Times New Roman";font-style:normal}.c7{padding-top:24pt;padding-bottom:24pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{padding-top:24pt;padding-bottom:42pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c13{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c33{padding-top:18pt;padding-bottom:18pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c28{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:700}.c56{background-color:#000000;color:#ffffff;font-weight:700;font-size:10pt;font-family:"Arial"}.c10{background-color:#ffffff;color:#3d3b49;font-weight:400;font-size:12pt;font-family:"Arial"}.c8{background-color:#eef2f6;color:#3d3b49;font-weight:400;font-size:12pt;font-family:"Courier New"}.c17{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c27{background-color:#000000;color:#ffffff;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c34{background-color:#eef2f6;color:#188038;font-weight:400;font-size:9pt;font-family:"Courier New"}.c2{background-color:#ffffff;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c3{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c51{color:#3d3b49;font-weight:700;font-size:54pt;font-family:"Times New Roman"}.c50{color:#3d3b49;font-weight:400;font-size:9pt;font-family:"Times New Roman"}.c38{font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:400}.c42{color:#3d3b49;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c30{border-spacing:0;border-collapse:collapse;margin-right:auto}.c55{color:#3d3b49;font-weight:700;font-size:40.5pt;font-family:"Times New Roman"}.c59{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c6{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c32{font-size:12pt;color:#3d3b49;font-weight:700}.c5{text-decoration:none;vertical-align:baseline;font-style:normal}.c19{padding:0;margin:0}.c47{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c26{text-decoration:none;vertical-align:baseline}.c16{color:inherit;text-decoration:inherit}.c12{text-indent:12pt}.c29{height:42pt}.c31{height:58.5pt}.c23{font-style:italic}.c43{height:63pt}.c60{height:147pt}.c41{height:84pt}.c53{height:105pt}.c22{background-color:#ffffff}.c57{height:126pt}.c39{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c22 c47 doc-content"><h1 class="c46" id="h.r7yy3hpau30b"><span class="c5 c22 c51">6</span></h1><h1 class="c46" id="h.r7yy3hpau30b-1"><span class="c55 c5 c22">DISCOVERY</span></h1><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 610.67px; height: 800.00px;"><img alt="" src="images/image1.png" style="width: 610.67px; height: 800.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c11"><span class="c3 c5">Before you can attack a target&rsquo;s APIs, you must locate those APIs and validate whether they are operational. In the process, you&rsquo;ll also want to find credential information (such as keys, secrets, usernames, and passwords), version information, API documentation, and information about the API&rsquo;s business purpose. The more information you gather about a target, the better your odds of discovering and exploiting API-related vulnerabilities. This chapter describes passive and active reconnaissance processes and the tools to get the job done.</span></p><p class="c11 c12"><span class="c3 c5">When it comes to recognizing an API in the first place, it helps to consider its purpose. APIs are meant to be used either internally, by partners and customers, or publicly. If an API is intended for public or partner use, it&rsquo;s likely to have developer-friendly documentation that describes the API endpoints and instructions for using it. Use this documentation to recognize the API.</span></p><p class="c11 c12"><span class="c3">If the API is for select customers or internal use, you&rsquo;ll have to rely on other clues: naming conventions, HTTP response header information such as </span><span class="c17">Content-Type: application/json</span><span class="c3 c5">, HTTP responses containing JSON/XML, and information about the JavaScript source files that power the application.</span></p><h2 class="c1" id="h.yymh4q31b72s"><span class="c42 c5">Passive Recon</span></h2><p class="c11"><span class="c3 c23">Passive reconnaissance</span><span class="c3">&nbsp;is the act of obtaining information about a target without directly interacting with the target&rsquo;s devices. When you take this approach, your goal is to find and document your target&rsquo;s attack surface without making the target aware of your investigation. In this case, the </span><span class="c3 c23">attack surface</span><span class="c3 c5">&nbsp;is the total set of systems exposed over a network from which it may be possible to extract data, through which you could gain entry to other systems, or to which you could cause an interruption in the availability of systems.</span></p><p class="c11 c12"><span class="c3">Typically, passive reconnaissance leverages </span><span class="c3 c23">open-source intelligence (OSINT)</span><span class="c3 c5">, which is data collected from publicly available sources. You will be on the hunt for API endpoints, credential information, version information, API documentation, and information about the API&rsquo;s business purpose. Any discovered API endpoints will become your targets later, during active reconnaissance. Credential-related information will help you test as an authenticated user or, better, as an administrator. Version information will help inform you about potential improper assets and other past vulnerabilities. API documentation will tell you exactly how to test the target API. Finally, discovering the API&rsquo;s business purpose can provide you with insight about potential business logic flaws.</span></p><p class="c11 c12"><span class="c3 c5">As you are collecting OSINT, it is entirely possible you will stumble upon a critical data exposure, such as API keys, credentials, JSON Web Tokens (JWT), and other secrets that would lead to an instant win. Other high-risk findings would include leaked PII or sensitive user data such as Social Security numbers, full names, email addresses, and credit card information. These sorts of findings should be documented and reported immediately because they present a valid critical weakness.</span></p><h3 class="c1" id="h.8i8gsjw01tta"><span class="c0">The Passive Recon Process</span></h3><p class="c11"><span class="c3 c5">When you begin passive recon, you&rsquo;ll probably know little to nothing about your target. Once you&rsquo;ve gathered some basic information, you can focus your OSINT efforts on the different facets of an organization and build a profile of the target&rsquo;s attack surface. API usage will vary between industries and business purposes, so you&rsquo;ll need to adapt as you learn new information. Start by casting a wide net using an array of tools to collect data. Then perform more tailored searches based on the collected data to obtain more refined information. Repeat this process until you&rsquo;ve mapped out the target&rsquo;s attack surface.</span></p><h4 class="c1" id="h.pq0cz925f1yp"><span class="c6 c5">Phase One: Cast a Wide Net</span></h4><p class="c11"><span class="c3 c5">Search the internet for very general terms to learn some fundamental information about your target. Search engines such as Google, Shodan, and ProgrammableWeb can help you find general information about the API, such as its usage, design and architecture, documentation, and business purpose, as well as industry-related information and many other potentially significant items.</span></p><p class="c11 c12"><span class="c3 c5">Additionally, you need to investigate your target&rsquo;s attack surface. This can be done with tools such as DNS Dumpster and OWASP Amass. DNS Dumpster performs DNS mapping by showing all the hosts related to the target&rsquo;s domain name and how they connect to each other. (You may want to attack these hosts later!) We covered the use of OWASP Amass in Chapter 4.</span></p><h4 class="c1" id="h.2at8c1pn224k"><span class="c6 c5">Phase Two: Adapt and Focus</span></h4><p class="c11"><span class="c3 c5">Next, take your findings from phase one and adapt your OSINT efforts to the information gathered. This might mean increasing the specificity of your search queries or combining the information gathered from separate tools to gain new insights. In addition to using search engines, you might search GitHub for repositories related to your target and use a tool such as Pastehunter to find exposed sensitive information.</span></p><h4 class="c1" id="h.r4mmrge54eey"><span class="c6 c5">Phase Three: Document the Attack Surface</span></h4><p class="c11"><span class="c3 c5">Taking notes is crucial to performing an effective attack. Document and take screen captures of all interesting findings. Create a task list of the passive reconnaissance findings that could prove useful throughout the rest of the attack. Later, while you&rsquo;re actively attempting to exploit the API&rsquo;s vulnerabilities, return to the task list to see if you&rsquo;ve missed anything.</span></p><p class="c11 c12"><span class="c3 c5">The following sections go deeper into the tools you&rsquo;ll use throughout this process. Once you begin experimenting with these tools, you&rsquo;ll notice some crossover between the information they return. However, I encourage you to use multiple tools to confirm your results. You wouldn&rsquo;t want to fail to find privileged API keys posted on GitHub, for example, especially if a criminal later stumbled upon that low-hanging fruit and breached your client.</span></p><h3 class="c1" id="h.9o7rjojaxxzh"><span class="c0">Google Hacking</span></h3><p class="c11"><span class="c3 c23">Google hacking</span><span class="c3">&nbsp;(also known as </span><span class="c3 c23">Google dorking</span><span class="c3">) involves the clever use of advanced search parameters and can reveal all sorts of public API-related information about your target, including vulnerabilities, API keys, and usernames, that you can leverage during an engagement. In addition, you&rsquo;ll find information about the target organization&rsquo;s industry and how it leverages its APIs. </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23table6-1&amp;sa=D&amp;source=editors&amp;ust=1681144447832272&amp;usg=AOvVaw0_dyfeMs2BYgwxfVyXGiRq">Table 6-1</a></span><span class="c3 c5">&nbsp;lists a selection of useful query parameters (see the &ldquo;Google Hacking&rdquo; Wikipedia page for a complete list).</span></p><p class="c21"><span class="c22 c48">Table 6-1</span><span class="c18">: Google Query Parameters</span></p><a id="t.6111d490eb1546ab910a0a75f56c3e376b514d9a"></a><a id="t.0"></a><table class="c30"><tr class="c29"><td class="c52" colspan="1" rowspan="1"><p class="c4"><span class="c32 c22">Query operator</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c4"><span class="c22 c32">Purpose</span></p></td></tr><tr class="c29"><td class="c20" colspan="1" rowspan="1"><p class="c4"><span class="c17">intitle</span></p></td><td class="c37" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Searches page titles</span></p></td></tr><tr class="c29"><td class="c20" colspan="1" rowspan="1"><p class="c4"><span class="c2">inurl</span></p></td><td class="c37" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Searches for words in the URL</span></p></td></tr><tr class="c29"><td class="c20" colspan="1" rowspan="1"><p class="c4"><span class="c17">filetype</span></p></td><td class="c37" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Searches for desired file types</span></p></td></tr><tr class="c29"><td class="c20" colspan="1" rowspan="1"><p class="c4"><span class="c2">site</span></p></td><td class="c37" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Limits a search to specific sites</span></p></td></tr></table><p class="c11 c12"><span class="c3">Start with a broad search to see what information is available; then add parameters specific to your target to focus the results. For example, a generic search for </span><span class="c17">inurl: /api/</span><span class="c3">&nbsp;will return over 2,150,000 results&mdash;too many to do much of anything with. To narrow the search results, include your target&rsquo;s domain name. A query like </span><span class="c17">intitle:&quot;</span><span class="c38">&lt;targetname&gt;</span><span class="c17">&nbsp;api key&quot;</span><span class="c3 c5">&nbsp;returns fewer and more relevant results.</span></p><p class="c11 c12"><span class="c3">In addition to your own carefully crafted Google search queries, you can use Offensive Security&rsquo;s Google Hacking Database (GHDB, </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://www.exploit-db.com/google-hacking-database&amp;sa=D&amp;source=editors&amp;ust=1681144447838439&amp;usg=AOvVaw2r6hhIscQylMOyQvmpWxpl">https://www.exploit-db.com/google-hacking-database</a></span><span class="c3">). The GHDB is a repository of queries that reveal publicly exposed vulnerable systems and sensitive information. </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23table6-2&amp;sa=D&amp;source=editors&amp;ust=1681144447838897&amp;usg=AOvVaw2c6Vhv6iucAD8KDBrDdUbK">Table 6-2</a></span><span class="c3 c5">&nbsp;lists some useful API queries from the GHDB.</span></p><p class="c21"><span class="c48 c22">Table 6-2</span><span class="c18">: GHDB Queries</span></p><a id="t.b107b4886b18a25237c0163393659628289c17ff"></a><a id="t.1"></a><table class="c30"><tr class="c29"><td class="c9" colspan="1" rowspan="1"><p class="c4"><span class="c32 c22">Google hacking query</span></p></td><td class="c58" colspan="1" rowspan="1"><p class="c4"><span class="c32 c22">Expected results</span></p></td></tr><tr class="c43"><td class="c44" colspan="1" rowspan="1"><p class="c4"><span class="c17">inurl:&quot;/wp-json/wp/v2/users&quot;</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Finds all publicly available WordPress API user directories.</span></p></td></tr><tr class="c31"><td class="c44" colspan="1" rowspan="1"><p class="c4"><span class="c2">intitle:&quot;index.of&quot; intext:&quot;api.txt&quot;</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Finds publicly available API key files.</span></p></td></tr><tr class="c43"><td class="c44" colspan="1" rowspan="1"><p class="c4"><span class="c17">inurl:&quot;/includes/api/&quot; intext:&quot;index of /&quot;</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Finds potentially interesting API directories.</span></p></td></tr><tr class="c53"><td class="c44" colspan="1" rowspan="1"><p class="c4"><span class="c2">ext:php inurl:&quot;api.php?action=&quot;</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Finds all sites with a XenAPI SQL injection vulnerability. (This query was posted in 2016; four years later, there were 141,000 results.)</span></p></td></tr><tr class="c43"><td class="c44" colspan="1" rowspan="1"><p class="c4"><span class="c17">intitle:&quot;index of&quot; api_key OR &quot;api key&quot; OR apiKey -pool</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Lists potentially exposed API keys. (This is one of my favorite queries.)</span></p></td></tr></table><p class="c11 c12"><span class="c3">As you can see in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-1&amp;sa=D&amp;source=editors&amp;ust=1681144447844695&amp;usg=AOvVaw0chINzZkgRgIRUb7LgcgWp">Figure 6-1</a></span><span class="c3 c5">, the final query returns 2,760 search results for websites where API keys are publicly exposed.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 352.00px;"><img alt="Screenshot of Google search results with the keyword &ldquo;apikey&rdquo; highlighted in the endpoints of the returned websites" src="images/image24.png" style="width: 624.00px; height: 352.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-1</span><span class="c18">: The results of a Google hack for APIs, including several web pages with exposed API keys</span></p><h3 class="c1" id="h.626s2szez9rf"><span class="c0">ProgrammableWeb&rsquo;s API Search Directory</span></h3><p class="c11"><span class="c3">ProgrammableWeb (</span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://www.programmableweb.com/&amp;sa=D&amp;source=editors&amp;ust=1681144447845884&amp;usg=AOvVaw0x-_shEbFw1TgxtCp9ZP5K">https://www.programmableweb.com</a></span><span class="c3">) is the go-to source for API-related information. To learn about APIs, you can use its API University. To gather information about your target, use the API directory, a searchable database of over 23,000 APIs (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-2&amp;sa=D&amp;source=editors&amp;ust=1681144447846266&amp;usg=AOvVaw2pMhKeE3vF_ihbeb4q1di3">Figure 6-2</a></span><span class="c3 c5">). Expect to find API endpoints, version information, business logic information, the status of the API, source code, SDKs, articles, API documentation, and a changelog.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 354.67px; height: 465.33px;"><img alt="Screenshot of the ProgrammableWeb API directory displaying information about the Google Maps and Twitter APIs" src="images/image18.png" style="width: 354.67px; height: 465.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-2</span><span class="c18">: The ProgrammableWeb API directory</span></p><h2 class="c35" id="h.lkmy4zew18oh"><span class="c5 c56">NOTE</span></h2><p class="c49"><span class="c3 c26 c23 c22">SDK stands for software development kit. If an SDK is available, you should be able to download the software behind the target&rsquo;s API. For example, ProgrammableWeb has a link to the GitHub repository of the Twitter Ads SDK, where you can review the source code or download the SDK and test it out.</span></p><p class="c11 c12"><span class="c3">Suppose you discover, using a Google query, that your target is using the Medici Bank API. You could search the ProgrammableWeb API directory and find the listing in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-3&amp;sa=D&amp;source=editors&amp;ust=1681144447847539&amp;usg=AOvVaw1Ak-YaaY5pv5cEte_HwoGY">Figure 6-3</a></span><span class="c3 c5">.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 513.33px; height: 490.67px;"><img alt="Screenshot of the Medici Bank API page on ProgrammableWeb, which contains information about the API&rsquo;s structure and the various tasks for which it can be used" src="images/image16.png" style="width: 513.33px; height: 490.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-3</span><span class="c18">: ProgrammableWeb&rsquo;s API directory listing for the Medici Bank API</span></p><p class="c11 c12"><span class="c3 c5">The listing shows that the Medici Bank API interacts with customer data and facilitates financial transactions, making it a high-risk API. When you discover a sensitive target like this one, you&rsquo;ll want to find any information that could help you attack it, including API documentation, the location of its endpoint and portal, its source code, its changelog, and the authentication model it uses.</span></p><p class="c11 c12"><span class="c3">Click through the various tabs in the directory listing and note the information you find. To see the API endpoint location, portal location, and authentication model, shown in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-4&amp;sa=D&amp;source=editors&amp;ust=1681144447848623&amp;usg=AOvVaw3Vn6oN7EUss3puWwWxJbRM">Figure 6-4</a></span><span class="c3 c5">, click a specific version under the Versions tab. In this case, both the portal and endpoint links lead to API documentation as well.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 418.67px; height: 458.67px;"><img alt="Screenshot of the ProgrammableWeb Versions tab for the Medici Bank API, which provides links to relevant resources" src="images/image9.png" style="width: 418.67px; height: 458.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-4</span><span class="c18">: The Medici Bank API Specs section provides the API endpoint location, the API portal location, and the API authentication model.</span></p><p class="c11 c12"><span class="c3 c5">The Changelog tab will inform you of past vulnerabilities, previous API versions, and notable updates to the latest API version, if available. ProgrammableWeb describes the Libraries tab as &ldquo;a platform-specific software tool that, when installed, results in provisioning a specific API.&rdquo; You can use this tab to discover the type of software used to support the API, which could include vulnerable software libraries.</span></p><p class="c11 c12"><span class="c3">Depending on the API, you may discover source code, tutorials (the How To tab), mashups, and news articles, all of which may provide useful OSINT. Other sites with API repositories include </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://rapidapi.com/&amp;sa=D&amp;source=editors&amp;ust=1681144447850104&amp;usg=AOvVaw0r8jZHyjAgW373fli-VnUg">https://rapidapi.com</a></span><span class="c3">&nbsp;and </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://apis.guru/browse-apis&amp;sa=D&amp;source=editors&amp;ust=1681144447850532&amp;usg=AOvVaw1s9z3IIL2ywdKjrBxAVIg0">https://apis.guru/browse-apis</a></span><span class="c3 c5">.</span></p><h3 class="c1" id="h.uio1xydb36e7"><span class="c0">Shodan</span></h3><p class="c11"><span class="c3">Shodan is the go-to search engine for devices accessible from the internet. Shodan regularly scans the entire IPv4 address space for systems with open ports and makes their collected information public at </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://shodan.io/&amp;sa=D&amp;source=editors&amp;ust=1681144447851504&amp;usg=AOvVaw3KhETLNLc4BGwO7kOVyfCF">https://shodan.io</a></span><span class="c3 c5">. You can use Shodan to discover external-facing APIs and get information about your target&rsquo;s open ports, making it useful if you have only an IP address or organization&rsquo;s name to work from.</span></p><p class="c11 c12"><span class="c3">Like with Google dorks, you can search Shodan casually by entering your target&rsquo;s domain name or IP addresses; alternatively, you can use search parameters as you would when writing Google queries. </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23table6-3&amp;sa=D&amp;source=editors&amp;ust=1681144447852124&amp;usg=AOvVaw3r-D40YKa8Af-PFUMip5LD">Table 6-3</a></span><span class="c3 c5">&nbsp;shows some useful Shodan queries.</span></p><p class="c21"><span class="c48 c22">Table 6-3</span><span class="c18">: Shodan Query Parameters</span></p><a id="t.e25e9cff3f71f5bdf1b752d5178e49bd71ef8929"></a><a id="t.2"></a><table class="c30"><tr class="c29"><td class="c61" colspan="1" rowspan="1"><p class="c4"><span class="c32 c22">Shodan queries</span></p></td><td class="c54" colspan="1" rowspan="1"><p class="c4"><span class="c32 c22">Purpose</span></p></td></tr><tr class="c57"><td class="c45" colspan="1" rowspan="1"><p class="c4"><span class="c17">hostname:&quot;targetname.com&quot;</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">Using </span><span class="c17">hostname</span><span class="c3 c22">&nbsp;will perform a basic Shodan search for your target&rsquo;s domain name. This should be combined with the following queries to get results specific to your target.</span></p></td></tr><tr class="c41"><td class="c45" colspan="1" rowspan="1"><p class="c4"><span class="c2">&quot;content-type: application/json&quot;</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">APIs should have their </span><span class="c2">content-type</span><span class="c3 c22">&nbsp;set to JSON or XML. This query will filter results that respond with JSON.</span></p></td></tr><tr class="c43"><td class="c45" colspan="1" rowspan="1"><p class="c4"><span class="c17">&quot;content-type: application/xml&quot;</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">This query will filter results that respond with XML.</span></p></td></tr><tr class="c60"><td class="c45" colspan="1" rowspan="1"><p class="c4"><span class="c2">&quot;200 OK&quot;</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">You can add </span><span class="c2">&quot;200 OK&quot;</span><span class="c3 c22">&nbsp;to your search queries to get results that have had successful requests. However, if an API does not accept the format of Shodan&rsquo;s request, it will likely issue a 300 or 400 response.</span></p></td></tr><tr class="c43"><td class="c45" colspan="1" rowspan="1"><p class="c4"><span class="c17">&quot;wp-json&quot;</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c4"><span class="c3 c22">This will search for web applications using the WordPress API.</span></p></td></tr></table><p class="c11 c12"><span class="c3">You can put together Shodan queries to discover API endpoints, even if the APIs do not have standard naming conventions. If, as shown in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-5&amp;sa=D&amp;source=editors&amp;ust=1681144447858287&amp;usg=AOvVaw3GUmP798nS7r25tWSY4DLR">Figure 6-5</a></span><span class="c3">, we were targeting eWise (</span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://www.ewise.com/&amp;sa=D&amp;source=editors&amp;ust=1681144447858684&amp;usg=AOvVaw15ufFW47bvVrum_KiOcyvU">https://www.ewise.com</a></span><span class="c3 c5">), a money management company, we could use the following query to see if it had API endpoints that had been scanned by Shodan:</span></p><p class="c33"><span class="c8 c5">&quot;ewise.com&quot; &quot;content-type: application/json&quot;</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 500.00px;"><img alt="Screenshot of Shodan&rsquo;s interface displaying an IP address corresponding to the query entered" src="images/image3.png" style="width: 624.00px; height: 500.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-5</span><span class="c18">: Shodan search results</span></p><p class="c11 c12"><span class="c3">In </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-5&amp;sa=D&amp;source=editors&amp;ust=1681144447859648&amp;usg=AOvVaw3xtfsKi9rnOjG8H3fpDDNy">Figure 6-5</a></span><span class="c3">, we see that Shodan has provided us with a potential target endpoint. Investigating this result further reveals SSL certificate information related to eWise&mdash;namely, that the web server is Nginx and that the response includes an </span><span class="c17">application/json</span><span class="c3 c5">&nbsp;header. The server issued a 401 JSON response code commonly used in REST APIs. We were able to discover an API endpoint without any API-related naming conventions.</span></p><p class="c11 c12"><span class="c3 c5">Shodan also has browser extensions that let you conveniently check Shodan scan results as you visit sites with your browser.</span></p><h3 class="c1" id="h.99qinoez47rh"><span class="c0">OWASP Amass</span></h3><p class="c11"><span class="c3 c5">Introduced in Chapter 4, OWASP Amass is a command line tool that can map a target&rsquo;s external network by collecting OSINT from over 55 different sources. You can set it to perform passive or active scans. If you choose the active option, Amass will collect information directly from the target by requesting its certificate information. Otherwise, it collects data from search engines (such as Google, Bing, and HackerOne), SSL certificate sources (such as GoogleCT, Censys, and FacebookCT), search APIs (such as Shodan, AlienVault, Cloudflare, and GitHub), and the web archive Wayback.</span></p><p class="c11 c12"><span class="c3">Visit Chapter 4 for instructions on setting up Amass and adding API keys. The following is a passive scan of </span><span class="c3 c23">twitter.com</span><span class="c3 c5">, with grep used to show only API-related results:</span></p><p class="c13"><span class="c8">$ </span><span class="c28">amass enum -passive -d twitter.com |grep api</span></p><p class="c13"><span class="c8 c5">legacy-api.twitter.com</span></p><p class="c13"><span class="c8 c5">api1-backup.twitter.com</span></p><p class="c13"><span class="c8 c5">api3-backup.twitter.com</span></p><p class="c13"><span class="c8 c5">tdapi.twitter.com</span></p><p class="c13"><span class="c8 c5">failover-urls.api.twitter.com</span></p><p class="c13"><span class="c8 c5">cdn.api.twitter.com</span></p><p class="c13"><span class="c8 c5">pulseone-api.smfc.twitter.com</span></p><p class="c13"><span class="c8 c5">urls.api.twitter.com</span></p><p class="c13"><span class="c8 c5">api2.twitter.com</span></p><p class="c13"><span class="c8 c5">apistatus.twitter.com</span></p><p class="c33"><span class="c8 c5">apiwiki.twtter.com</span></p><p class="c11 c12"><span class="c3">This scan revealed 86 unique API subdomains, including </span><span class="c3 c23">legacy-api.twitter.com</span><span class="c3">. As we know from the OWASP API Security Top 10, an API named </span><span class="c3 c23">legacy</span><span class="c3 c5">&nbsp;could be of particular interest because it seems to indicate an improper asset management vulnerability.</span></p><p class="c11 c12"><span class="c3">Amass has several useful command line options. Use the </span><span class="c17">intel</span><span class="c3 c5">&nbsp;command to collect SSL certificates, search reverse Whois records, and find ASN IDs associated with your target. Start by providing the command with target IP addresses:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass intel -addr </span><span class="c8 c5">&lt;target IP addresses&gt;</span></p><p class="c11 c12"><span class="c3">If this scan is successful, it will provide you with domain names. These domains can then be passed to </span><span class="c17">intel</span><span class="c3">&nbsp;with the </span><span class="c17">whois</span><span class="c3 c5">&nbsp;option to perform a reverse Whois lookup:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass intel -d </span><span class="c8">&lt;target domain&gt; </span><span class="c28 c5">&ndash;whois</span></p><p class="c11 c12"><span class="c3">This could give you a ton of results. Focus on the interesting results that relate to your target organization. Once you have a list of interesting domains, upgrade to the </span><span class="c17">enum</span><span class="c3">&nbsp;subcommand to begin enumerating subdomains. If you specify the </span><span class="c17">-passive</span><span class="c3 c5">&nbsp;option, Amass will refrain from directly interacting with your target:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass enum -passive -d </span><span class="c8 c5">&lt;target domain&gt;</span></p><p class="c11 c12"><span class="c3">The active </span><span class="c17">enum</span><span class="c3 c5">&nbsp;scan will perform much of the same scan as the passive one, but it will add domain name resolution, attempt DNS zone transfers, and grab SSL certificate information:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass enum -active -d </span><span class="c8 c5">&lt;target domain&gt;</span></p><p class="c11 c12"><span class="c3">To up your game, add the </span><span class="c17">-brute</span><span class="c3">&nbsp;option to brute-force subdomains, </span><span class="c17">-w</span><span class="c3">&nbsp;to specify the API_superlist wordlist, and then the </span><span class="c17">-dir</span><span class="c3 c5">&nbsp;option to send the output to the directory of your choice:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass enum -active -brute -w /usr/share/wordlists/API_superlist -d </span><span class="c8">&lt;target domain&gt;</span><span class="c28">&nbsp;-dir </span><span class="c8 c5">&lt;directory name&gt;</span></p><p class="c11 c12"><span class="c3">If you&rsquo;d like to visualize relationships between the data Amass returns, use the </span><span class="c17">viz</span><span class="c3">&nbsp;subcommand, as shown next, to make a cool-looking web page (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-6&amp;sa=D&amp;source=editors&amp;ust=1681144447865326&amp;usg=AOvVaw3mK7e-2TmPzGKIc6TchpHb">Figure 6-6</a></span><span class="c3 c5">). This page allows you to zoom in and check out the various related domains and hopefully some API endpoints.</span></p><p class="c33"><span class="c8">$ </span><span class="c28">amass viz -enum -d3 -dir </span><span class="c8 c5">&lt;directory name&gt;</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 273.33px;"><img alt="Screenshot of a visualization of related domains generated by Amass" src="images/image4.png" style="width: 624.00px; height: 273.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-6</span><span class="c23 c22 c50">: OWASP Amass visualization using </span><span class="c23 c34">-d3</span><span class="c18">&nbsp;to make an HTML export of Amass findings for twitter.com</span></p><p class="c11 c12"><span class="c3">You can use this visualization to see the types of DNS records, dependencies between different hosts, and the relationships between different nodes. In </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-6&amp;sa=D&amp;source=editors&amp;ust=1681144447866666&amp;usg=AOvVaw3HD2TdFQXyVcpHQ55-0bC1">Figure 6-6</a></span><span class="c3">, all the nodes on the left are API subdomains, while the large circle represents </span><span class="c3 c23">twitter.com</span><span class="c3 c5">.</span></p><h3 class="c1" id="h.8v9j03h58dx1"><span class="c0">Exposed Information on GitHub</span></h3><p class="c11"><span class="c3">Regardless of whether your target performs its own development, it&rsquo;s worth checking GitHub (</span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://github.com/&amp;sa=D&amp;source=editors&amp;ust=1681144447867512&amp;usg=AOvVaw3bR4InbluNLAJUmBsR2iK5">https://github.com</a></span><span class="c3 c5">) for sensitive information disclosure. Developers use GitHub to collaborate on software projects. Searching GitHub for OSINT could reveal your target&rsquo;s API capabilities, documentation, and secrets, such as admin-level API keys, passwords, and tokens, which could be useful during an attack.</span></p><p class="c11 c12"><span class="c3 c5">Begin by searching GitHub for your target organization&rsquo;s name paired with potentially sensitive types of information, such as &ldquo;api-key,&rdquo; &ldquo;password,&rdquo; or &ldquo;token.&rdquo; Then investigate the various GitHub repository tabs to discover API endpoints and potential weaknesses. Analyze the source code in the Code tab, find software bugs in the Issues tab, and review proposed changes in the Pull requests tab.</span></p><h4 class="c1" id="h.4lzp9u1eis5c"><span class="c6 c5">Code</span></h4><p class="c11"><span class="c3">Code contains the current source code, README files, and other files (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-7&amp;sa=D&amp;source=editors&amp;ust=1681144447868490&amp;usg=AOvVaw2krFO3gH3zi7gu6Ubx5TZo">Figure 6-7</a></span><span class="c3 c5">). This tab will provide you with the name of the last developer who committed to the given file, when that commit happened, contributors, and the actual source code.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 354.67px;"><img alt="Screenshot of source code in the GitHub code tab" src="images/image10.png" style="width: 624.00px; height: 354.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-7</span><span class="c18">: An example of the GitHub Code tab where you can review the source code of different files</span></p><p class="c11 c12"><span class="c3">Using the Code tab, you can review the code in its current form or use CTRL-F to search for terms that may interest you (such as &ldquo;API,&rdquo; &ldquo;key,&rdquo; and &ldquo;secret&rdquo;). Additionally, view historical commits to the code by using the History button found at the top-right corner of </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-7&amp;sa=D&amp;source=editors&amp;ust=1681144447869391&amp;usg=AOvVaw3Js8datYYXlkVAUxZqHl-Y">Figure 6-7</a></span><span class="c3 c5">. If you came across an issue or comment that led you to believe there were once vulnerabilities associated with the code, you can look for historical commits to see if the vulnerabilities are still viewable.</span></p><p class="c11 c12"><span class="c3">When looking at a commit, use the Split button to see a side-by-side comparison of the file versions to find the exact place where a change to the code was made (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-8&amp;sa=D&amp;source=editors&amp;ust=1681144447869924&amp;usg=AOvVaw0f9AkaRiqD4f-2fvG22Y2u">Figure 6-8</a></span><span class="c3 c5">).</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 305.33px;"><img alt="Screenshot of a split window in the GitHub interface that highlights changes between two versions of a program" src="images/image15.png" style="width: 624.00px; height: 305.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-8</span><span class="c18">: The Split button allows you to separate the previous code (left) from the updated code (right).</span></p><p class="c11 c12"><span class="c3 c5">Here, you can see a commit to a financial application that removed the SonarQube private API key from the code, revealing both the key and the API endpoint it was used for.</span></p><h4 class="c1" id="h.qcpbujp1tk20"><span class="c6 c5">Issues</span></h4><p class="c11"><span class="c3">The Issues tab is a space where developers can track bugs, tasks, and feature requests. If an issue is open, there is a good chance that the vulnerability is still live within the code (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-9&amp;sa=D&amp;source=editors&amp;ust=1681144447871101&amp;usg=AOvVaw28Iy4hZRq6vSYNEoKWVRmd">Figure 6-9</a></span><span class="c3 c5">).</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 294.67px;"><img alt="Screenshot of a GitHub issues tab that reads &ldquo;API key is public.&rdquo; Contains a comment recommending that an API key be removed." src="images/image21.png" style="width: 624.00px; height: 294.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-9</span><span class="c18">: An open GitHub issue that provides the exact location of an exposed API key in the code of an application</span></p><p class="c11 c12"><span class="c3 c5">If the issue is closed, note the date of the issue and then search the commit history for any changes around that time.</span></p><h4 class="c1" id="h.iu39owdxqfwe"><span class="c6 c5">Pull Requests</span></h4><p class="c11"><span class="c3">The Pull requests tab is a place that allows developers to collaborate on changes to the code. If you review these proposed changes, you might sometimes get lucky and find an API exposure that is in the process of being resolved. For example, in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-10&amp;sa=D&amp;source=editors&amp;ust=1681144447872306&amp;usg=AOvVaw1X6C9fqi6LBG28WlGBMFas">Figure 6-10</a></span><span class="c3 c5">, the developer has performed a pull request to remove an exposed API key from the source code.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 341.33px;"><img alt="Screenshot of a GitHub pull request titled &ldquo;Removed Exposed API_KEY&rdquo;" src="images/image11.png" style="width: 624.00px; height: 341.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-10</span><span class="c18">: A developer&rsquo;s comments in the pull request conversation can reveal private API keys.</span></p><p class="c11 c12"><span class="c3">As this change has not yet been merged with the code, we can easily see that the API key is still exposed under the Files Changed tab (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-11&amp;sa=D&amp;source=editors&amp;ust=1681144447873187&amp;usg=AOvVaw0QW6MoX962eCC9GBtmlmqW">Figure 6-11</a></span><span class="c3 c5">).</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.33px; height: 464.00px;"><img alt="Screenshot of the GitHub Files changed tab showing code containing the exposed API key" src="images/image6.png" style="width: 601.33px; height: 464.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-11</span><span class="c18">: The Files Changed tab demonstrates proposed change to the code.</span></p><p class="c11 c12"><span class="c3 c5">The Files Changed tab reveals the section of code the developer is attempting to change. As you can see, the API key is on line 25; the following line is the proposed change to have the key removed.</span></p><p class="c11 c12"><span class="c3 c5">If you don&rsquo;t find weaknesses in a GitHub repository, use it instead to develop your profile of your target. Take note of programming languages in use, API endpoint information, and usage documentation, all of which will prove useful moving forward.</span></p><h2 class="c1" id="h.t9n3e0f2vb43"><span class="c5 c42">Active Recon</span></h2><p class="c11"><span class="c3 c5">One shortcoming of performing passive reconnaissance is that you&rsquo;re collecting information from secondhand sources. As an API hacker, the best way to validate this information is to obtain information directly from a target by port or vulnerability scanning, pinging, sending HTTP requests, making API calls, and other forms of interaction with a target&rsquo;s environment.</span></p><p class="c11 c12"><span class="c3 c5">This section will focus on discovering an organization&rsquo;s APIs using detection scanning, hands-on analysis, and targeted scanning. The lab at the end of the chapter will show these techniques in action.</span></p><h3 class="c1" id="h.gf678fvtgfy"><span class="c0">The Active Recon Process</span></h3><p class="c11"><span class="c3 c5">The active recon process discussed in this section should lead to an efficient yet thorough investigation of the target and reveal any weaknesses you can use to access the system. Each phase narrows your focus using information from the previous phase: phase one, detection scanning, uses automated scans to find services running HTTP or HTTPS; phase two, hands-on analysis, looks at those services from the end user and hacker perspectives to find points of interest; phase three uses findings from phase two to increase the focus of scans to thoroughly explore the discovered ports and services. This process is time-efficient because it keeps you engaging with the target while automated scans are running in the background. Whenever you&rsquo;ve hit a dead end in your analysis, return to your automated scans to check for new findings.</span></p><p class="c11 c12"><span class="c3 c5">The process is not linear: after each phase of increasingly targeted scanning, you&rsquo;ll analyze the results and then use your findings for further scanning. At any point, you might find a vulnerability and attempt to exploit it. If you successfully exploit the vulnerability, you can move on to post-exploitation. If you don&rsquo;t, you return to your scans and analysis.</span></p><h4 class="c1" id="h.p82hu8xm4v4"><span class="c6 c5">Phase Zero: Opportunistic Exploitation</span></h4><p class="c11"><span class="c3 c5">If you discover a vulnerability at any point in the active recon process, you should take the opportunity to attempt exploitation. You might discover the vulnerability in the first few seconds of scanning, after stumbling upon a comment left in a partially developed web page, or after months of research. As soon as you do, dive into exploitation and then return to the phased process as needed. With experience, you&rsquo;ll learn when to avoid getting lost in a potential rabbit hole and when to go all in on an exploit.</span></p><h4 class="c1" id="h.cxxznzz52uf8"><span class="c6 c5">Phase One: Detection Scanning</span></h4><p class="c11"><span class="c3 c5">The goal of detection scanning is to reveal potential starting points for your investigation. Begin with general scans meant to detect hosts, open ports, services running, and operating systems currently in use, as described in the &ldquo;Baseline Scanning with Nmap&rdquo; section of this chapter. APIs use HTTP or HTTPS, so as soon as your scan detects these services, let the scan continue to run and move into phase two.</span></p><h4 class="c1" id="h.yqtwnhusdgvz"><span class="c6 c5">Phase Two: Hands-on Analysis</span></h4><p class="c11"><span class="c3 c5">Hands-on analysis is the act of exploring the web application using a browser and API client. Aim to learn about all the potential levers you can interact with and test them out. Practically speaking, you&rsquo;ll examine the web page, intercept requests, look for API links and documentation, and develop an understanding of the business logic involved.</span></p><p class="c11 c12"><span class="c3">You should usually consider the application from three perspectives: guests, authenticated users, and site administrators. </span><span class="c3 c23">Guests</span><span class="c3">&nbsp;are anonymous users likely visiting a site for the first time. If the site hosts public information and does not need to authenticate users, it may only have guest users. </span><span class="c3 c23">Authenticated users</span><span class="c3">&nbsp;have gone through some registration process and have been granted a certain level of access. </span><span class="c3 c23">Administrators</span><span class="c3 c5">&nbsp;have the privileges to manage and maintain the API.</span></p><p class="c11 c12"><span class="c3 c5">Your first step is to visit the website in a browser, explore the site, and consider it from these perspectives. Here are some considerations for each user group:</span></p><ol class="c19 lst-kix_kllreoz6kymk-0 start" start="1"><li class="c25 c22 li-bullet-0"><span class="c6">Guest</span><span class="c3 c5">&nbsp;How would a new user use this site? Can new users interact with the API? Is API documentation public? What actions can this group perform?</span></li><li class="c25 c22 li-bullet-0"><span class="c6">Authenticated User</span><span class="c3 c5">&nbsp;What can you do when authenticated that you couldn&rsquo;t do as a guest? Can you upload files? Can you explore new sections of the web application? Can you use the API? How does the web application recognize that a user is authenticated?</span></li><li class="c25 c22 li-bullet-0"><span class="c6">Administrator</span><span class="c3 c5">&nbsp;Where would site administrators log in to manage the web app? What is in the page source? What comments have been left around various pages? What programming languages are in use? What sections of the website are under development or experimental?</span></li></ol><p class="c11 c12"><span class="c3 c5">Next, it&rsquo;s time to analyze the app as a hacker by intercepting the HTTP traffic with Burp Suite. When you use the web app&rsquo;s search bar or attempt to authenticate, the app might be using API requests to perform the requested action, and you&rsquo;ll see those requests in Burp Suite.</span></p><p class="c11 c12"><span class="c3 c5">When you run into roadblocks, it&rsquo;s time to review new results from the phase one scans running in the background and kick off phase three: targeted scans.</span></p><h4 class="c1" id="h.f601bneqlqz8"><span class="c6 c5">Phase Three: Targeted Scanning</span></h4><p class="c11"><span class="c3">In the targeted scanning phase, refine your scans and use tools that are specific to your target. Whereas detection scanning casts a wide net, targeted scanning should focus on the specific type of API, its version, the web application type, any service versions discovered, whether the app is on HTTP or HTTPS, any active TCP ports, and other information gleaned from understanding the business logic. For example, if you discover that an API is running over a nonstandard TCP port, you can set your scanners to take a closer look at that port. If you find out that the web application was made with WordPress, check whether the WordPress API is accessible by visiting </span><span class="c3 c23">/wp-json/wp/v2</span><span class="c3 c5">. At this point, you should know the URLs of the web application and can begin brute-forcing uniform resource identifiers to find hidden directories and files (see &ldquo;Brute-Forcing URIs with Gobuster&rdquo; later in this chapter). Once these tools are up and running, review results as they flow in to perform a more targeted hands-on analysis.</span></p><p class="c11 c12"><span class="c3 c5">The following sections describe the tools and techniques you&rsquo;ll use throughout the phases of active reconnaissance, including detection scanning with Nmap, hands-on analysis using DevTools, and targeted scanning with Burp Suite and OWASP ZAP.</span></p><h3 class="c1" id="h.y2z9ydbhm6xs"><span class="c0">Baseline Scanning with Nmap</span></h3><p class="c11"><span class="c3 c5">Nmap is a powerful tool for scanning ports, searching for vulnerabilities, enumerating services, and discovering live hosts. It&rsquo;s my preferred tool for phase one detection scanning, but I also return to it for targeted scanning. You&rsquo;ll find books and websites dedicated to the power of Nmap, so I won&rsquo;t dive too deeply into it here.</span></p><p class="c11 c12"><span class="c3">For API discovery, you should run two Nmap scans in particular: general detection and all port. The Nmap general detection scan uses default scripts and service enumeration against a target and then saves the output in three formats for later review (</span><span class="c17">-oX</span><span class="c3">&nbsp;for XML, </span><span class="c17">-oN</span><span class="c3">&nbsp;for Nmap, </span><span class="c17">-oG</span><span class="c3">&nbsp;for greppable, or </span><span class="c17">-oA</span><span class="c3 c5">&nbsp;for all three formats):</span></p><p class="c33"><span class="c8">$ </span><span class="c28">nmap -sC -sV </span><span class="c8">&lt;target address or network range&gt;</span><span class="c28 c5">&nbsp;-oA nameofoutput</span></p><p class="c11 c12"><span class="c3 c5">The Nmap all-port scan will quickly check all 65,535 TCP ports for running services, application versions, and host operating system in use:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">nmap -p- </span><span class="c8">&lt;target address&gt;</span><span class="c28 c5">&nbsp;-oA allportscan</span></p><p class="c11 c12"><span class="c3 c5">As soon as the general detection scan begins returning results, kick off the all-port scan. Then begin your hands-on analysis of the results. You&rsquo;ll most likely discover APIs by looking at the results related to HTTP traffic and other indications of web servers. Typically, you&rsquo;ll find these running on ports 80 and 443, but an API can be hosted on all sorts of different ports. Once you discover a web server, open a browser and begin analysis.</span></p><h3 class="c1" id="h.1ah5yxhzo0bt"><span class="c0">Finding Hidden Paths in Robots.txt</span></h3><p class="c11"><span class="c3 c23">Robots.txt</span><span class="c3">&nbsp;is a common text file that tells web crawlers to omit results from the search engine findings. Ironically, it also serves to tell us which paths the target wants to keep secret. You can find the </span><span class="c3 c23">robots.txt</span><span class="c3">&nbsp;file by navigating to the target&rsquo;s </span><span class="c3 c23">/robots.txt</span><span class="c3">&nbsp;directory (for example, </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://www.twitter.com/robots.txt&amp;sa=D&amp;source=editors&amp;ust=1681144447880506&amp;usg=AOvVaw3AgXqpbkGnRMKwnrrJ-yFm">https://www.twitter.com/robots.txt</a></span><span class="c3 c5">).</span></p><p class="c11 c12"><span class="c3">The following is an actual </span><span class="c3 c23">robots.txt</span><span class="c3">&nbsp;file from an active web server, complete with a disallowed </span><span class="c3 c23">/api/</span><span class="c3 c5">&nbsp;path:</span></p><p class="c13"><span class="c8 c5">User-agent: *</span></p><p class="c13"><span class="c8 c5">Disallow: /appliance/</span></p><p class="c13"><span class="c8 c5">Disallow: /login/</span></p><p class="c13"><span class="c8 c5">Disallow: /api/</span></p><p class="c33"><span class="c8 c5">Disallow: /files/</span></p><h3 class="c1" id="h.gqe7tzsypu8u"><span class="c0">Finding Sensitive Information with Chrome DevTools</span></h3><p class="c11"><span class="c3 c5">In Chapter 4, I said that Chrome DevTools contains some highly underrated web application hacking tools. The following steps will help you easily and systematically filter through thousands of lines of code in order to find sensitive information in page sources.</span></p><p class="c11 c12"><span class="c3 c5">Begin by opening your target page and then open Chrome DevTools with F12 or CTRL-SHIFT-I. Adjust the Chrome DevTools window until you have enough space to work with. Select the Network tab and then refresh the page.</span></p><p class="c11 c12"><span class="c3">Now look for interesting files (you may even find one titled &ldquo;API&rdquo;). Right-click any JavaScript files that interest you and click </span><span class="c6">Open in Sources Panel</span><span class="c3">&nbsp;(see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-12&amp;sa=D&amp;source=editors&amp;ust=1681144447882538&amp;usg=AOvVaw38Ykfs2lF05My8giZsCKtc">Figure 6-12</a></span><span class="c3 c5">) to view their source code. Alternatively, click XHR to find see the Ajax requests being made.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 300.00px;"><img alt="Screenshot of the DevTools Network panel, which shows a list of the files that compose the web page" src="images/image23.png" style="width: 624.00px; height: 300.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-12</span><span class="c18">: The Open in Sources panel option from the DevTools Network tab</span></p><p class="c11 c12"><span class="c3">Search for potentially interesting lines of JavaScript. Some key terms to search for include &ldquo;API,&rdquo; &ldquo;APIkey,&rdquo; &ldquo;secret,&rdquo; and &ldquo;password.&rdquo; For example, </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-13&amp;sa=D&amp;source=editors&amp;ust=1681144447883503&amp;usg=AOvVaw2Xua2-MLB8S6GL95qd4Gl9">Figure 6-13</a></span><span class="c3 c5">&nbsp;illustrates how you could discover an API that is nearly 4,200 lines deep within a script.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 548.00px; height: 193.33px;"><img alt="Screenshot of a highlighted API endpoint found within a source code file in the DevTools interface" src="images/image19.png" style="width: 548.00px; height: 193.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-13</span><span class="c18">: On line 4,197 of this page source, an API is in use.</span></p><p class="c11 c12"><span class="c3 c5">You can also make use of the DevTools Memory tab, which allows you to take a snapshot of the memory heap distribution. Sometimes the static JavaScript files include all sorts of information and thousands of lines of code. In other words, it may not be entirely clear exactly how the web app leverages an API. Instead, you could use the Memory panel to record how the web application is using resources to interact with an API.</span></p><p class="c11 c12"><span class="c3">With DevTools open, click the </span><span class="c6">Memory</span><span class="c3">&nbsp;tab. Under Select Profiling Type, choose </span><span class="c6">Heap Snapshot</span><span class="c3">. Then, under Select JavaScript VM Instance, choose the target to review. Next, click the </span><span class="c6">Take Snapshot</span><span class="c3">&nbsp;button (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-14&amp;sa=D&amp;source=editors&amp;ust=1681144447884732&amp;usg=AOvVaw0J1teYP6h5C3Rb4D-pfGzh">Figure 6-14</a></span><span class="c3 c5">).</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 465.33px;"><img alt="Screenshot of the DevTools Memory panel with &ldquo;Heap snapshot&rdquo; checked and twitter.com selected as the target" src="images/image8.png" style="width: 624.00px; height: 465.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-14</span><span class="c18">: The Memory panel within DevTools</span></p><p class="c11 c12"><span class="c3">Once the file has been compiled under the Heap Snapshots section on the left, select the new snapshot and use CTRL-F to search for potential API paths. Try searching for terms using the common API path terms, like &ldquo;api,&rdquo; &ldquo;v1,&rdquo; &ldquo;v2,&rdquo; &ldquo;swagger,&rdquo; &ldquo;rest,&rdquo; and &ldquo;dev.&rdquo; If you need additional inspiration, check out the Assetnote API wordlists (</span><span class="c15"><a class="c16" href="https://www.google.com/url?q=http://wordlists.assetnote.io/&amp;sa=D&amp;source=editors&amp;ust=1681144447885554&amp;usg=AOvVaw3ayGbLltXuAUQT2XxiCENN">http://wordlists.assetnote.io</a></span><span class="c3">). If you&rsquo;ve built your attack machine according to Chapter 4, these wordlists should be available to you under </span><span class="c3 c23">/api/wordlists</span><span class="c3">. </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-15&amp;sa=D&amp;source=editors&amp;ust=1681144447886017&amp;usg=AOvVaw2eyOImeX-u45vW633BpOG4">Figure 6-15</a></span><span class="c3 c5">&nbsp;indicates the results you would expect to see when using the Memory panel in DevTools to search a snapshot for &ldquo;api&rdquo;.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 621.33px; height: 622.67px;"><img alt="Screenshot of API paths returned in DevTools after a search for the &ldquo;api&rdquo; keyword" src="images/image22.png" style="width: 621.33px; height: 622.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-15</span><span class="c18">: The search results from a memory snapshot</span></p><p class="c11 c12"><span class="c3 c5">As you can see, the Memory module can help you discover the existence of APIs and their paths. Additionally, you can use it to compare different memory snapshots. This can help you see the API paths used in authenticated and unauthenticated states, in different parts of a web application, and in its different features.</span></p><p class="c11 c12"><span class="c3">Finally, use the Chrome DevTools Performance tab to record certain actions (such as clicking a button) and review them over a timeline broken down into milliseconds. This lets you see if any event you initiate on a given web page is making API requests in the background. Simply click the circular record button, perform actions on a web page, and stop the recording. Then you can review the triggered events and investigate the initiated actions. </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-16&amp;sa=D&amp;source=editors&amp;ust=1681144447887023&amp;usg=AOvVaw2OAsHZV6Xgi4Cs1E3cnNAc">Figure 6-16</a></span><span class="c3 c5">&nbsp;shows a recording of clicking the login button of a web page.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 541.33px; height: 610.67px;"><img alt="Screenshot of a timeline in the DevTools performance tab highlighting the number of milliseconds elapsed after a click of a login button" src="images/image2.png" style="width: 541.33px; height: 610.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-16</span><span class="c18">: A performance recording within DevTools</span></p><p class="c11 c12"><span class="c3">Under &ldquo;Main,&rdquo; you can see that a click event occurred, initiating a POST request to the URL </span><span class="c3 c23">/identity/api/auth/login</span><span class="c3 c5">, a clear indication that you&rsquo;ve discovered an API. To help you spot activity on the timeline, consult the peaks and valleys on the graph located near the top. A peak represents an event, such as a click. Navigate to a peak and investigate the events by clicking the timeline.</span></p><p class="c11 c12"><span class="c3 c5">As you can see, DevTools is filled with powerful tools that can help you discover APIs. Do not underestimate the usefulness of its various modules.</span></p><h3 class="c1" id="h.dpze9zifyt0q"><span class="c0">Validating APIs with Burp Suite</span></h3><p class="c11"><span class="c3">Not only will Burp Suite help you find APIs, but it can also be your primary mode of validating your discoveries. To validate APIs using Burp, intercept an HTTP request sent from your browser and then use the Forward button to send it to the server. Next, send the request to the Repeater module, where you can view the raw web server response (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-17&amp;sa=D&amp;source=editors&amp;ust=1681144447888468&amp;usg=AOvVaw2T5-OhJ27RkRx5Jd--oHc_">Figure 6-17</a></span><span class="c3 c5">).</span></p><p class="c11 c12"><span class="c3">As you can see in this example,</span><span class="c6">&nbsp;</span><span class="c3">the server returns a 401 Unauthorized status code, which means that I am not authorized to use the API. Compare this request to one that is for a nonexistent resource, and you will see that your target typically responds to nonexistent resources in a certain way. (To request a nonexistent resource, simply add various gibberish to the URL path in Repeater, like </span><span class="c3 c23">GET /user/test098765</span><span class="c3 c5">. Send the request in Repeater and see how the web server responds. Typically, you should get a 404 or similar response.)</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 578.67px; height: 304.00px;"><img alt="Screenshot of an HTTP response in Burp Suite" src="images/image25.png" style="width: 578.67px; height: 304.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-17</span><span class="c18">: The web server returns an HTTP 401 Unauthorized error.</span></p><p class="c11 c12"><span class="c3">The verbose error message found under the </span><span class="c17">WWW-Authenticate</span><span class="c3">&nbsp;header reveals the path </span><span class="c3 c23">/api/auth</span><span class="c3 c5">, validating the existence of the API. Return to Chapter 4 for a crash course on using Burp.</span></p><h3 class="c1" id="h.q81xfgaei0xi"><span class="c0">Crawling URIs with OWASP ZAP</span></h3><p class="c11"><span class="c3">One of the objectives of active reconnaissance is to discover all of a web page&rsquo;s directories and files, also known as </span><span class="c3 c23">URIs</span><span class="c3">, or </span><span class="c3 c23">uniform resource identifiers</span><span class="c3 c5">. There are two approaches to discovering a site&rsquo;s URIs: crawling and brute force. OWASP ZAP crawls web pages to discover content by scanning each page for references and links to other web pages.</span></p><p class="c11 c12"><span class="c3">To use ZAP, open it and click past the session pop-up. If it isn&rsquo;t already selected, click the </span><span class="c6">Quick Start</span><span class="c3">&nbsp;tab, shown in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-18&amp;sa=D&amp;source=editors&amp;ust=1681144447890536&amp;usg=AOvVaw2GyRgmP0NHSJ-53PAzYQB9">Figure 6-18</a></span><span class="c3">. Enter the target URL and click </span><span class="c6">Attack</span><span class="c3 c5">.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 337.33px;"><img alt="Screenshot of the ZAP Quick Start interface, which accepts a URL to attack and has &ldquo;Use traditional spider&rdquo; checked" src="images/image17.png" style="width: 624.00px; height: 337.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-18</span><span class="c18">: An automated scan set up to scan a target with OWASP ZAP</span></p><p class="c11 c12"><span class="c3">After the automated scan commences, you can watch the live results using the Spider or Sites tab. You may discover API endpoints in these tabs. If you do not find any obvious APIs, use the Search tab, shown in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-19&amp;sa=D&amp;source=editors&amp;ust=1681144447891593&amp;usg=AOvVaw3ubY-Zc0buWoM9WXPbpDR_">Figure 6-19</a></span><span class="c3 c5">, and look for terms like &ldquo;API,&rdquo; &ldquo;GraphQL,&rdquo; &ldquo;JSON,&rdquo; &ldquo;RPC,&rdquo; and &ldquo;XML&rdquo; to find potential API endpoints.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 366.67px;"><img alt="Screenshot of a ZAP interface listing discovered API endpoints and showing the code in which they were found" src="images/image14.png" style="width: 624.00px; height: 366.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-19</span><span class="c18">: The power of searching the ZAP automated scan results for APIs</span></p><p class="c11 c12"><span class="c3">Once you&rsquo;ve found a section of the site you want to investigate more thoroughly, begin manual exploration using the ZAP HUD to interact with the web application&rsquo;s buttons and user input fields. While you do this, ZAP will perform additional scans for vulnerabilities. Navigate to the </span><span class="c6">Quick Start</span><span class="c3">&nbsp;tab and select </span><span class="c6">Manual Explore</span><span class="c3">&nbsp;(you may need to click the back arrow to exit the automated scan). On the Manual Explore screen, shown in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-20&amp;sa=D&amp;source=editors&amp;ust=1681144447892613&amp;usg=AOvVaw2AsI23TMKEJaoJFwDG4ovn">Figure 6-20</a></span><span class="c3">, select your desired browser and then click </span><span class="c6">Launch Browser</span><span class="c3 c5">.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 413.33px; height: 290.67px;"><img alt="Screenshot of the ZAP Manual Explore page, which accepts a URL to test and has &ldquo;Enable HUD&rdquo; selected" src="images/image12.png" style="width: 413.33px; height: 290.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-20</span><span class="c18">: Launching the Manual Explore option of Burp Suite</span></p><p class="c11 c12"><span class="c3">The ZAP HUD should now be enabled. Click </span><span class="c6">Continue to Your Target</span><span class="c3">&nbsp;in the ZAP HUD welcome screen (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-21&amp;sa=D&amp;source=editors&amp;ust=1681144447893549&amp;usg=AOvVaw3sPdPrn8914VISaOzvVJcU">Figure 6-21</a></span><span class="c3 c5">).</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 534.67px; height: 452.00px;"><img alt="Screenshot of the ZAP HUD interface showing a welcome message, as well as &ldquo;Continue to your target&rdquo; and &ldquo;Take the HUD tutorial&rdquo; buttons" src="images/image20.png" style="width: 534.67px; height: 452.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-21</span><span class="c18">: This is the first screen you will see when you launch the ZAP HUD.</span></p><p class="c11 c12"><span class="c3 c5">Now you can manually explore the target web application, and ZAP will work in the background to automatically scan for vulnerabilities. In addition, ZAP will continue to search for additional paths while you navigate around the site. Several buttons should now line the left and right borders of the browser. The colored flags represent page alerts, which could be vulnerability findings or interesting anomalies. These flagged alerts will be updated as you browse around the site.</span></p><h3 class="c1" id="h.9mbj2r6v1yr4"><span class="c0">Brute-Forcing URIs with Gobuster</span></h3><p class="c11"><span class="c3 c5">Gobuster can be used to brute-force URIs and DNS subdomains from the command line. (If you prefer a graphical user interface, check out OWASP&rsquo;s Dirbuster.) In Gobuster, you can use wordlists for common directories and subdomains to automatically request every item in the wordlist, send the items to a web server, and filter the interesting server responses. The results generated from Gobuster will provide you with the URL path and the HTTP status response codes. (While you can brute-force URIs with Burp Suite&rsquo;s Intruder, Burp Community Edition is much slower than Gobuster.)</span></p><p class="c11 c12"><span class="c3">Whenever you&rsquo;re using a brute-force tool, you&rsquo;ll have to balance the size of the wordlist and the length of time needed to achieve results. Kali has directory wordlists stored under </span><span class="c3 c23">/usr/share/wordlists/dirbuster</span><span class="c3">&nbsp;that are thorough but will take some time to complete. Instead, you can use the </span><span class="c3 c23">~/api/wordlists</span><span class="c3 c5">&nbsp;we set up in Chapter 4, which will speed up your Gobuster scans since the wordlist is relatively short and contains only directories related to APIs.</span></p><p class="c11 c12"><span class="c3 c5">The following example uses an API-specific wordlist to find the directories on an IP address:</span></p><p class="c13"><span class="c8">$ </span><span class="c28">gobuster dir -u http://192.168.195.132:8000 -w /home/hapihacker/api/wordlists/common_apis_160</span></p><p class="c13"><span class="c8 c5">========================================================</span></p><p class="c13"><span class="c8 c5">Gobuster</span></p><p class="c13"><span class="c8 c5">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></p><p class="c13"><span class="c8 c5">========================================================</span></p><p class="c13"><span class="c8 c5">[+] Url: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://192.168.195.132:8000</span></p><p class="c13"><span class="c8 c5">[+] Method: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GET</span></p><p class="c13"><span class="c8 c5">[+] Threads: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10</span></p><p class="c13"><span class="c8 c5">[+] Wordlist: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/home/hapihacker/api/wordlists/common_apis_160</span></p><p class="c13"><span class="c8 c5">[+] Negative Status codes: &nbsp; 404</span></p><p class="c13"><span class="c8 c5">[+] User Agent: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gobuster</span></p><p class="c13"><span class="c8 c5">[+] Timeout: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10s</span></p><p class="c13"><span class="c8 c5">========================================================</span></p><p class="c13"><span class="c8 c5">09:40:11 Starting gobuster in directory enumeration mode</span></p><p class="c13"><span class="c8 c5">========================================================</span></p><p class="c13"><span class="c8 c5">/api &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 253]</span></p><p class="c13"><span class="c8 c5">/admin &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 500) [Size: 1179]</span></p><p class="c13"><span class="c8 c5">/admins &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 500) [Size: 1179]</span></p><p class="c13"><span class="c8 c5">/login &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 2833]</span></p><p class="c33"><span class="c8 c5">/register &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 2846]</span></p><p class="c11 c12"><span class="c3">Once you find API directories like the </span><span class="c3 c23">/api</span><span class="c3">&nbsp;directory shown in this output, either by crawling or brute force, you can use Burp to investigate them further. Gobuster has additional options, and you can list them using the </span><span class="c17">-h</span><span class="c3 c5">&nbsp;option:</span></p><p class="c33"><span class="c8">$ </span><span class="c28 c5">gobuster dir -h</span></p><p class="c11 c12"><span class="c3">If you would like to ignore certain response status codes, use the option </span><span class="c17">-b</span><span class="c3">. If you would like to see additional status codes, use </span><span class="c17">-x</span><span class="c3 c5">. You could enhance a Gobuster search with the following:</span></p><p class="c33"><span class="c8">$ </span><span class="c28 c5">gobuster dir -u http://targetaddress/ -w /usr/share/wordlists/api_list/common_apis_160 -x 200,202,301 -b 302</span></p><p class="c11 c12"><span class="c3 c5">Gobuster provides a quick way to enumerate active URLs and find API paths.</span></p><h3 class="c1" id="h.m3ehj06aasdj"><span class="c0">Discovering API Content with Kiterunner</span></h3><p class="c11"><span class="c3 c5">In Chapter 4, I covered the amazing accomplishments of Assetnote&rsquo;s Kiterunner, the best tool available for discovering API endpoints and resources. Now it&rsquo;s time to put this tool to use.</span></p><p class="c11 c12"><span class="c3">While Gobuster works well for a quick scan of a web application to discover URL paths, it typically relies on standard HTTP GET requests. Kiterunner will not only use all HTTP request methods common with APIs (GET, POST, PUT, and DELETE) but also mimic common API path structures. In other words, instead of requesting GET </span><span class="c3 c23">/api/v1/user/create</span><span class="c3">, Kiterunner will try POST </span><span class="c3 c23">POST /api/v1/user/create</span><span class="c3 c5">, mimicking a more realistic request.</span></p><p class="c11 c12"><span class="c3 c5">You can perform a quick scan of your target&rsquo;s URL or IP address like this:</span></p><p class="c13"><span class="c8">$ </span><span class="c28">kr scan http://192.168.195.132:8090 -w ~/api/wordlists/data/kiterunner/routes-large.kite</span></p><p class="c13 c39"><span class="c8 c5"></span></p><p class="c13"><span class="c8 c5">+----------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------</span></p><p class="c13"><span class="c8 c5">| SETTING &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| VALUE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">+----------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------</span></p><p class="c13"><span class="c8 c5">| delay &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0s &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| full-scan &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| full-scan-requests &nbsp; | 1451872 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| headers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| [x-forwarded-for:127.0.0.1] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| kitebuilder-apis &nbsp; &nbsp; | [/home/hapihacker/api/wordlists/data/kiterunner/routes-large.kite] &nbsp; |</span></p><p class="c13"><span class="c8 c5">| max-conn-per-host &nbsp; &nbsp;| 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| max-parallel-host &nbsp; &nbsp;| 50 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| max-redirects &nbsp; &nbsp; &nbsp; &nbsp;| 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| max-timeout &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 3s &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| preflight-routes &nbsp; &nbsp; | 11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| quarantine-threshold | 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| quick-scan-requests &nbsp;| 103427 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| read-body &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| read-headers &nbsp; &nbsp; &nbsp; &nbsp; | false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| scan-depth &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| skip-preflight &nbsp; &nbsp; &nbsp; | false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| target &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | http://192.168.195.132:8090 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">| total-routes &nbsp; &nbsp; &nbsp; &nbsp; | 957191 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></p><p class="c13"><span class="c8 c5">| user-agent &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Chrome. Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p class="c13"><span class="c8 c5">+----------------------+-----------------------------------------------------------------------</span></p><p class="c13 c39"><span class="c8 c5"></span></p><p class="c13"><span class="c8 c5">POST &nbsp; &nbsp;400 [ &nbsp; &nbsp;941, &nbsp; 46, &nbsp;11] http://192.168.195.132:8090/trade/queryTransationRecords 0cf689f783e6dab12b6940616f005ecfcb3074c4</span></p><p class="c13"><span class="c8 c5">POST &nbsp; &nbsp;400 [ &nbsp; &nbsp;941, &nbsp; 46, &nbsp;11] http://192.168.195.132:8090/event 0cf6890acb41b42f316e86efad29ad69f54408e6</span></p><p class="c33"><span class="c8 c5">GET &nbsp; &nbsp; 301 [ &nbsp; &nbsp;243, &nbsp; &nbsp;7, &nbsp;10] http://192.168.195.132:8090/api-docs -&gt; /api-docs/?group=63578528&amp;route=33616912 0cf681b5cf6c877f2e620a8668a4abc7ad07e2db</span></p><p class="c11 c12"><span class="c3">As you can see, Kiterunner will provide you with a list of interesting paths. The fact that the server is responding uniquely to requests to certain </span><span class="c3 c23">/api/</span><span class="c3 c5">&nbsp;paths indicates that the API exists.</span></p><p class="c11 c12"><span class="c3 c5">Note that we conducted this scan without any authorization headers, which the target API likely requires. I will demonstrate how to use Kiterunner with authorization headers in Chapter 7.</span></p><p class="c11 c12"><span class="c3">If you want to use a text wordlist rather than a </span><span class="c3 c23">.kite </span><span class="c3">file, use the </span><span class="c17">brute</span><span class="c3 c5">&nbsp;option with the text file of your choice:</span></p><p class="c33"><span class="c8">$ </span><span class="c28">kr brute </span><span class="c8">&lt;target&gt;</span><span class="c28 c5">&nbsp;-w ~/api/wordlists/data/automated/nameofwordlist.txt</span></p><p class="c11 c12"><span class="c3 c5">If you have many targets, you can save a list of line-separated targets as a text file and use that file as the target. You can use any of the following line-separated URI formats as input:</span></p><ol class="c19 lst-kix_r98bjupa5r1i-0 start" start="1"><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">Test.com</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">Test2.com:443</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c23 c26">http://test3.com</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://test4.com</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://test5.com:8888/api</span></li></ol><p class="c11 c12"><span class="c3">One of the coolest Kiterunner features is the ability to replay requests. Thus, not only will you have an interesting result to investigate, you will also be able to dissect exactly why that request is interesting. In order to replay a request, copy the entire line of content into Kiterunner, paste it using the </span><span class="c17">kb replay</span><span class="c3 c5">&nbsp;option, and include the wordlist you used:</span></p><p class="c33"><span class="c8">$ </span><span class="c28 c5">kr kb replay &quot;GET &nbsp; &nbsp; 414 [ &nbsp; &nbsp;183, &nbsp; &nbsp;7, &nbsp; 8] http://192.168.50.35:8888/api/privatisations/count 0cf6841b1e7ac8badc6e237ab300a90ca873d571&quot; -w ~/api/wordlists/data/kiterunner/routes-large.kite</span></p><p class="c11 c12"><span class="c3 c5">Running this will replay the request and provide you with the HTTP response. You can then review the contents to see if there is anything worthy of investigation. I normally review interesting results and then pivot to testing them using Postman and Burp Suite.</span></p><h2 class="c1" id="h.3a6wabgabw75"><span class="c42 c5">Summary</span></h2><p class="c11"><span class="c3 c5">In this chapter, we took a practical dive into discovering APIs using passive and active reconnaissance. Information gathering is arguably the most important part of hacking APIs for a few reasons. First, you cannot attack an API if you cannot find it. Passive reconnaissance will provide you with insight into an organization&rsquo;s public exposure and attack surface. You may be able to find some easy wins such as passwords, API keys, API tokens, and other information disclosure vulnerabilities.</span></p><p class="c11 c12"><span class="c3 c5">Next, actively engaging with your client&rsquo;s environment will uncover the current operational context of their API, such as the operating system of the server hosting it, the API version, the type of API, what supporting software versions are in use, whether the API is vulnerable to known exploits, the intended use of the systems, and how they work together.</span></p><p class="c11 c12"><span class="c3 c5">In the next chapter, you&rsquo;ll begin manipulating and fuzzing APIs to discover vulnerabilities.</span></p><h2 class="c1" id="h.uxp84ri0c3ob"><span class="c5 c27">Lab #3: Performing Active Recon for a Black Box Test</span></h2><p class="c11"><span class="c3 c5">Your company has been approached by a well-known auto services business, crAPI Car Services. The company wants you to perform an API penetration test. In some engagements, the customer will provide you with details such as their IP address, port number, and maybe API documentation. However, crAPI wants this to be a black box test. The company is counting on you to find its API and eventually test whether it has any vulnerabilities.</span></p><p class="c11 c12"><span class="c3">Make sure you have your crAPI lab instance up and running before you proceed. Using your Kali API hacking machine, start by discovering the API&rsquo;s IP address. My crAPI instance is located at </span><span class="c3 c23">192.168.50.35</span><span class="c3">. To discover the IP address of your locally deployed instance, run </span><span class="c17">netdiscover</span><span class="c3 c5">&nbsp;and then confirm your findings by entering the IP address in a browser. Once you have your target address, use Nmap for general detection scanning.</span></p><p class="c11 c12"><span class="c3">Begin with a general Nmap scan to find out what you are working with. As discussed earlier, </span><span class="c17">nmap -sC -sV 192.168.50.35 -oA crapi_scan</span><span class="c3 c5">&nbsp;scans the provided target by using service enumeration and default Nmap scripts, and then it saves the results in multiple formats for later review.</span></p><p class="c13"><span class="c8 c5">Nmap scan report for 192.168.50.35</span></p><p class="c13"><span class="c8 c5">Host is up (0.00043s latency).</span></p><p class="c13"><span class="c8 c5">Not shown: 994 closed ports</span></p><p class="c13"><span class="c8 c5">PORT &nbsp; &nbsp; STATE SERVICE &nbsp; &nbsp;VERSION</span></p><p class="c13"><span class="c8 c5">1025/tcp open &nbsp;smtp &nbsp; &nbsp; &nbsp; Postfix smtpd</span></p><p class="c13"><span class="c8 c5">|_smtp-commands: Hello nmap.scanme.org, PIPELINING, AUTH PLAIN,</span></p><p class="c13"><span class="c8 c5">5432/tcp open &nbsp;postgresql PostgreSQL DB 9.6.0 or later</span></p><p class="c13"><span class="c8 c5">| fingerprint-strings:</span></p><p class="c13"><span class="c8 c5">| &nbsp; SMBProgNeg:</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; SFATAL</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; VFATAL</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; C0A000</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Munsupported frontend protocol 65363.19778: server supports 2.0 to 3.0</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Fpostmaster.c</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; L2109</span></p><p class="c13"><span class="c8 c5">|_ &nbsp; &nbsp;RProcessStartupPacket</span></p><p class="c13"><span class="c8 c5">8000/tcp open &nbsp;http-alt &nbsp; WSGIServer/0.2 CPython/3.8.7</span></p><p class="c13"><span class="c8 c5">| fingerprint-strings:</span></p><p class="c13"><span class="c8 c5">| &nbsp; FourOhFourRequest:</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; HTTP/1.1 404 Not Found</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Date: Tue, 25 May 2021 19:04:36 GMT</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Server: WSGIServer/0.2 CPython/3.8.7</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Content-Type: text/html</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Content-Length: 77</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Vary: Origin</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; X-Frame-Options: SAMEORIGIN</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; &lt;h1&gt;Not Found&lt;/h1&gt;&lt;p&gt;The requested resource was not found on this server.&lt;/p&gt;</span></p><p class="c13"><span class="c8 c5">| &nbsp; GetRequest:</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; HTTP/1.1 404 Not Found</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Date: Tue, 25 May 2021 19:04:31 GMT</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Server: WSGIServer/0.2 CPython/3.8.7</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Content-Type: text/html</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Content-Length: 77</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; Vary: Origin</span></p><p class="c13"><span class="c8 c5">| &nbsp; &nbsp; X-Frame-Options: SAMEORIGIN</span></p><p class="c33"><span class="c8 c5">| &nbsp; &nbsp; &lt;h1&gt;Not Found&lt;/h1&gt;&lt;p&gt;The requested resource was not found on this server.&lt;/p&gt;</span></p><p class="c11 c12"><span class="c3 c5">This Nmap scan result shows that the target has several open ports, including 1025, 5432, 8000, 8080, 8087, and 8888. Nmap has provided enough information for you to know that port 1025 is running an SMTP mail service, port 5432 is a PostgreSQL database, and the remaining ports received HTTP responses. The Nmap scans also reveal that the HTTP services are using CPython, WSGIServer, and OpenResty web app servers.</span></p><p class="c11 c12"><span class="c3 c5">Notice the response from port 8080, whose headers suggest an API:</span></p><p class="c33"><span class="c8 c5">Content-Type: application/json and &quot;error&quot;: &quot;Invalid Token&quot; }.</span></p><p class="c11 c12"><span class="c3 c5">Follow up the general Nmap scan with an all-port scan to see if anything is hiding on an uncommon port:</span></p><p class="c13"><span class="c8">$ </span><span class="c28">nmap -p- 192.168.50.35</span></p><p class="c13 c39"><span class="c8 c5"></span></p><p class="c13"><span class="c8 c5">Nmap scan report for 192.168.50.35</span></p><p class="c13"><span class="c8 c5">Host is up (0.00068s latency).</span></p><p class="c13"><span class="c8 c5">Not shown: 65527 closed ports</span></p><p class="c13"><span class="c8 c5">PORT &nbsp; &nbsp; &nbsp;STATE SERVICE</span></p><p class="c13"><span class="c8 c5">1025/tcp &nbsp;open &nbsp;NFS-or-IIS</span></p><p class="c13"><span class="c8 c5">5432/tcp &nbsp;open &nbsp;postgresql</span></p><p class="c13"><span class="c8 c5">8000/tcp &nbsp;open &nbsp;http-alt</span></p><p class="c13"><span class="c8 c5">8025/tcp &nbsp;open &nbsp;ca-audit-da</span></p><p class="c13"><span class="c8 c5">8080/tcp &nbsp;open &nbsp;http-proxy</span></p><p class="c13"><span class="c8 c5">8087/tcp &nbsp;open &nbsp;simplifymedia</span></p><p class="c13"><span class="c8 c5">8888/tcp &nbsp;open &nbsp;sun-answerbook</span></p><p class="c33"><span class="c8 c5">27017/tcp open &nbsp;mongod</span></p><p class="c11 c12"><span class="c3 c5">The all-port scan discovers a MailHog web server running on 8025 and MongoDB on the uncommon port 27017. These could prove useful when we attempt to exploit the API in later labs.</span></p><p class="c11 c12"><span class="c3 c5">The results of your initial Nmap scans reveal a web application running on port 8080, which should lead to the next logical step: a hands-on analysis of the web app. Visit all ports that sent HTTP responses to Nmap (namely, ports 8000, 8025, 8080, 8087, and 8888).</span></p><p class="c11 c12"><span class="c3 c5">For me, this would mean entering the following addresses in a browser:</span></p><ol class="c19 lst-kix_fz0qmuntlxok-0 start" start="1"><li class="c22 c25 li-bullet-0"><span class="c3 c26 c23">http://192.168.50.35:8000</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://192.168.50.35:8025</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://192.168.50.35:8080</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://192.168.50.35:8087</span></li><li class="c25 c22 li-bullet-0"><span class="c3 c26 c23">http://192.168.50.35:8888</span></li></ol><p class="c11 c12"><span class="c3 c5">Port 8000 issues a blank web page with the message &ldquo;The requested resource was not found on this server.&rdquo;</span></p><p class="c11 c12"><span class="c3 c5">Port 8025 reveals the MailHog web server with a &ldquo;welcome to crAPI&rdquo; email. We will return to this later in the labs.</span></p><p class="c11 c12"><span class="c3">Port 8080 returns the </span><span class="c17">{ &quot;error&quot;: &quot;Invalid Token&quot; }</span><span class="c3 c5">&nbsp;we received in the first Nmap scan.</span></p><p class="c11 c12"><span class="c3 c5">Port 8087 shows a &ldquo;404 page not found&rdquo; error.</span></p><p class="c11 c12"><span class="c3">Finally, port 8888 reveals the crAPI login page, as seen in </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-22&amp;sa=D&amp;source=editors&amp;ust=1681144447912145&amp;usg=AOvVaw28-BYYAlnZQDqZOd4qXqTm">Figure 6-22</a></span><span class="c3 c5">.</span></p><p class="c11 c12"><span class="c3 c5">Due to the errors and information related to authorization, the open ports will likely be of more use to you as an authenticated user.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 541.33px; height: 488.00px;"><img alt="Screenshot of the crAPI login interface with a username and password field" src="images/image5.png" style="width: 541.33px; height: 488.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-22</span><span class="c18">: The landing page for crAPI</span></p><p class="c11 c12"><span class="c3 c5">Now use DevTools to investigate the JavaScript source files on this page. Visit the Network tab and refresh the page so the source files populate. Select a source file that interests you, right-click it, and send it to the Sources panel.</span></p><p class="c11 c12"><span class="c3">You should uncover the </span><span class="c3 c23">/static/js/main.f6a58523.chunk.js</span><span class="c3">&nbsp;source file. Search for &ldquo;API&rdquo; within this file, and you&rsquo;ll find references to crAPI API endpoints (see </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-23&amp;sa=D&amp;source=editors&amp;ust=1681144447913349&amp;usg=AOvVaw0qvnjycU5vXUQ0pRu30Y4T">Figure 6-23</a></span><span class="c3 c5">).</span></p><p class="c11 c12"><span class="c3 c5">Congratulations! You&rsquo;ve discovered your first API using Chrome DevTools for active reconnaissance. By simply searching through a source file, you found many unique API endpoints.</span></p><p class="c11 c12"><span class="c3">Now, if you review the source file, you should notice APIs involved in the signup process. As a next step, it would be a good idea to intercept the requests for this process to see the API in action. On the crAPI web page, click the </span><span class="c6">Signup</span><span class="c3">&nbsp;button. Fill in the name, email, phone, and password fields. Then, before clicking the Signup button at the bottom of the page, start Burp Suite and use the FoxyProxy Hackz proxy to intercept your browser traffic. Once Burp Suite and the Hackz proxy are running, click the </span><span class="c6">Signup</span><span class="c3 c5">&nbsp;button.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 586.67px;"><img alt="Screenshot of a file in DevTools showing a list of API endpoints" src="images/image7.png" style="width: 624.00px; height: 586.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-23</span><span class="c18">: The crAPI main JavaScript source file</span></p><p class="c11 c12"><span class="c3">In </span><span class="c15"><a class="c16" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c06.xhtml%23figure6-24&amp;sa=D&amp;source=editors&amp;ust=1681144447914603&amp;usg=AOvVaw3sUzXmSKfamXreaJ-Vx4zl">Figure 6-24</a></span><span class="c3">, you can see that the crAPI signup page issues a POST request to </span><span class="c3 c23">/identity/api/auth/signup</span><span class="c3 c5">&nbsp;when you register for a new account. This request, captured in Burp, validates that you have discovered the existence of the crAPI API and confirmed firsthand one of the functions of the identified endpoint.</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 546.67px; height: 361.33px;"><img alt="Screenshot of a POST request in Burp Suite" src="images/image13.png" style="width: 546.67px; height: 361.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c21"><span class="c14">Figure 6-24</span><span class="c18">: The crAPI registration request intercepted using Burp Suite</span></p><p class="c11 c12"><span class="c3 c5">Great job! Not only did you discover an API, but you also found a way to interact with it. In our next lab, you&rsquo;ll interact with this API&rsquo;s functions and identify its weaknesses. I encourage you to continue testing other tools against this target. Can you discover APIs in any other ways?</span></p><p class="c13 c39"><span class="c5 c59"></span></p></body></html>