<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_um77phknmrlo-8{list-style-type:none}ul.lst-kix_um77phknmrlo-7{list-style-type:none}.lst-kix_n3uzf8eo1li-6>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-6}ul.lst-kix_um77phknmrlo-6{list-style-type:none}ul.lst-kix_2utjbsp2ayf-0{list-style-type:none}ul.lst-kix_2utjbsp2ayf-1{list-style-type:none}ul.lst-kix_2utjbsp2ayf-2{list-style-type:none}ul.lst-kix_2utjbsp2ayf-3{list-style-type:none}ul.lst-kix_2utjbsp2ayf-4{list-style-type:none}ul.lst-kix_2utjbsp2ayf-5{list-style-type:none}ol.lst-kix_v8xosipxsbka-0.start{counter-reset:lst-ctn-kix_v8xosipxsbka-0 0}ul.lst-kix_2utjbsp2ayf-6{list-style-type:none}ul.lst-kix_2utjbsp2ayf-7{list-style-type:none}ul.lst-kix_2utjbsp2ayf-8{list-style-type:none}ul.lst-kix_cusljwgpdnue-2{list-style-type:none}ul.lst-kix_cusljwgpdnue-3{list-style-type:none}ul.lst-kix_cusljwgpdnue-4{list-style-type:none}ul.lst-kix_cusljwgpdnue-5{list-style-type:none}ul.lst-kix_cusljwgpdnue-0{list-style-type:none}ul.lst-kix_cusljwgpdnue-1{list-style-type:none}.lst-kix_n3uzf8eo1li-6>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-6,decimal) ". "}ul.lst-kix_6yzovysci6f0-0{list-style-type:none}ul.lst-kix_6yzovysci6f0-1{list-style-type:none}.lst-kix_n3uzf8eo1li-5>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-5,lower-roman) ". "}.lst-kix_n3uzf8eo1li-7>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-7,lower-latin) ". "}ul.lst-kix_6yzovysci6f0-2{list-style-type:none}ul.lst-kix_6yzovysci6f0-3{list-style-type:none}ol.lst-kix_n3uzf8eo1li-0{list-style-type:none}.lst-kix_n3uzf8eo1li-4>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-4,lower-latin) ". "}.lst-kix_n3uzf8eo1li-8>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-8,lower-roman) ". "}ul.lst-kix_6yzovysci6f0-4{list-style-type:none}ul.lst-kix_6yzovysci6f0-5{list-style-type:none}ol.lst-kix_n3uzf8eo1li-2{list-style-type:none}ul.lst-kix_6yzovysci6f0-6{list-style-type:none}ol.lst-kix_n3uzf8eo1li-1{list-style-type:none}ol.lst-kix_n3uzf8eo1li-1.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-1 0}ul.lst-kix_6yzovysci6f0-7{list-style-type:none}ol.lst-kix_n3uzf8eo1li-4{list-style-type:none}ul.lst-kix_6yzovysci6f0-8{list-style-type:none}ol.lst-kix_n3uzf8eo1li-3{list-style-type:none}ol.lst-kix_n3uzf8eo1li-6{list-style-type:none}ol.lst-kix_n3uzf8eo1li-5{list-style-type:none}ol.lst-kix_n3uzf8eo1li-8{list-style-type:none}ol.lst-kix_n3uzf8eo1li-7{list-style-type:none}.lst-kix_n3uzf8eo1li-0>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-0,decimal) ". "}ul.lst-kix_um77phknmrlo-5{list-style-type:none}.lst-kix_n3uzf8eo1li-2>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-2,lower-roman) ". "}ul.lst-kix_um77phknmrlo-4{list-style-type:none}ul.lst-kix_um77phknmrlo-3{list-style-type:none}.lst-kix_n3uzf8eo1li-1>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-1,lower-latin) ". "}.lst-kix_n3uzf8eo1li-3>li:before{content:"" counter(lst-ctn-kix_n3uzf8eo1li-3,decimal) ". "}ul.lst-kix_um77phknmrlo-2{list-style-type:none}ul.lst-kix_um77phknmrlo-1{list-style-type:none}ul.lst-kix_um77phknmrlo-0{list-style-type:none}.lst-kix_v8xosipxsbka-6>li{counter-increment:lst-ctn-kix_v8xosipxsbka-6}.lst-kix_v8xosipxsbka-7>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-7,lower-latin) ". "}.lst-kix_v8xosipxsbka-8>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-8,lower-roman) ". "}ul.lst-kix_tn0191gt6puu-8{list-style-type:none}ul.lst-kix_tn0191gt6puu-7{list-style-type:none}.lst-kix_v8xosipxsbka-4>li{counter-increment:lst-ctn-kix_v8xosipxsbka-4}ol.lst-kix_v8xosipxsbka-5.start{counter-reset:lst-ctn-kix_v8xosipxsbka-5 0}.lst-kix_v8xosipxsbka-3>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-3,decimal) ". "}.lst-kix_v8xosipxsbka-2>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-2,lower-roman) ". "}.lst-kix_n3uzf8eo1li-8>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-8}.lst-kix_um77phknmrlo-7>li:before{content:"\0025cb  "}.lst-kix_cusljwgpdnue-4>li:before{content:"\0025cb  "}.lst-kix_cusljwgpdnue-2>li:before{content:"\0025a0  "}.lst-kix_cusljwgpdnue-3>li:before{content:"\0025cf  "}.lst-kix_um77phknmrlo-8>li:before{content:"\0025a0  "}.lst-kix_v8xosipxsbka-4>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-4,lower-latin) ". "}.lst-kix_cusljwgpdnue-0>li:before{content:"\0025cf  "}.lst-kix_cusljwgpdnue-1>li:before{content:"\0025cb  "}.lst-kix_v8xosipxsbka-5>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-5,lower-roman) ". "}.lst-kix_v8xosipxsbka-6>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-6,decimal) ". "}ol.lst-kix_v8xosipxsbka-6.start{counter-reset:lst-ctn-kix_v8xosipxsbka-6 0}.lst-kix_um77phknmrlo-0>li:before{content:"\0025cf  "}.lst-kix_um77phknmrlo-5>li:before{content:"\0025a0  "}.lst-kix_um77phknmrlo-6>li:before{content:"\0025cf  "}.lst-kix_v8xosipxsbka-0>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-0,decimal) ". "}.lst-kix_cusljwgpdnue-5>li:before{content:"\0025a0  "}.lst-kix_v8xosipxsbka-1>li:before{content:"" counter(lst-ctn-kix_v8xosipxsbka-1,decimal) ". "}.lst-kix_cusljwgpdnue-6>li:before{content:"\0025cf  "}.lst-kix_cusljwgpdnue-7>li:before{content:"\0025cb  "}.lst-kix_um77phknmrlo-4>li:before{content:"\0025cb  "}.lst-kix_n3uzf8eo1li-2>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-2}.lst-kix_um77phknmrlo-3>li:before{content:"\0025cf  "}.lst-kix_cusljwgpdnue-8>li:before{content:"\0025a0  "}.lst-kix_um77phknmrlo-1>li:before{content:"\0025cb  "}.lst-kix_um77phknmrlo-2>li:before{content:"\0025a0  "}.lst-kix_95sevrxkprfi-1>li:before{content:"\0025cb  "}.lst-kix_blj2coi71pzr-8>li:before{content:"\0025a0  "}ol.lst-kix_v8xosipxsbka-7.start{counter-reset:lst-ctn-kix_v8xosipxsbka-7 0}.lst-kix_ufntig3hm39o-8>li:before{content:"\0025a0  "}ol.lst-kix_n3uzf8eo1li-5.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-5 0}.lst-kix_95sevrxkprfi-5>li:before{content:"\0025a0  "}.lst-kix_blj2coi71pzr-6>li:before{content:"\0025cf  "}.lst-kix_ufntig3hm39o-6>li:before{content:"\0025cf  "}.lst-kix_95sevrxkprfi-3>li:before{content:"\0025cf  "}.lst-kix_ufntig3hm39o-4>li:before{content:"\0025cb  "}ul.lst-kix_ufntig3hm39o-7{list-style-type:none}.lst-kix_blj2coi71pzr-2>li:before{content:"\0025a0  "}ul.lst-kix_ufntig3hm39o-8{list-style-type:none}.lst-kix_blj2coi71pzr-0>li:before{content:"\0025cf  "}ul.lst-kix_ufntig3hm39o-5{list-style-type:none}ul.lst-kix_ufntig3hm39o-6{list-style-type:none}ul.lst-kix_ufntig3hm39o-3{list-style-type:none}ul.lst-kix_ufntig3hm39o-4{list-style-type:none}ul.lst-kix_ufntig3hm39o-1{list-style-type:none}ul.lst-kix_ufntig3hm39o-2{list-style-type:none}.lst-kix_blj2coi71pzr-4>li:before{content:"\0025cb  "}ul.lst-kix_ufntig3hm39o-0{list-style-type:none}.lst-kix_ufntig3hm39o-2>li:before{content:"\0025a0  "}.lst-kix_5ngydqhorp5b-7>li:before{content:"\0025cb  "}.lst-kix_5ngydqhorp5b-5>li:before{content:"\0025a0  "}.lst-kix_ufntig3hm39o-0>li:before{content:"\0025cf  "}ol.lst-kix_n3uzf8eo1li-8.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-8 0}.lst-kix_5ngydqhorp5b-3>li:before{content:"\0025cf  "}.lst-kix_v8xosipxsbka-0>li{counter-increment:lst-ctn-kix_v8xosipxsbka-0}.lst-kix_5ngydqhorp5b-1>li:before{content:"\0025cb  "}.lst-kix_95sevrxkprfi-7>li:before{content:"\0025cb  "}.lst-kix_umz3zpfy9ii-2>li:before{content:"\0025a0  "}.lst-kix_xu6ruwdw8b4r-0>li:before{content:"\0025cf  "}.lst-kix_xu6ruwdw8b4r-2>li:before{content:"\0025a0  "}ol.lst-kix_n3uzf8eo1li-7.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-7 0}.lst-kix_umz3zpfy9ii-8>li:before{content:"\0025a0  "}.lst-kix_n3uzf8eo1li-3>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-3}.lst-kix_umz3zpfy9ii-0>li:before{content:"\0025cf  "}.lst-kix_6yzovysci6f0-8>li:before{content:"\0025a0  "}.lst-kix_xu6ruwdw8b4r-8>li:before{content:"\0025a0  "}.lst-kix_kdw8t6qe68pi-5>li:before{content:"\0025a0  "}.lst-kix_6yzovysci6f0-2>li:before{content:"\0025a0  "}.lst-kix_6yzovysci6f0-6>li:before{content:"\0025cf  "}.lst-kix_umz3zpfy9ii-6>li:before{content:"\0025cf  "}.lst-kix_kdw8t6qe68pi-7>li:before{content:"\0025cb  "}.lst-kix_xu6ruwdw8b4r-4>li:before{content:"\0025cb  "}.lst-kix_xu6ruwdw8b4r-6>li:before{content:"\0025cf  "}.lst-kix_umz3zpfy9ii-4>li:before{content:"\0025cb  "}.lst-kix_n3uzf8eo1li-4>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-4}.lst-kix_6yzovysci6f0-4>li:before{content:"\0025cb  "}ol.lst-kix_n3uzf8eo1li-6.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-6 0}.lst-kix_v8xosipxsbka-5>li{counter-increment:lst-ctn-kix_v8xosipxsbka-5}.lst-kix_6yzovysci6f0-0>li:before{content:"\0025cf  "}ul.lst-kix_95sevrxkprfi-7{list-style-type:none}ul.lst-kix_95sevrxkprfi-8{list-style-type:none}ul.lst-kix_95sevrxkprfi-1{list-style-type:none}ul.lst-kix_95sevrxkprfi-2{list-style-type:none}ul.lst-kix_95sevrxkprfi-0{list-style-type:none}ul.lst-kix_95sevrxkprfi-5{list-style-type:none}ul.lst-kix_95sevrxkprfi-6{list-style-type:none}ul.lst-kix_95sevrxkprfi-3{list-style-type:none}ul.lst-kix_95sevrxkprfi-4{list-style-type:none}.lst-kix_ls68zeel5k8h-0>li:before{content:"\0025cf  "}.lst-kix_v8xosipxsbka-7>li{counter-increment:lst-ctn-kix_v8xosipxsbka-7}.lst-kix_ls68zeel5k8h-1>li:before{content:"\0025cb  "}ul.lst-kix_ls68zeel5k8h-4{list-style-type:none}ul.lst-kix_ls68zeel5k8h-5{list-style-type:none}.lst-kix_2utjbsp2ayf-4>li:before{content:"\0025cb  "}ul.lst-kix_ls68zeel5k8h-6{list-style-type:none}ul.lst-kix_ls68zeel5k8h-7{list-style-type:none}ul.lst-kix_ls68zeel5k8h-0{list-style-type:none}ul.lst-kix_ls68zeel5k8h-1{list-style-type:none}.lst-kix_2utjbsp2ayf-5>li:before{content:"\0025a0  "}.lst-kix_2utjbsp2ayf-6>li:before{content:"\0025cf  "}ul.lst-kix_ls68zeel5k8h-2{list-style-type:none}ul.lst-kix_ls68zeel5k8h-3{list-style-type:none}.lst-kix_2utjbsp2ayf-7>li:before{content:"\0025cb  "}.lst-kix_2utjbsp2ayf-8>li:before{content:"\0025a0  "}ul.lst-kix_ls68zeel5k8h-8{list-style-type:none}.lst-kix_n3uzf8eo1li-7>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-7}.lst-kix_tn0191gt6puu-0>li:before{content:"\0025cf  "}.lst-kix_tn0191gt6puu-2>li:before{content:"\0025a0  "}.lst-kix_tn0191gt6puu-1>li:before{content:"\0025cf  "}.lst-kix_ls68zeel5k8h-7>li:before{content:"\0025cb  "}ol.lst-kix_v8xosipxsbka-8.start{counter-reset:lst-ctn-kix_v8xosipxsbka-8 0}.lst-kix_ls68zeel5k8h-8>li:before{content:"\0025a0  "}.lst-kix_tn0191gt6puu-6>li:before{content:"\0025cf  "}.lst-kix_kdw8t6qe68pi-4>li:before{content:"\0025cb  "}.lst-kix_tn0191gt6puu-7>li:before{content:"\0025cb  "}.lst-kix_kdw8t6qe68pi-2>li:before{content:"\0025a0  "}.lst-kix_kdw8t6qe68pi-3>li:before{content:"\0025cf  "}.lst-kix_ls68zeel5k8h-2>li:before{content:"\0025a0  "}.lst-kix_ls68zeel5k8h-4>li:before{content:"\0025cb  "}.lst-kix_kdw8t6qe68pi-1>li:before{content:"\0025cb  "}.lst-kix_ls68zeel5k8h-3>li:before{content:"\0025cf  "}.lst-kix_tn0191gt6puu-5>li:before{content:"\0025a0  "}.lst-kix_ls68zeel5k8h-6>li:before{content:"\0025cf  "}.lst-kix_tn0191gt6puu-4>li:before{content:"\0025cb  "}.lst-kix_kdw8t6qe68pi-0>li:before{content:"\0025cf  "}.lst-kix_ls68zeel5k8h-5>li:before{content:"\0025a0  "}.lst-kix_tn0191gt6puu-3>li:before{content:"\0025cf  "}ol.lst-kix_n3uzf8eo1li-4.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-4 0}.lst-kix_tn0191gt6puu-8>li:before{content:"\0025a0  "}.lst-kix_5ngydqhorp5b-8>li:before{content:"\0025a0  "}.lst-kix_n3uzf8eo1li-5>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-5}.lst-kix_2utjbsp2ayf-3>li:before{content:"\0025cf  "}.lst-kix_2utjbsp2ayf-1>li:before{content:"\0025cb  "}.lst-kix_2utjbsp2ayf-2>li:before{content:"\0025a0  "}ol.lst-kix_n3uzf8eo1li-3.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-3 0}.lst-kix_2utjbsp2ayf-0>li:before{content:"\0025cf  "}ul.lst-kix_5ngydqhorp5b-0{list-style-type:none}.lst-kix_95sevrxkprfi-2>li:before{content:"\0025a0  "}ul.lst-kix_5ngydqhorp5b-2{list-style-type:none}ul.lst-kix_5ngydqhorp5b-1{list-style-type:none}ul.lst-kix_5ngydqhorp5b-4{list-style-type:none}ul.lst-kix_5ngydqhorp5b-3{list-style-type:none}ul.lst-kix_5ngydqhorp5b-6{list-style-type:none}ul.lst-kix_5ngydqhorp5b-5{list-style-type:none}.lst-kix_blj2coi71pzr-5>li:before{content:"\0025a0  "}.lst-kix_ufntig3hm39o-7>li:before{content:"\0025cb  "}.lst-kix_blj2coi71pzr-7>li:before{content:"\0025cb  "}.lst-kix_n3uzf8eo1li-0>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-0}.lst-kix_95sevrxkprfi-4>li:before{content:"\0025cb  "}ol.lst-kix_v8xosipxsbka-0{list-style-type:none}.lst-kix_blj2coi71pzr-1>li:before{content:"\0025cb  "}.lst-kix_ufntig3hm39o-3>li:before{content:"\0025cf  "}ol.lst-kix_v8xosipxsbka-2{list-style-type:none}ol.lst-kix_v8xosipxsbka-1{list-style-type:none}.lst-kix_ufntig3hm39o-1>li:before{content:"\0025cb  "}.lst-kix_ufntig3hm39o-5>li:before{content:"\0025a0  "}ol.lst-kix_v8xosipxsbka-8{list-style-type:none}ul.lst-kix_5ngydqhorp5b-8{list-style-type:none}ol.lst-kix_n3uzf8eo1li-2.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-2 0}ol.lst-kix_v8xosipxsbka-7{list-style-type:none}ul.lst-kix_5ngydqhorp5b-7{list-style-type:none}.lst-kix_n3uzf8eo1li-1>li{counter-increment:lst-ctn-kix_n3uzf8eo1li-1}.lst-kix_5ngydqhorp5b-6>li:before{content:"\0025cf  "}.lst-kix_v8xosipxsbka-1>li{counter-increment:lst-ctn-kix_v8xosipxsbka-1}ol.lst-kix_v8xosipxsbka-4{list-style-type:none}.lst-kix_blj2coi71pzr-3>li:before{content:"\0025cf  "}ol.lst-kix_v8xosipxsbka-3{list-style-type:none}.lst-kix_95sevrxkprfi-0>li:before{content:"\0025cf  "}ol.lst-kix_v8xosipxsbka-6{list-style-type:none}ol.lst-kix_v8xosipxsbka-5{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-1{list-style-type:none}ol.lst-kix_v8xosipxsbka-1.start{counter-reset:lst-ctn-kix_v8xosipxsbka-1 0}ul.lst-kix_xu6ruwdw8b4r-2{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-0{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-5{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-6{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-3{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-4{list-style-type:none}.lst-kix_5ngydqhorp5b-4>li:before{content:"\0025cb  "}ul.lst-kix_kdw8t6qe68pi-7{list-style-type:none}ol.lst-kix_v8xosipxsbka-4.start{counter-reset:lst-ctn-kix_v8xosipxsbka-4 0}ul.lst-kix_kdw8t6qe68pi-6{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-7{list-style-type:none}ul.lst-kix_xu6ruwdw8b4r-8{list-style-type:none}ul.lst-kix_kdw8t6qe68pi-8{list-style-type:none}ul.lst-kix_kdw8t6qe68pi-3{list-style-type:none}ul.lst-kix_kdw8t6qe68pi-2{list-style-type:none}.lst-kix_5ngydqhorp5b-0>li:before{content:"\0025cf  "}ul.lst-kix_kdw8t6qe68pi-5{list-style-type:none}.lst-kix_v8xosipxsbka-3>li{counter-increment:lst-ctn-kix_v8xosipxsbka-3}.lst-kix_5ngydqhorp5b-2>li:before{content:"\0025a0  "}ul.lst-kix_kdw8t6qe68pi-4{list-style-type:none}ul.lst-kix_kdw8t6qe68pi-1{list-style-type:none}ul.lst-kix_kdw8t6qe68pi-0{list-style-type:none}ul.lst-kix_tn0191gt6puu-6{list-style-type:none}ul.lst-kix_tn0191gt6puu-5{list-style-type:none}.lst-kix_95sevrxkprfi-6>li:before{content:"\0025cf  "}ul.lst-kix_tn0191gt6puu-4{list-style-type:none}ul.lst-kix_tn0191gt6puu-3{list-style-type:none}ul.lst-kix_tn0191gt6puu-2{list-style-type:none}ul.lst-kix_tn0191gt6puu-1{list-style-type:none}.lst-kix_95sevrxkprfi-8>li:before{content:"\0025a0  "}ul.lst-kix_tn0191gt6puu-0{list-style-type:none}.lst-kix_xu6ruwdw8b4r-1>li:before{content:"\0025cb  "}.lst-kix_umz3zpfy9ii-3>li:before{content:"\0025cf  "}.lst-kix_xu6ruwdw8b4r-3>li:before{content:"\0025cf  "}.lst-kix_umz3zpfy9ii-7>li:before{content:"\0025cb  "}.lst-kix_6yzovysci6f0-7>li:before{content:"\0025cb  "}.lst-kix_umz3zpfy9ii-1>li:before{content:"\0025cb  "}ol.lst-kix_n3uzf8eo1li-0.start{counter-reset:lst-ctn-kix_n3uzf8eo1li-0 0}.lst-kix_6yzovysci6f0-1>li:before{content:"\0025cb  "}.lst-kix_6yzovysci6f0-3>li:before{content:"\0025cf  "}.lst-kix_xu6ruwdw8b4r-7>li:before{content:"\0025cb  "}.lst-kix_xu6ruwdw8b4r-5>li:before{content:"\0025a0  "}.lst-kix_kdw8t6qe68pi-6>li:before{content:"\0025cf  "}.lst-kix_umz3zpfy9ii-5>li:before{content:"\0025a0  "}.lst-kix_6yzovysci6f0-5>li:before{content:"\0025a0  "}.lst-kix_kdw8t6qe68pi-8>li:before{content:"\0025a0  "}ol.lst-kix_v8xosipxsbka-2.start{counter-reset:lst-ctn-kix_v8xosipxsbka-2 0}ul.lst-kix_umz3zpfy9ii-2{list-style-type:none}ul.lst-kix_umz3zpfy9ii-3{list-style-type:none}ul.lst-kix_umz3zpfy9ii-4{list-style-type:none}ul.lst-kix_umz3zpfy9ii-5{list-style-type:none}ul.lst-kix_cusljwgpdnue-6{list-style-type:none}.lst-kix_v8xosipxsbka-8>li{counter-increment:lst-ctn-kix_v8xosipxsbka-8}ul.lst-kix_umz3zpfy9ii-6{list-style-type:none}ul.lst-kix_blj2coi71pzr-7{list-style-type:none}ul.lst-kix_cusljwgpdnue-7{list-style-type:none}ul.lst-kix_umz3zpfy9ii-7{list-style-type:none}ul.lst-kix_blj2coi71pzr-6{list-style-type:none}ul.lst-kix_cusljwgpdnue-8{list-style-type:none}ul.lst-kix_umz3zpfy9ii-8{list-style-type:none}ul.lst-kix_blj2coi71pzr-8{list-style-type:none}ul.lst-kix_blj2coi71pzr-3{list-style-type:none}ul.lst-kix_blj2coi71pzr-2{list-style-type:none}ul.lst-kix_blj2coi71pzr-5{list-style-type:none}ul.lst-kix_blj2coi71pzr-4{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ul.lst-kix_umz3zpfy9ii-0{list-style-type:none}ul.lst-kix_blj2coi71pzr-1{list-style-type:none}.lst-kix_v8xosipxsbka-2>li{counter-increment:lst-ctn-kix_v8xosipxsbka-2}ul.lst-kix_umz3zpfy9ii-1{list-style-type:none}ul.lst-kix_blj2coi71pzr-0{list-style-type:none}ol.lst-kix_v8xosipxsbka-3.start{counter-reset:lst-ctn-kix_v8xosipxsbka-3 0}ol{margin:0;padding:0}table td,table th{padding:0}.c27{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:-30pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;margin-left:30pt;text-indent:-30pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c16{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:-9.8pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;margin-left:10pt;text-indent:-10pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c4{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c18{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c39{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:center;padding-right:0pt}.c11{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c13{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:90pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c24{margin-left:108pt;padding-top:18pt;padding-left:0pt;padding-bottom:114pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c15{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:42pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c0{background-color:#eef2f6;-webkit-text-decoration-skip:none;color:#188038;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Courier New"}.c1{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Times New Roman";font-style:normal}.c3{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Times New Roman";font-style:normal}.c14{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman"}.c36{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:66pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c10{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:114pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c25{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:10.5pt;font-family:"Times New Roman"}.c22{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman"}.c41{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c30{padding-top:48pt;padding-bottom:96pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c33{color:#005f8b;font-weight:400;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c5{padding-top:48pt;padding-bottom:144pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c29{padding-top:48pt;padding-bottom:120pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c21{background-color:#ffffff;font-size:10.5pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c8{background-color:#ffffff;font-size:10.5pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c9{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:12pt;font-family:"Times New Roman"}.c17{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c2{background-color:#ffffff;font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c23{background-color:#eef2f6;font-size:10.5pt;font-family:"Courier New";color:#188038;font-weight:400}.c32{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:16pt;font-family:"Times New Roman"}.c19{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:25pt;font-family:"Times New Roman"}.c7{background-color:#ffffff;color:#3d3b49;font-weight:400;font-size:9pt;font-family:"Times New Roman"}.c35{color:#3d3b49;font-weight:400;font-size:43pt;font-family:"Times New Roman"}.c31{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c38{font-size:10.5pt;font-family:"Courier New";color:#3d3b49;font-weight:400}.c6{text-decoration:none;vertical-align:baseline;font-style:normal}.c26{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none}.c20{padding:0;margin:0}.c12{color:inherit;text-decoration:inherit}.c37{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c34{background-color:#ffffff}.c28{font-style:italic}.c40{background-color:#b2d6e7}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c34 c37 doc-content"><p class="c34 c39"><span class="c26 c33">Chapter 14</span></p><h1 class="c4 c34" id="h.wymf3y585biz"><span class="c6 c35">Communication and Messaging Systems</span></h1><p class="c16"><span class="c2 c6">IN THIS CHAPTER</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;</span><span class="c9 c6">Attacking email systems</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;</span><span class="c9 c6">Assailing instant messaging</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;</span><span class="c9 c6">Assaulting Voice over IP applications</span></p><p class="c11"><span class="c2 c6">Communication systems and protocols such as email and Voice over Internet Protocol (VoIP) often create vulnerabilities that people overlook. Why? Well, in my experience, communications software &mdash; at both the server and client levels &mdash; is vulnerable because network administrators often believe that firewalls and antimalware software are all they need to keep trouble away, or they simply forget about securing these systems.</span></p><p class="c11"><span class="c2 c6">In this chapter, I show you how to test for common email and VoIP issues. I also outline key countermeasures to help prevent these hacks against your systems.</span></p><h2 class="c4" id="h.2as9cnam3381"><span class="c6 c19">Introducing Messaging System Vulnerabilities</span></h2><p class="c11"><span class="c2 c6">Practically all messaging applications are hacking targets on your network. Given the proliferation of and business dependence on email, just about anything is fair game. Ditto with VoIP. It&rsquo;s downright scary what people with ill intent can do with these tools.</span></p><p class="c11"><span class="c2">With messaging systems, one underlying weakness is that many of the supporting protocols weren&rsquo;t designed with security in mind &mdash; especially those developed several decades ago when security wasn&rsquo;t nearly the issue it is today. The funny thing is that even modern-day messaging protocols &mdash; or at least the implementation of the protocols &mdash; are </span><span class="c2 c28">still</span><span class="c2 c6">&nbsp;susceptible to serious security problems. Furthermore, convenience and usability often outweigh the need for security.</span></p><p class="c11"><span class="c2 c6">Many attacks against messaging systems are minor nuisances; others can inflict serious harm on your information and your organization&rsquo;s reputation. Malicious attacks against messaging systems include the following:</span></p><ul class="c20 lst-kix_5ngydqhorp5b-0 start"><li class="c15 li-bullet-0"><span class="c1">Transmitting malware</span></li><li class="c15 li-bullet-0"><span class="c1">Crashing servers</span></li><li class="c15 li-bullet-0"><span class="c1">Obtaining remote control of workstations</span></li><li class="c15 li-bullet-0"><span class="c1">Capturing information while it travels across the network</span></li><li class="c15 li-bullet-0"><span class="c1">Perusing emails stored on servers and workstations</span></li><li class="c15 li-bullet-0"><span class="c1">Gathering messaging-trend information via log files or a network analyzer that can tip off the attacker about conversations between people and organizations (often called traffic analysis or social network analysis)</span></li><li class="c15 li-bullet-0"><span class="c1">Capturing and replaying phone conversations</span></li><li class="c15 li-bullet-0"><span class="c1">Gathering internal network configuration information, such as hostnames and IP addresses</span></li></ul><p class="c11"><span class="c2 c6">These attacks can lead to such problems as unauthorized &mdash; and potentially illegal &mdash; disclosure of sensitive information, as well as loss of information.</span></p><h2 class="c4" id="h.6w709fb5i4b0"><span class="c19 c6">Recognizing and Countering Email Attacks</span></h2><p class="c11"><span class="c2 c6">The attacks I describe in this section exploit the most common email security vulnerabilities I&rsquo;ve seen. The good news is that you can eliminate or minimize most of them to the point where your information isn&rsquo;t at risk. Some of these attacks require basic hacking methodologies: gathering public information, scanning and enumerating your systems, and finding and exploiting vulnerabilities. Other attacks can be carried out by sending emails or capturing network traffic.</span></p><h3 class="c4" id="h.35tuowj3ak3p"><span class="c6 c32">Email bombs</span></h3><p class="c11"><span class="c2 c28">Email bombs</span><span class="c2 c6">&nbsp;attack by creating denial of service (DoS) conditions against your email software and even your network and Internet connections by taking up a large amount of bandwidth and sometimes requiring large amounts of storage space. Email bombs can crash a server and provide unauthorized administrator access &mdash; yes, even with today&rsquo;s seemingly endless storage capacities.</span></p><h4 class="c4" id="h.z9jj5i1v6zg6"><span class="c9 c6">Attachments</span></h4><p class="c11"><span class="c2 c6">An attacker can create an attachment-overload attack by sending hundreds or thousands of emails with very large attachments to one or more recipients on your network.</span></p><h4 class="c4" id="h.7o5ij75mqhzz"><span class="c9 c6">ATTACKS USING EMAIL ATTACHMENTS</span></h4><p class="c11"><span class="c2 c6">Attachment attacks have a couple of goals:</span></p><ul class="c20 lst-kix_tn0191gt6puu-0 start"><li class="c10 li-bullet-0"><span class="c21">The email server may be targeted</span><span class="c1">&nbsp;for a complete interruption of service with these failures:</span></li></ul><ul class="c20 lst-kix_tn0191gt6puu-1 start"><li class="c24 li-bullet-0"><span class="c8 c28">Storage overload:</span><span class="c8">&nbsp;Multiple large messages can quickly fill the total storage capacity of an email server &ndash; even if your email service is based in the cloud. If the messages aren&rsquo;t automatically deleted by the server or manually deleted by individual user accounts, the server will be unable to receive new messages.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c1">&nbsp;This attack can create a significant DoS problem for your email system, either crashing it or requiring you to take your system offline to clean up the junk that has accumulated. A 100MB file attachment sent 10 times to 100 users can take 100GB of storage space, which can add up!</span></li><li class="c24 li-bullet-0"><span class="c8 c28">Bandwidth blocking:</span><span class="c1">&nbsp;An attacker can crash your email service or bring it to a crawl by filling the incoming Internet connection with junk. Even if your system automatically identifies and discards obvious attachment attacks, the bogus messages eat resources and delay the processing of valid messages.</span></li></ul><ul class="c20 lst-kix_tn0191gt6puu-0"><li class="c10 li-bullet-0"><span class="c21">An attack on a single email address</span><span class="c1">&nbsp;can have serious consequences if the address is for an important user or group.</span></li></ul><h4 class="c4" id="h.6l7vvj7s5nto"><span class="c9 c6">COUNTERMEASURES AGAINST EMAIL ATTACHMENT ATTACKS</span></h4><p class="c11"><span class="c2 c6">These countermeasures can help prevent attachment-overload attacks:</span></p><ul class="c20 lst-kix_xu6ruwdw8b4r-0 start"><li class="c10 li-bullet-0"><span class="c21">Limit the size of emails or email attachments.</span><span class="c1">&nbsp;Check for this option in your email server&rsquo;s configuration settings (such as those provided in Microsoft 365), in your email content filtering system, and even at the email client level.</span></li><li class="c10 li-bullet-0"><span class="c21">Limit each user&rsquo;s space on the server or in the cloud.</span><span class="c8">&nbsp;This countermeasure denies large attachments from being written to disk. Limit message sizes for inbound and even outbound messages if you want to prevent a user from launching this attack from inside your network. I find that a few gigabytes is a good limit, but the limit depends on your network size, storage availability, business culture, and so on. Think through this limit carefully before putting one in place.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c1">&nbsp;Consider using SFTP, FTPS, or HTTPS instead of email for large file transfers. Numerous cloud-based file transfer services are available, such as Dropbox for Business, OneDrive for Business, and Sharefile. You can also encourage your users to use departmental shares or public folders. By doing so, you can store one copy of the file on a server and have the recipient download the file on their own workstation.</span></li></ul><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Contrary to popular belief and use, the email system should </span><span class="c2 c28">not</span><span class="c2 c6">&nbsp;be an information repository, but that&rsquo;s unfortunately what email has evolved into. An email server used for this purpose can create unnecessary legal and regulatory risks and can turn into a huge nightmare if your business receives an e-discovery request related to a lawsuit. An important part of your security program is developing an information classification and retention program to help with records management. But don&rsquo;t go it alone. Get others such as your lawyer, human resources manager, and chief information officer involved. This practice can help ensure that the right people are on board and that your business doesn&rsquo;t get into trouble for holding too many &mdash; or too few &mdash; electronic records in the event of a lawsuit or investigation.</span></p><h4 class="c4" id="h.z0molvqek02t"><span class="c9 c6">Connections</span></h4><p class="c11"><span class="c2 c6">A hacker can send a huge number of emails simultaneously to your email system. Malware that&rsquo;s present on your network can do the same thing from inside your network if your network has an open Simple Mail Transfer Protocol (SMTP) relay. These connection attacks can cause the server to give up on servicing any inbound or outbound Transmission Control Protocol (TCP) requests. This situation can lead to a server lockup or a crash, often resulting in a condition in which the attacker is allowed administrator or root access to the system.</span></p><h4 class="c4" id="h.y0yb8g6q9dk0"><span class="c6 c9">ATTACKS USING FLOODS OF EMAILS</span></h4><p class="c11"><span class="c2 c6">An attack using a flood of emails is often carried out in spam attacks and other DoS attacks.</span></p><h4 class="c4" id="h.5zt5x51tsqdn"><span class="c9 c6">COUNTERMEASURES AGAINST CONNECTION ATTACKS</span></h4><p class="c11"><span class="c2 c6">Prevent email attacks as far out on your network perimeter as you can, ideally in the cloud. The more traffic or malicious behavior you keep off your email servers and clients the better.</span></p><p class="c11"><span class="c2">Many email servers allow you to limit the number of resources used for inbound connections, as shown in the Maximum Number of Simultaneous Threads setting for the IceWarp email server in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0001&amp;sa=D&amp;source=editors&amp;ust=1681141892201490&amp;usg=AOvVaw1eOGe1J9AQaqppi7yLuRnN">Figure 14-1</a></span><span class="c2 c6">. This setting is called different things for different email servers and firewalls, so check your documentation. Completely stopping an unlimited number of inbound requests can be impossible, but you can minimize the impact of the attack. This setting limits the amount of server processor time which can help during a DoS attack.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 422.67px;"><img alt="Snapshot shows Limiting the number of resources that handle inbound messages." src="images/image17.png" style="width: 580.00px; height: 422.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0001&amp;sa=D&amp;source=editors&amp;ust=1681141892202143&amp;usg=AOvVaw3qhpdU9IYqE5ZLB4y_U7lF">FIGURE 14-1:</a></span><span class="c7 c6">&nbsp;Limiting the number of resources that handle inbound messages.</span></p><p class="c11"><span class="c2 c6">Even in large companies, or if you&rsquo;re using a cloud-based email service such as Google Workspace or Microsoft 365, there&rsquo;s likely no reason why thousands of inbound email deliveries should be necessary within a short period. Actually, when this happens, it can put a temporary suspension on impacted accounts.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Email servers can be programmed to deliver emails to a service for automated functions such as </span><span class="c2 c28">create this e-commerce order when a message from this account is received.</span><span class="c2">&nbsp;If DoS protection isn&rsquo;t built into the system, an attacker can crash both the server and the application that receives these messages, potentially creating e-commerce liabilities and losses. This type of attack can happen more easily on e-commerce websites when CAPTCHA (short for Completely Automated Public Turing test to tell Computers and Humans Apart) isn&rsquo;t used on web forms. This can be problematic when you&rsquo;re performing web vulnerability scans against forms that are tied to email addresses on the back end. It&rsquo;s not unusual for this situation to generate thousands, often tens of thousands, of emails. It pays to be prepared and to let those involved know that the risk exists. I cover web application security in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c15.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141892203015&amp;usg=AOvVaw0pDjB5f5aORmOk12wUteg6">Chapter 15</a></span><span class="c2 c6">.</span></p><h4 class="c4" id="h.ns3ljw9ring"><span class="c9 c6">Automated email security controls</span></h4><p class="c11"><span class="c2 c6">You can implement the following countermeasures as an additional layer of security for your email systems:</span></p><ul class="c20 lst-kix_cusljwgpdnue-0 start"><li class="c13 li-bullet-0"><span class="c21">Tarpitting:</span><span class="c8">&nbsp;</span><span class="c8 c28">Tarpitting</span><span class="c1">&nbsp;detects inbound messages destined for unknown users. If your email server supports tarpitting, it can help prevent spam or DoS attacks against your server. If a predefined threshold is exceeded &mdash; say, more than 100 messages in one minute &mdash; the tarpitting function effectively shuns traffic from the sending IP address for a given period.</span></li><li class="c13 li-bullet-0"><span class="c21">Email firewalls:</span><span class="c1">&nbsp;Email firewalls and content-filtering applications from vendors such as Symantec and Barracuda Networks can go a long way toward preventing various email attacks. These tools protect practically every aspect of an email system.</span></li><li class="c13 li-bullet-0"><span class="c21">Perimeter protection:</span><span class="c1">&nbsp;Although not email-specific, many firewall and intrusion prevention systems can detect various email attacks and shut off the attacker in real-time, which can come in handy during an attack.</span></li><li class="c13 li-bullet-0"><span class="c21">CAPTCHA:</span><span class="c8">&nbsp;Using CAPTCHA on web-based email forms can help minimize the impact of automated attacks and lessen your chances of email flooding and DoS, even when you&rsquo;re performing seemingly benign web vulnerability scans. These benefits really come in handy when you test your websites and applications, as I discuss in </span><span class="c25"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c15.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141892204765&amp;usg=AOvVaw1tI7sZnMARcejyYMsJOTiN">Chapter 15</a></span><span class="c1">.</span></li></ul><h3 class="c4" id="h.rjzbsyy41z91"><span class="c32 c6">Banners</span></h3><p class="c11"><span class="c2 c6">When exploiting an email server, a hacker&rsquo;s first order of business is performing a basic banner grab to see whether they can discover what email server software is running. This test is one of the most critical tests to find out what the world knows about your SMTP, POP3, and IMAP servers.</span></p><h4 class="c4" id="h.8wcqsk56ljcr"><span class="c9 c6">Gathering information</span></h4><p class="c11"><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0002&amp;sa=D&amp;source=editors&amp;ust=1681141892205950&amp;usg=AOvVaw1WlDWqB21EG4ZF3FQ5LzLt">Figure 14-2</a></span><span class="c2">&nbsp;shows the banner displayed on an email server when a basic Telnet connection is made on port 25 (SMTP). To do this, at a command prompt, simply enter </span><span class="c9">telnet </span><span class="c9 c28">ip or_hostname_of_your_server</span><span class="c9">&nbsp;25</span><span class="c2 c6">. This command opens a Telnet session on TCP port 25.</span></p><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 142.67px;"><img alt="Snapshot shows an SMTP banner showing server-version information." src="images/image14.png" style="width: 580.00px; height: 142.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0002&amp;sa=D&amp;source=editors&amp;ust=1681141892206672&amp;usg=AOvVaw3SOWqGXL2T5icx4yBafpB0">FIGURE 14-2:</a></span><span class="c7 c6">&nbsp;An SMTP banner showing server-version information.</span></p><p class="c11"><span class="c2">The email software type and server version are often very obvious and give hackers some ideas about possible attacks, especially if they search a vulnerability database for known vulnerabilities in that software version. </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141892207101&amp;usg=AOvVaw0XR14mI0N5cz78Xne1Eg9-">Figure 14-3</a></span><span class="c2 c6">&nbsp;shows the same email server with its SMTP banner changed from the default (okay, the previous one was, too) to disguise such information as the email server&rsquo;s version number.</span></p><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 142.67px;"><img alt="Snapshot shows an SMTP banner that disguises the version information." src="images/image8.png" style="width: 580.00px; height: 142.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141892207712&amp;usg=AOvVaw1VkXtKj8035ymL6c_bPnNl">FIGURE 14-3:</a></span><span class="c7 c6">&nbsp;An SMTP banner that disguises the version information.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2 c6">&nbsp;You can gather information on POP3 and IMAP email services by Telnetting to port 110 (POP3) or port 143 (IMAP).</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;If you change your default SMTP banner, don&rsquo;t think that no one can figure out the version. General vulnerability scanners can often detect the version of your email server. One Linux-based tool called smtpscan (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.freshports.org/security/smtpscan&amp;sa=D&amp;source=editors&amp;ust=1681141892208484&amp;usg=AOvVaw3-SW9ZV5U-LKSDKK-Zrg4D">www.freshports.org/security/smtpscan</a></span><span class="c2">) determines email server version information based on how the server responds to malformed SMTP requests. </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0004&amp;sa=D&amp;source=editors&amp;ust=1681141892208822&amp;usg=AOvVaw2DSBg8qYdloMi7F7ob92Nq">Figure 14-4</a></span><span class="c2">&nbsp;shows the results from smtpscan against the same server shown in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141892209180&amp;usg=AOvVaw3ALpLaUp65-1-4UJszAwaq">Figure 14-3</a></span><span class="c2 c6">. The smtpscan tool detected the product and version number of the email server.</span></p><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 458.67px; height: 333.33px;"><img alt="Snapshot shows smtpscan gathers version info even when the SMTP banner is disguised." src="images/image11.png" style="width: 458.67px; height: 333.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0004&amp;sa=D&amp;source=editors&amp;ust=1681141892209822&amp;usg=AOvVaw0lbML7H5fNoIyxn-KDGHgW">FIGURE 14-4:</a></span><span class="c6 c7">&nbsp;smtpscan gathers version info even when the SMTP banner is disguised.</span></p><h4 class="c4" id="h.lrl521d77xd3"><span class="c9 c6">Countermeasures against banner attacks</span></h4><p class="c11"><span class="c2 c6">There isn&rsquo;t a 100 percent secure way to disguise banner information. I suggest these banner security tips for your SMTP, POP3, and IMAP servers:</span></p><ul class="c20 lst-kix_ufntig3hm39o-0 start"><li class="c13 li-bullet-0"><span class="c1">Change your default banners to conceal the details.</span></li><li class="c13 li-bullet-0"><span class="c1">Make sure that you&rsquo;re always running the latest software patches.</span></li><li class="c13 li-bullet-0"><span class="c8">Harden your server as much as possible by using well-known best practices from such resources as the Center for Internet Security (</span><span class="c23 c26"><a class="c12" href="https://www.google.com/url?q=https://www.cisecurity.org/&amp;sa=D&amp;source=editors&amp;ust=1681141892211159&amp;usg=AOvVaw0IkOqsofSpCVrN7N1E4x-4">www.cisecurity.org</a></span><span class="c8">) and NIST (</span><span class="c23 c26"><a class="c12" href="https://www.google.com/url?q=https://csrc.nist.gov/&amp;sa=D&amp;source=editors&amp;ust=1681141892211631&amp;usg=AOvVaw0QwMuGZxgWgEdpk1_XhcGX">https://csrc.nist.gov</a></span><span class="c1">).</span></li></ul><h3 class="c4" id="h.a140pdd26nyk"><span class="c32 c6">SMTP attacks</span></h3><p class="c11"><span class="c2 c6">Some attacks exploit weaknesses in SMTP. This email communication protocol, which is more than three decades old, was designed for functionality not security.</span></p><h4 class="c4" id="h.1hhn7vrs4pjs"><span class="c9 c6">Account enumeration</span></h4><p class="c11"><span class="c2">A clever way that attackers can verify whether email accounts exist on a server is to telnet to the server on port 25 and run the </span><span class="c17">VRFY</span><span class="c2">&nbsp;command. The </span><span class="c17">VRFY</span><span class="c2">&nbsp;(short for </span><span class="c2 c28">verify</span><span class="c2 c6">) command makes a server check whether a specific user ID exists. Spammers often automate this method to perform a directory harvest attack (DHA), which is a way of gleaning valid email addresses from a server or domain so that hackers know whom to send spam, phishing, or malware-infected messages to.</span></p><h4 class="c4" id="h.aadqvzf2l2y0"><span class="c9 c6">ATTACKS USING ACCOUNT ENUMERATION</span></h4><p class="c11"><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0005&amp;sa=D&amp;source=editors&amp;ust=1681141892213631&amp;usg=AOvVaw3tPZagVP22uUzYY25vBtv6">Figure 14-5</a></span><span class="c2">&nbsp;shows how easy it is to verify an email address on a server with the </span><span class="c17">VRFY</span><span class="c2 c6">&nbsp;command enabled. Scripting this attack can test thousands of email address combinations.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 254.67px;"><img alt="Snapshot shows Using VRFY to verify that an email address exists." src="images/image9.png" style="width: 580.00px; height: 254.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0005&amp;sa=D&amp;source=editors&amp;ust=1681141892214552&amp;usg=AOvVaw1Eut0Ot53bHHDgkn2apCaV">FIGURE 14-5:</a></span><span class="c7 c6">&nbsp;Using VRFY to verify that an email address exists.</span></p><p class="c11"><span class="c2">The SMTP command </span><span class="c17">EXPN</span><span class="c2">&nbsp;(short for </span><span class="c2 c28">expand</span><span class="c2">) might allow attackers to verify what mailing lists exist on a server. You can Telnet to your email server on port 25 and try </span><span class="c17">EXPN</span><span class="c2">&nbsp;on your system if you know of any mailing lists that exist. </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0006&amp;sa=D&amp;source=editors&amp;ust=1681141892215505&amp;usg=AOvVaw0G_Sn6ydxrgFC6-DMhiiPz">Figure 14-6</a></span><span class="c2 c6">&nbsp;shows how the result might look. Scripting this attack and testing thousands of mailing-list combinations are simple.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 254.67px;"><img alt="Snapshot shows Using EXPN to verify that a mailing list exists." src="images/image13.png" style="width: 580.00px; height: 254.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0006&amp;sa=D&amp;source=editors&amp;ust=1681141892216259&amp;usg=AOvVaw22iffRpdFOrinmFF9SV3P8">FIGURE 14-6:</a></span><span class="c7 c6">&nbsp;Using EXPN to verify that a mailing list exists.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;You might get bogus information from your server when performing these two tests. Some SMTP servers (such as Microsoft Exchange) don&#39;t support the </span><span class="c17">VRFY</span><span class="c2">&nbsp;and </span><span class="c17">EXPN</span><span class="c2 c6">&nbsp;commands, and some email firewalls ignore them or return false information.</span></p><p class="c11"><span class="c2">Another way to automate the process somewhat is to use the EmailVerify program in TamoSoft&#39;s Essential NetTools (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://www.tamos.com/products/nettools&amp;sa=D&amp;source=editors&amp;ust=1681141892217341&amp;usg=AOvVaw3zg9sIgKnXYa5KoLoyAjW0">www.tamos.com/products/nettools</a></span><span class="c2">). As shown in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0007&amp;sa=D&amp;source=editors&amp;ust=1681141892217757&amp;usg=AOvVaw26rvhybPQq7-3ob3z29bX7">Figure 14-7</a></span><span class="c2 c6">, you enter an email address and click Start; EmailVerify connects to the server and pretends to send an email.</span></p><p class="c11"><span class="c2">Yet another way to capture valid email addresses is to use theHarvester (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://github.com/laramies/theHarvester&amp;sa=D&amp;source=editors&amp;ust=1681141892218330&amp;usg=AOvVaw22CMxlOHxqiCWeDDUWhg-M">https://github.com/laramies/theHarvester</a></span><span class="c2">) to glean addresses via Google and other search engines. You can download Kali Linux from </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.kali.org/&amp;sa=D&amp;source=editors&amp;ust=1681141892218596&amp;usg=AOvVaw2N07ufaPc7i4MbfKxpLcQd">www.kali.org</a></span><span class="c2">&nbsp;to burn the ISO image to a CD or boot the image directly through VMware or VirtualBox. In the Kali Linux interface, choose Applications &nbsp;&rArr; &nbsp; &nbsp;Information Gathering &nbsp;&rArr; &nbsp; &nbsp;SMTP Analysis &nbsp;&rArr; &nbsp; &nbsp;smtp-user-enum, and enter </span><span class="c9">smtp-user-enum &ndash;M VRFY &ndash;u </span><span class="c9 c28">&lt;user name you want to confirm&gt;</span><span class="c9">&nbsp;-t server IP/hostname</span><span class="c2">, as shown in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0008&amp;sa=D&amp;source=editors&amp;ust=1681141892219497&amp;usg=AOvVaw0YeuKbLXyttxGdi02F6-SV">Figure 14-8</a></span><span class="c2 c6">.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 450.67px;"><img alt="Snapshot shows Using EmailVerify to verify an email address." src="images/image7.png" style="width: 580.00px; height: 450.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0007&amp;sa=D&amp;source=editors&amp;ust=1681141892220226&amp;usg=AOvVaw0T85aOv3pTtSPNpdz6xq4_">FIGURE 14-7:</a></span><span class="c7 c6">&nbsp;Using EmailVerify to verify an email address.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 390.67px;"><img alt="Snapshot shows Using smtp-user-enum to glean email addresses." src="images/image16.png" style="width: 580.00px; height: 390.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0008&amp;sa=D&amp;source=editors&amp;ust=1681141892220945&amp;usg=AOvVaw3HocaIoUM6yzM-6_hxFN8-">FIGURE 14-8:</a></span><span class="c7 c6">&nbsp;Using smtp-user-enum to glean email addresses.</span></p><p class="c11"><span class="c2">You can customize smtp-user-enum queries as well using, for example, </span><span class="c17">EXPN</span><span class="c2">&nbsp;in place of </span><span class="c17">VRFY</span><span class="c2">&nbsp;and </span><span class="c17">&ndash;U</span><span class="c2">&nbsp;and a list of user names in a file to query more than one user. Simply enter </span><span class="c9">smtp-user-enum</span><span class="c2 c6">&nbsp;for all the search options.</span></p><h4 class="c4" id="h.gqjl11o3etx"><span class="c9 c6">COUNTERMEASURES AGAINST ACCOUNT ENUMERATION</span></h4><p class="c11"><span class="c2">If you&#39;re running Exchange, account enumeration won&rsquo;t be an issue. If you&rsquo;re not running Exchange, the best way to prevent this type of email account enumeration depends on whether you need to enable the </span><span class="c17">VRFY</span><span class="c2">&nbsp;and </span><span class="c17">EXPN</span><span class="c2 c6">&nbsp;commands, as follows:</span></p><ul class="c20 lst-kix_95sevrxkprfi-0 start"><li class="c10 li-bullet-0"><span class="c8">Disable </span><span class="c23">VRFY</span><span class="c8">&nbsp;and </span><span class="c23">EXPN</span><span class="c1">&nbsp;unless you need your remote systems to gather user and mailing-list information from your server.</span></li><li class="c10 li-bullet-0"><span class="c8">If you need </span><span class="c23">VRFY</span><span class="c8">&nbsp;and </span><span class="c23">EXPN</span><span class="c1">&nbsp;functionality, check your email server or email firewall documentation for the ability to limit these commands to specific hosts on your network or the Internet.</span></li></ul><p class="c11"><span class="c2 c6">Finally, work with your marketing team and web developers to ensure that company email addresses aren&rsquo;t posted on your organization&rsquo;s website or on social media websites. Essentially, you are serving up on a silver platter a means for attackers to attack your users. Also, educate your users about not sharing their corporate email addresses for personal reasons, such as for community sports teams they&rsquo;re on, church fundraisers they&rsquo;re running, and so on.</span></p><h4 class="c4" id="h.6ehmurq8knv6"><span class="c9 c6">Relay</span></h4><p class="c11"><span class="c2 c6">SMTP relay lets users send emails through external servers. Open email relays aren&rsquo;t the problem they used to be, but you still need to check for them. Spammers and criminal hackers can use an email server to send spam or malware through email under the guise of the unsuspecting open-relay owner.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2 c6">&nbsp;Be sure to test for open relays from both outside and inside your network. If you test your internal systems, you may get false positives because outbound email relaying may be configured and necessary for your internal email clients to send messages to the outside world. If a client system is compromised, however, that situation could be just what the bad guys need to use your systems to launch an outbound spam or malware attack.</span></p><h4 class="c4" id="h.5l95qi1bcon8"><span class="c9 c6">AUTOMATIC TESTING</span></h4><p class="c11"><span class="c2 c6">Here are a couple of easy ways to test your server for SMTP relay:</span></p><ul class="c20 lst-kix_ls68zeel5k8h-0 start"><li class="c10 li-bullet-0"><span class="c21">Vulnerability scanners:</span><span class="c1">&nbsp;Many vulnerability scanners, such as Nessus and Qualys, can find open email relay vulnerabilities.</span></li><li class="c10 li-bullet-0"><span class="c21">Windows-based tools:</span><span class="c8">&nbsp;One example is NetScanTools Pro (</span><span class="c23 c26"><a class="c12" href="https://www.google.com/url?q=http://www.netscantools.com/&amp;sa=D&amp;source=editors&amp;ust=1681141892224633&amp;usg=AOvVaw3Csm4SvdF0Nvq4jur2RTbT">www.netscantools.com</a></span><span class="c8">). You can run an SMTP Relay check on your email server with NetScanTools Pro, as shown in </span><span class="c25"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0009&amp;sa=D&amp;source=editors&amp;ust=1681141892225098&amp;usg=AOvVaw0BRQO5qrJvhYCksylU2erT">Figure 14-9</a></span><span class="c8">.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c1">&nbsp;Although some SMTP servers accept inbound relay connections and make relays appear to work, this situation isn&rsquo;t always the case because although the initial connection may be allowed, the filtering actually takes place behind the scenes. Check whether the email made it through by checking the account to which you sent the test relay message.</span></li></ul><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 454.67px;"><img alt="Snapshot shows Using NetScanTools Pro SMTP Server Tests to check for an open email relay." src="images/image12.png" style="width: 580.00px; height: 454.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0009&amp;sa=D&amp;source=editors&amp;ust=1681141892225869&amp;usg=AOvVaw1ZkjYTftItMmcTY7pumM2t">FIGURE 14-9:</a></span><span class="c7 c6">&nbsp;Using NetScanTools Pro SMTP Server Tests to check for an open email relay.</span></p><p class="c11"><span class="c2">In NetScanTools Pro, enter values for the SMTP mail server name and Your Sending Domain Name. Inside Test Message Settings, enter the Recipient Email Address and Sender&rsquo;s Email Address. If the test is successful, NetScanTools Pro opens a window reading </span><span class="c17">Message Sent Successfully</span><span class="c2 c6">.</span></p><p class="c11"><span class="c2 c6">You can also view the results in the main SMTP Server Tests window and generate a formal report by clicking View Results in a Web Browser and then clicking View Relay Test Results.</span></p><h4 class="c4" id="h.1lxfhd4woplz"><span class="c9 c6">MANUAL TESTING</span></h4><p class="c11"><span class="c2 c6">You can test your server for SMTP relay manually by Telnetting to the email server on port 25. Follow these steps:</span></p><ol class="c20 lst-kix_v8xosipxsbka-0 start" start="1"><li class="c10 li-bullet-0"><span class="c21">Telnet to your server on port 25.<br></span><span class="c1">You can do this in two ways:</span></li></ol><ol class="c20 lst-kix_v8xosipxsbka-1 start" start="1"><li class="c24 li-bullet-0"><span class="c8">Use your favorite graphical telnet application, such as PuTTY (</span><span class="c23 c26"><a class="c12" href="https://www.google.com/url?q=https://www.chiark.greenend.org.uk/~sgtatham/putty&amp;sa=D&amp;source=editors&amp;ust=1681141892227479&amp;usg=AOvVaw104P6rkVSvQpfcr2Da9gGZ">www.chiark.greenend.org.uk/~sgtatham/putty</a></span><span class="c1">).</span></li><li class="c24 li-bullet-0"><span class="c8">Enter the following command at a Windows or Linux command prompt:<br></span><span class="c23 c6">telnet mailserver_address 25</span></li></ol><ol class="c20 lst-kix_v8xosipxsbka-0" start="2"><li class="c10 li-bullet-0"><span class="c1">You should see the SMTP welcome banner when the connection is made.</span></li><li class="c10 li-bullet-0"><span class="c21">Enter a command to tell the server, &ldquo;Hi, I&#39;m connecting from this domain.&rdquo;<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 89.33px;"><img alt="Technical stuff" src="images/image10.png" style="width: 60.00px; height: 89.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c8">&nbsp;After each command in these steps, you should receive a different-numbered message, such as </span><span class="c34 c38">999 OK</span><span class="c1">. You can ignore these messages.</span></li><li class="c10 li-bullet-0"><span class="c21">Enter a command to tell the server your email address.<br></span><span class="c8">An example is:<br></span><span class="c23">mail from:yourname@yourdomain.com<br></span><span class="c1">You can use any email address in place of yourname@yourdomain.com.</span></li><li class="c10 li-bullet-0"><span class="c21">Enter a command to tell the server to whom the email should be sent.<br></span><span class="c8">An example is:<br></span><span class="c23">rcpt to:yourname@yourdomain.com<br></span><span class="c1">Again, any email address will suffice.</span></li><li class="c10 li-bullet-0"><span class="c21">Enter a command to tell the server that the message body is to follow.<br></span><span class="c8">An example is:<br></span><span class="c23 c6">data</span></li><li class="c10 li-bullet-0"><span class="c21">Enter the following text as the body of the message:<br></span><span class="c23 c6">A relay test!</span></li><li class="c10 li-bullet-0"><span class="c21">End the command with a period on a line by itself.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c8">&nbsp;You can enter </span><span class="c21">?</span><span class="c8">&nbsp;or </span><span class="c21">help</span><span class="c1">&nbsp;at the first Telnet prompt to see a list of all the supported commands and, depending on the server, get help on the use of the commands.<br>The final period marks the end of the message. After you enter this final period, your message will be sent if relaying is allowed.</span></li><li class="c10 li-bullet-0"><span class="c3">Check for relaying on your server:</span></li></ol><ol class="c20 lst-kix_v8xosipxsbka-1 start" start="1"><li class="c24 li-bullet-0"><span class="c8">Look for a message similar to </span><span class="c23">Relay not allowed</span><span class="c8">&nbsp;coming back from the server.<br>If you get a message similar to this one, SMTP relaying isn&#39;t allowed on your server or is being filtered because many servers block messages that appear to originate from the outside yet come from the inside.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c8">&nbsp;You may get this message after you enter the </span><span class="c23">rcpt to:</span><span class="c1">&nbsp;command.</span></li><li class="c24 li-bullet-0"><span class="c1">If you don&rsquo;t receive a message from your server, check your Inbox for the relayed email.<br>If you receive the test email that you sent, SMTP relaying is enabled on your server and probably needs to be disabled. The last thing you want is to let spammers or other attackers make it look like you&rsquo;re sending tons of spam or, worse, to be blocked by one or more denylist providers. Ending up on a denylist can disrupt email sending and receiving which isn&rsquo;t good for business!</span></li></ol><h4 class="c4" id="h.24fy7cbmhszk"><span class="c9 c6">COUNTERMEASURES AGAINST SMTP RELAY ATTACKS</span></h4><p class="c11"><span class="c2 c6">You can implement the following countermeasures on your email server to disable or at least control SMTP relaying:</span></p><ul class="c20 lst-kix_6yzovysci6f0-0 start"><li class="c10 li-bullet-0"><span class="c21">Disable SMTP relay on your email server.</span><span class="c1">&nbsp;SMTP relay should be disabled by default but it pays to check. If you don&rsquo;t know whether you need SMTP relay, you probably don&rsquo;t. You can enable SMTP relay for specific hosts on the server or within your firewall configuration.</span></li><li class="c10 li-bullet-0"><span class="c21">Enforce authentication if your email server supports it.</span><span class="c1">&nbsp;You may be able to require password authentication on an email address that matches the email server&rsquo;s domain. Check your email server and client documentation for details on setting up this type of authentication.</span></li></ul><h4 class="c4" id="h.7uturkxy954"><span class="c9 c6">Email header disclosures</span></h4><p class="c11"><span class="c2 c6">If your email client and server are configured with typical defaults, a malicious attacker might find critical pieces of information such as these:</span></p><ul class="c20 lst-kix_umz3zpfy9ii-0 start"><li class="c13 li-bullet-0"><span class="c1">Internal IP address of your email client machine (which could lead to the enumeration of your internal network and eventual exploitation via phishing and/or subsequent malware infection)</span></li><li class="c13 li-bullet-0"><span class="c1">Software versions of your client and email server, along with their vulnerabilities</span></li><li class="c13 li-bullet-0"><span class="c1">Host names that may divulge your network naming conventions</span></li></ul><h4 class="c4" id="h.nu779megqwlw"><span class="c9 c6">TESTING</span></h4><p class="c11"><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0010&amp;sa=D&amp;source=editors&amp;ust=1681141892232490&amp;usg=AOvVaw2cOMq4oIZMaqZwnSaP-B6q">Figure 14-10</a></span><span class="c2 c6">&nbsp;shows the header information revealed in a test email I sent to a free web account. As you can see, it reveals quite a bit of information about the email system:</span></p><ul class="c20 lst-kix_kdw8t6qe68pi-0 start"><li class="c10 li-bullet-0"><span class="c1">The third Received line discloses the system&rsquo;s hostname, IP address, server name, and email client software version.</span></li><li class="c10 li-bullet-0"><span class="c1">The X-Mailer line displays the Microsoft Outlook version I used to send this message.</span></li></ul><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 384.00px;"><img alt="Snapshot shows Critical information revealed in email headers." src="images/image4.png" style="width: 580.00px; height: 384.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0010&amp;sa=D&amp;source=editors&amp;ust=1681141892233599&amp;usg=AOvVaw3xTSTvstOyI2DDxFt2rqzD">FIGURE 14-10:</a></span><span class="c7 c6">&nbsp;Critical information revealed in email headers.</span></p><h4 class="c4" id="h.p8i9ktx23vgq"><span class="c9 c6">COUNTERMEASURES AGAINST HEADER DISCLOSURES</span></h4><p class="c11"><span class="c2 c6">The best countermeasure against information disclosures in email headers is configuring your email server or email firewall to rewrite your headers by changing the information shown or removing it. Check your email server or firewall documentation to see whether this method is an option.</span></p><p class="c11"><span class="c2 c6">If header rewriting isn&rsquo;t available (or not allowed by your Internet service provider), you still might prevent the sending of some critical information, such as server software version numbers and internal IP addresses.</span></p><h4 class="c4" id="h.h2d5o780rec0"><span class="c9 c6">Capturing traffic</span></h4><p class="c11"><span class="c2 c6">Email traffic, including usernames and passwords, can be captured with a network analyzer or an email packet sniffer and reconstructor.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Mailsnarf is an email packet sniffer and reconstructor that&rsquo;s part of the old dsniff package (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://sectools.org/tool/dsniff&amp;sa=D&amp;source=editors&amp;ust=1681141892234625&amp;usg=AOvVaw2_h0DuQncmSlgtPWpOfPBx">https://sectools.org/tool/dsniff</a></span><span class="c2">). You can also use Cain &amp; Abel (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://web.archive.org/web/20160217062632/www.oxid.it/projects.html&amp;sa=D&amp;source=editors&amp;ust=1681141892235030&amp;usg=AOvVaw0UILE2FEwHY5aFWWFEOjao">https://web.archive.org/web/20160217062632/www.oxid.it/projects.html</a></span><span class="c2">) to highlight email-in-transit weaknesses. I cover password cracking with this tool and others in </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c08.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141892235387&amp;usg=AOvVaw17SqYzMlT4_Es3XpWYrRxW">Chapter 8</a></span><span class="c2 c6">.</span></p><p class="c11"><span class="c2 c6">If traffic is captured, a hacker or malicious insider can compromise one host and potentially have full access to an adjacent host such as your email server.</span></p><h4 class="c4" id="h.vnx5m4elf88m"><span class="c9 c6">Malware</span></h4><p class="c11"><span class="c2 c6">Email systems are regularly attacked by malware such as viruses and worms. Email is also the most popular entry point for ransomware infections. One of the most important tests you can run for malware vulnerability is to simply verify that your antimalware software is working.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Remember" src="images/image6.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2 c6">&nbsp;Before you begin testing your antimalware software, make sure that you have the latest antimalware software engine and signatures loaded.</span></p><p class="c11"><span class="c2 c6">EICAR offers a safe option for checking the effectiveness of your antimalware software. Although EICAR is by no means a comprehensive method of testing for malware vulnerabilities, it serves as a good, safe start.</span></p><p class="c11"><span class="c2 c6">EICAR is a European-based malware think tank that has worked in conjunction with antimalware vendors to provide this basic system test. The EICAR test string transmits in the body of an email or as a file attachment so that you can see how your server and workstations respond. You access (load) this file which contains the following 68-character string on your computer to see whether your antimalware or other malware software detects it:</span></p><p class="c11 c40"><span class="c17 c6">X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR STANDARD-ANTIMALWARE-TEST-FILE!$H+H*</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;You can download a text file with this string from </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://www.eicar.org/?page_id%3D3950&amp;sa=D&amp;source=editors&amp;ust=1681141892237182&amp;usg=AOvVaw2df-yKymQ5Po2oXyUkGFiK">www.eicar.org/?page_id=3950</a></span><span class="c2 c6">. Several versions of the file are available on this site. I recommend testing with the zip file to make sure that your antimalware software can detect malware within compressed files.</span></p><p class="c11"><span class="c2">When you run this test, you may see results from your antimalware software similar to </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0011&amp;sa=D&amp;source=editors&amp;ust=1681141892237961&amp;usg=AOvVaw2UMpGj2sFWImfoSa65rU5s">Figure 14-11</a></span><span class="c2 c6">.</span></p><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 422.67px; height: 250.67px;"><img alt="Snapshot shows Using the EICAR test string to test antimalware software." src="images/image15.png" style="width: 422.67px; height: 250.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0011&amp;sa=D&amp;source=editors&amp;ust=1681141892238728&amp;usg=AOvVaw3KJ7KhhB-HEQDYVZIMD08o">FIGURE 14-11:</a></span><span class="c7 c6">&nbsp;Using the EICAR test string to test antimalware software.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Remember" src="images/image6.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;In addition to testing your antimalware software, you can attack email systems by using other tools that I cover in this book. For example, Metasploit (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://www.metasploit.com/&amp;sa=D&amp;source=editors&amp;ust=1681141892239421&amp;usg=AOvVaw1BAqlj21IzS0lDAgi2MtcY">www.metasploit.com</a></span><span class="c2 c6">) enables you to discover missing patches in Exchange and other servers that hackers could exploit.</span></p><h3 class="c4" id="h.k04tjr9s6hba"><span class="c32 c6">General best practices for minimizing email security risks</span></h3><p class="c11"><span class="c2 c6">The following countermeasures help keep messages as secure as possible.</span></p><h4 class="c4" id="h.5o6j3ds509lv"><span class="c9 c6">Software solutions</span></h4><p class="c11"><span class="c2 c6">The right software can neutralize many threats:</span></p><ul class="c20 lst-kix_blj2coi71pzr-0 start"><li class="c13 li-bullet-0"><span class="c1">Use antimalware software on the email server &mdash; better, the email gateway &mdash; to prevent malware from reaching email clients. Cloud-based email systems such as those offered by Google and Microsoft often have such protection built in. Using malware protection on your clients is a given.</span></li><li class="c13 li-bullet-0"><span class="c1">Apply the latest operating system (OS) and email-server security patches consistently and after any security alerts are released.</span></li><li class="c13 li-bullet-0"><span class="c8">Encrypt (where&rsquo;s it reasonable to do so). You can go old-school and use S/MIME or PGP to encrypt sensitive messages, or you can use email encryption at the desktop level or the server or email gateway. Better (easier), you can use TLS via the POP3S, IMAPS, and SMTPS protocols. The best option may be to use an email security appliance or cloud service that supports the sending and receiving of encrypted emails via a web browser over HTTPS, such as Google Workspace and Microsoft 365.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c8">&nbsp;Don&rsquo;t depend on your users to encrypt messages. As with any other security policy or control, relying on users to make security decisions often ends poorly. Use an enterprise solution to encrypt messages automatically instead.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Remember" src="images/image6.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c1">&nbsp;Make sure that encrypted files and emails can be protected against malware. Encryption doesn&rsquo;t keep malware out of files or emails. You just end up with encrypted malware within the files or emails. Encryption keeps your server or gateway antimalware software from detecting the malware until it reaches the desktop.</span></li><li class="c13 li-bullet-0"><span class="c1">Make it policy for users not to open email attachments from unknown senders or untrusted sources, and create ongoing awareness sessions and other reminders.</span></li><li class="c13 li-bullet-0"><span class="c1">Plan for users who ignore or forget about the policy of not opening unsolicited emails and attachments. This will happen! Certain software such as Microsoft Outlook and Windows Defender can help alert users to the bad stuff.</span></li></ul><h4 class="c4" id="h.6uvqosqeztw"><span class="c9 c6">Operating guidelines</span></h4><p class="c11"><span class="c2 c6">Some simple operating rules can keep your walls high and the attackers out of your email systems:</span></p><ul class="c20 lst-kix_2utjbsp2ayf-0 start"><li class="c13 li-bullet-0"><span class="c1">Put your email server behind a firewall on a different network segment from the Internet and from your internal LAN &mdash; ideally, in a demilitarized zone (DMZ). Or use a mail gateway.</span></li><li class="c13 li-bullet-0"><span class="c1">Harden by disabling unused protocols and services on your email server.</span></li><li class="c13 li-bullet-0"><span class="c1">Run your email server and perform malware scanning on dedicated servers if possible (potentially even separating inbound and outbound messages). Doing so can keep malicious attacks out of other servers and information in the event that the email server is hacked. Look for solutions that test embedded links and test them and provide safe links.</span></li><li class="c13 li-bullet-0"><span class="c1">Log all transactions with the server in case you need to investigate malicious use. Be sure to monitor these logs as well! If you can&rsquo;t justify monitoring, consider outsourcing this function to a managed security services provider.</span></li><li class="c13 li-bullet-0"><span class="c1">If your server doesn&rsquo;t need certain email services running (SMTP, POP3, and IMAP), disable them.</span></li><li class="c13 li-bullet-0"><span class="c1">For web-based email, such as Microsoft&rsquo;s Outlook Web Access (OWA), properly test and secure your web server application and operating system by using the testing techniques and hardening resources I mention throughout this book.</span></li><li class="c13 li-bullet-0"><span class="c8">Require strong passwords. For stand-alone accounts as well as domain-level Exchange or similar accounts, any password weaknesses on the network will trickle over to email and be exploited by someone via Outlook Web Access or POP3. I cover password hacking in </span><span class="c25"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c08.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141892243313&amp;usg=AOvVaw2-RojWL6H2FM0T-Tff-S7z">Chapter 8</a></span><span class="c1">.</span></li><li class="c13 li-bullet-0"><span class="c1">Be sure to include your email server(s) in your vulnerability scanning and penetration testing efforts.</span></li><li class="c13 li-bullet-0"><span class="c8">If you&rsquo;re running sendmail &mdash; especially an older version &mdash; don&rsquo;t. Consider running a secure alternative such as Postfix (</span><span class="c23 c26"><a class="c12" href="https://www.google.com/url?q=http://www.postfix.org/&amp;sa=D&amp;source=editors&amp;ust=1681141892244044&amp;usg=AOvVaw1VjkNWxq8dDva6aVHtgZqg">www.postfix.org</a></span><span class="c1">).</span></li></ul><h2 class="c4" id="h.lan23b39ecj3"><span class="c19 c6">Understanding VoIP</span></h2><p class="c11"><span class="c2 c6">A widely used technology in enterprises today is Voice over Internet Protocol. In-house VoIP systems and systems for remote users, VoIP servers, softphones, and related components have their own set of security vulnerabilities. As with most things security-related, many people haven&rsquo;t thought about the security issues surrounding voice conversations traversing their networks or the Internet, but those issues certainly need to be on your radar. Don&rsquo;t fret &mdash; it&rsquo;s not too late to make things right. Just remember that even if protective measures are in place, VoIP systems need to be included in your overall security testing strategy on a continuous basis.</span></p><h3 class="c4" id="h.eslr1v98aqls"><span class="c32 c6">VoIP vulnerabilities</span></h3><p class="c11"><span class="c2 c6">As with any technology or set of network protocols, the bad guys are always going to figure out how to break in. VoIP is certainly no different. In fact, given what&rsquo;s at stake (phone conversations and phone system availability), you have a lot to lose.</span></p><p class="c11"><span class="c2">VoIP-related systems are no more (or less) secure than other common computer systems. Why? VoIP systems have their own operating system, they have IP addresses, and they&rsquo;re accessible on the network. Compounding the issue is the fact that many VoIP systems house more </span><span class="c2 c28">intelligence</span><span class="c2 c6">&nbsp;(a fancy word for &ldquo;more stuff that can go wrong&rdquo;), which makes VoIP networks even more hackable.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;If you want to find out more about how VoIP operates &mdash; which will undoubtedly help you root out vulnerabilities &mdash; check out </span><span class="c2 c28">VoIP For Dummies,</span><span class="c2 c6">&nbsp;by Timothy V. Kelly (John Wiley &amp; Sons, Inc.).</span></p><p class="c11"><span class="c2">On the one hand, VoIP systems have vulnerabilities very similar to other systems I cover in this book, including default settings, missing patches, and weak passwords. For that reason, using the standard vulnerability scanning tools that I cover is important. </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0012&amp;sa=D&amp;source=editors&amp;ust=1681141892245699&amp;usg=AOvVaw24JDKhIG9ir41CNZElg6es">Figure 14-12</a></span><span class="c2 c6">&nbsp;shows various vulnerabilities associated with the authentication mechanism in the web interface of a VoIP adapter.</span></p><p class="c11"><span class="c2 c6">Looking at these results, you might think that this device is a basic web server. That&rsquo;s exactly my point: VoIP systems are nothing more than networked computer systems with vulnerabilities that can be exploited.</span></p><p class="c11"><span class="c2 c6">On the other hand, two major security weaknesses are tied specifically to VoIP:</span></p><ul class="c20 lst-kix_um77phknmrlo-0 start"><li class="c36 li-bullet-0"><span class="c21">Phone-service disruption:</span><span class="c1">&nbsp;Yep, VoIP is susceptible to DoS attacks just like any other system or application. VoIP is as vulnerable as the most timing-sensitive applications out there, given the low tolerance that people have for choppy and dropped phone conversations (cellphones aside, of course).</span></li><li class="c36 li-bullet-0"><span class="c21">Lack of encryption:</span><span class="c8">&nbsp;The other big weakness of VoIP is that voice conversations usually aren&rsquo;t encrypted; therefore, they can be intercepted and recorded. Imagine the fun that a bad guy could have recording conversations and blackmailing their victims. This attack is very easy on unsecured wireless networks, but as I show in the upcoming section, &ldquo;</span><span class="c25"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-sec-0034&amp;sa=D&amp;source=editors&amp;ust=1681141892246641&amp;usg=AOvVaw0EofQaT0bkFMCXQaXClHaZ">Capturing and recording voice traffic</a></span><span class="c1">,&rdquo; it&rsquo;s also pretty simple to carry out on wired networks.</span></li></ul><p class="c30"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 578.67px;"><img alt="Snapshot shows a WebInspect scan of a VoIP network adapter showing several weaknesses." src="images/image19.png" style="width: 580.00px; height: 578.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0012&amp;sa=D&amp;source=editors&amp;ust=1681141892247390&amp;usg=AOvVaw3aKOPU516Q15aetF-7LZnr">FIGURE 14-12:</a></span><span class="c7 c6">&nbsp;A WebInspect scan of a VoIP network adapter showing several weaknesses.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;If a VoIP network isn&rsquo;t protected via network segmentation such as a virtual local-area network (VLAN), the voice network is especially susceptible to eavesdropping, DoS, and other attacks. But the VLAN barrier can be overcome in many environments by a tool called VoIP Hopper (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://voiphopper.sourceforge.net/&amp;sa=D&amp;source=editors&amp;ust=1681141892247983&amp;usg=AOvVaw2ZeNqYMmIYFFZqtx82Cl5K">http://voiphopper.sourceforge.net</a></span><span class="c2 c6">). Just when you think that your voice systems are secure, a tool like VoIP Hopper comes along. It&rsquo;s an older tool, but it can still work for this type of testing.</span></p><p class="c11"><span class="c2 c6">Unlike typical computer security vulnerabilities, these issues with VoIP aren&rsquo;t easily fixed with simple software patches. These vulnerabilities are embedded in the Session Initiation Protocol (SIP) and Real-Time Transport Protocol (RTP) that VoIP uses for its communications. The following sections describe two VoIP-centric tests that you should use to assess the security of your voice systems.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;It&rsquo;s important to note that although SIP is the most widely used VoIP protocol, H.323 also exists, so don&rsquo;t spin your wheels testing for SIP flaws if H.323 is the protocol in use. Visit </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.packetizer.com/ipmc/h323_vs_sip&amp;sa=D&amp;source=editors&amp;ust=1681141892248545&amp;usg=AOvVaw0k7vrJTty-U_mWQvk1t30p">www.packetizer.com/ipmc/h323_vs_sip</a></span><span class="c2 c6">&nbsp;for additional details on H.323 versus SIP.</span></p><h4 class="c4" id="h.ipnrak92ndk2"><span class="c9 c6">Scanning for vulnerabilities</span></h4><p class="c11"><span class="c2">Outside the basic network, operating system, and web application vulnerabilities, you can uncover VoIP issues if you use the right tools. The good news is that you likely already have these tools at your disposal in the form of network vulnerability scanners such as Nessus (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.tenable.com/products/nes&amp;sa=D&amp;source=editors&amp;ust=1681141892249191&amp;usg=AOvVaw3ANyCf5ICCT2ovDUlqo5dw">www.tenable.com/products/nes</a></span><span class="c2">sus) and web vulnerability scanners such as Netsparker (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://www.netsparker.com/&amp;sa=D&amp;source=editors&amp;ust=1681141892249472&amp;usg=AOvVaw179-h2rGW8o4-1lNgEWQbZ">www.netsparker.com</a></span><span class="c2 c6">). Common flaws in VoIP call managers and phones include weak passwords, cross-site scripting, and missing patches that can be exploited with a tool such as Metasploit.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Kali Linux has several VoIP tools that are built in via Applications/Vulnerability Analysis/VoIP Tools. Another free tool for analyzing SIP traffic is sipsak (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://www.voip-info.org/sipsak/&amp;sa=D&amp;source=editors&amp;ust=1681141892249945&amp;usg=AOvVaw18uQUgptMTSv-aceTikKRw">www.voip-info.org/sipsak/</a></span><span class="c2">). A good website that lists a variety of VoIP-related tools is </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.voipsa.org/Resources/tools.php&amp;sa=D&amp;source=editors&amp;ust=1681141892250269&amp;usg=AOvVaw2gRiLkNwVw8wwRDe95AcYX">www.voipsa.org/Resources/tools.php</a></span><span class="c2 c6">.</span></p><h4 class="c4" id="h.3fl90ckmaxf7"><span class="c9 c6">Capturing and recording voice traffic</span></h4><p class="c11"><span class="c2 c6">If you have access to the wired or wireless network, you can capture VoIP conversations easily, which is a great way to prove that the network and the VoIP installation are vulnerable.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2 c6">&nbsp;Many legal issues are associated with tapping into phone conversations, so make sure that you have permission and are careful not to abuse your test results.</span></p><p class="c11"><span class="c2">You can use Cain &amp; Abel (technically, just Cain for the features I demonstrate here) to tap into VoIP conversations. You can download Cain &amp; Abel free at </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://web.archive.org/web/20160217062632/www.oxid.it/projects.htmloxi&amp;sa=D&amp;source=editors&amp;ust=1681141892251308&amp;usg=AOvVaw0NHSsvtR7gImZfF5H0iQTf">https://web.archive.org/web/20160217062632/www.oxid.it/projects.htmloxi</a></span><span class="c2 c6">. Using Cain&rsquo;s ARP poison routing feature, you can plug into the network and have it capture VoIP traffic by following these steps:</span></p><ol class="c20 lst-kix_n3uzf8eo1li-0 start" start="1"><li class="c13 li-bullet-0"><span class="c21">Load Cain &amp; Abel, and click the Sniffer tab to enter network analyzer mode.<br></span><span class="c1">The Hosts page opens by default.</span></li><li class="c13 li-bullet-0"><span class="c21">Click the Start/Stop APR icon (which looks like the nuclear-waste symbol).<br></span><span class="c1">The ARP poison routing process starts and enables the built-in sniffer.</span></li><li class="c13 li-bullet-0"><span class="c3">Click the blue plus-sign (+) icon to add hosts on which to perform ARP poisoning.</span></li><li class="c13 li-bullet-0"><span class="c3">In the MAC Address Scanner window that appears, ensure that All Hosts in My Subnet is selected, and click OK.</span></li><li class="c13 li-bullet-0"><span class="c3">Click the APR tab (the one with the yellow-and-black circle icon) to load the APR page.</span></li><li class="c13 li-bullet-0"><span class="c21">Click the white space below the uppermost Status column heading (below the Sniffer tab).<br></span><span class="c1">This step re-enables the blue + icon.</span></li><li class="c13 li-bullet-0"><span class="c21">Click the blue + icon.<br></span><span class="c1">The New ARP Poison Routing window shows the hosts discovered in Step 3.</span></li><li class="c13 li-bullet-0"><span class="c21">Select your default route or other host that you want to capture packets traveling to and from.<br></span><span class="c1">I select my default route, but you might consider selecting your SIP management system or other central VoIP system. The right column fills with all the remaining hosts.</span></li><li class="c13 li-bullet-0"><span class="c21">In the right column, Ctrl+click the system you want to poison to capture its voice traffic.<br></span><span class="c1">I select my VoIP network adapter, but you might consider selecting all your VoIP phones.</span></li><li class="c13 li-bullet-0"><span class="c21">Click OK to start the ARP poisoning process.<br></span><span class="c1">This process can take anywhere from a few seconds to a few minutes, depending on your network hardware and each host&rsquo;s local TCP/IP stack.</span></li><li class="c13 li-bullet-0"><span class="c21">Click the VoIP tab.<br></span><span class="c8">All voice conversations are recorded.<br>Here&rsquo;s the interesting part: The conversations are saved in </span><span class="c23">.wav</span><span class="c8">&nbsp;audio file format, so you simply right-click the recorded conversation you want to test and choose Play from the contextual menu, as shown in </span><span class="c25"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0013&amp;sa=D&amp;source=editors&amp;ust=1681141892254293&amp;usg=AOvVaw0lPkytjR2QJuv7psgppo3K">Figure 14-13</a></span><span class="c8">. Conversations that are being recorded display </span><span class="c23">Recording</span><span class="c1">&nbsp;in the Status column.</span></li></ol><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 337.33px;"><img alt="Snapshot shows Using Cain &amp; Abel to capture, record, and play back VoIP conversations." src="images/image3.png" style="width: 580.00px; height: 337.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0013&amp;sa=D&amp;source=editors&amp;ust=1681141892255116&amp;usg=AOvVaw2xViA5Cyoxi9t_53-e_Bx8">FIGURE 14-13:</a></span><span class="c7 c6">&nbsp;Using Cain &amp; Abel to capture, record, and play back VoIP conversations.</span></p><p class="c11"><span class="c2 c6">The voice quality you get with Cain and other tools depends on the codec that your VoIP devices use. With my equipment, I find that the quality is marginal at best, but that&#39;s not really a big deal. Your goal is to prove the existence of a vulnerability &mdash; not to listen in on other people&rsquo;s conversations.</span></p><p class="c11"><span class="c2">You can also use a Linux-based tool called vomit (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://vomit.xtdnet.nl/&amp;sa=D&amp;source=editors&amp;ust=1681141892255894&amp;usg=AOvVaw2iMeWHoQYTxES8sTa7nVlw">http://vomit.xtdnet.nl</a></span><span class="c2">), which is short for </span><span class="c2 c28">voice over misconfigured Internet telephones,</span><span class="c2">&nbsp;that you can use to convert VoIP conversations to </span><span class="c17">.wav</span><span class="c2 c6">&nbsp;files. First, you need to capture the actual conversation by using tcpdump, but if Linux is your preference, this solution offers the same results as Cain, outlined in the preceding steps.</span></p><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;If you&#39;re going to work a lot with VoIP, I highly recommend that you invest in a good VoIP network analyzer. Check out TamoSoft&rsquo;s CommView (</span><span class="c0"><a class="c12" href="https://www.google.com/url?q=http://www.tamos.com/products/commview&amp;sa=D&amp;source=editors&amp;ust=1681141892256827&amp;usg=AOvVaw0Hv6ZYKQNiROxtzaRlsTrc">www.tamos.com/products/commview</a></span><span class="c2 c6">), which is a great option at a price that&rsquo;s much lower than many other commercial network analyzers.</span></p><p class="c11"><span class="c2">These VoIP vulnerabilities are only the tip of the iceberg. New systems, software, and related protocols continue to emerge, so it pays to remain vigilant to ensure that your conversations are locked down against those with malicious intent. As I&rsquo;ve said before, if it has an IP address or a URL, it&rsquo;s fair game for attack. </span><span class="c22"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23c14-fig-0014&amp;sa=D&amp;source=editors&amp;ust=1681141892257467&amp;usg=AOvVaw2xonrmv4sAWuLT4mIUxT_u">Figure 14-14</a></span><span class="c2 c6">&nbsp;shows a common and inexcusable vulnerability in VoIP systems &mdash; the dreaded default password.</span></p><p class="c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 440.00px;"><img alt="Snapshot shows Connecting to a VoIP phone&rsquo;s web interface using the default password." src="images/image18.png" style="width: 580.00px; height: 440.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c14"><a class="c12" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c14.xhtml%23rc14-fig-0014&amp;sa=D&amp;source=editors&amp;ust=1681141892258082&amp;usg=AOvVaw343v2nBvPcZC3BlXpRYGlP">FIGURE 14-14:</a></span><span class="c7 c6">&nbsp;Connecting to a VoIP phone&rsquo;s web interface using the default password.</span></p><p class="c11"><span class="c2 c6">All you or an attacker has to do is a quick Google search on &ldquo;default password&rdquo; and the specific vendor name, and it works like a champ!</span></p><h3 class="c4" id="h.vqubuw9unzex"><span class="c32 c6">Countermeasures against VoIP vulnerabilities</span></h3><p class="c11"><span class="c2">Locking down VoIP can be tricky. You can get off to a good start, though, by segmenting your voice network into its own VLAN or even a dedicated physical network, if that fits into your budget. Further isolate any Internet-connected systems so that not just anyone can connect to them (a situation that I see often). You should also make sure that all VoIP-related systems are hardened according to vendor recommendations and widely accepted best practices (such as NIST&rsquo;s SP800-58 document at </span><span class="c0"><a class="c12" href="https://www.google.com/url?q=https://csrc.nist.gov/publications/detail/sp/800-58/final&amp;sa=D&amp;source=editors&amp;ust=1681141892258991&amp;usg=AOvVaw1MRCSEAe3IVGeZJ-PjcUcY">https://csrc.nist.gov/publications/detail/sp/800-58/final</a></span><span class="c2 c6">) and that software and firmware are patched on a periodic and consistent basis. Make sure that changing default passwords are a part of this. Finally, be sure to scan voice-related systems with a network vulnerability scanner such as Qualys or Nessus on a periodic basis. If all your phones are the same make and model, you probably can get away with testing a small subset of them. Just be careful, as I&rsquo;ve seen phones and related voice equipment go a bit haywire when vulnerability scans are run against them.</span></p><p class="c41"><span class="c6 c31"></span></p></body></html>