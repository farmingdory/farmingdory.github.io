<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_ifa863wz6ytj-0{list-style-type:none}.lst-kix_fcwam7tej5g7-2>li:before{content:"\0025a0  "}.lst-kix_fcwam7tej5g7-3>li:before{content:"\0025cf  "}.lst-kix_vxawk0r7ghg6-1>li:before{content:"\0025cb  "}.lst-kix_vxawk0r7ghg6-2>li:before{content:"\0025a0  "}ul.lst-kix_ifa863wz6ytj-1{list-style-type:none}ul.lst-kix_ifa863wz6ytj-2{list-style-type:none}ul.lst-kix_ifa863wz6ytj-3{list-style-type:none}.lst-kix_fcwam7tej5g7-0>li:before{content:"\0025cf  "}.lst-kix_fcwam7tej5g7-1>li:before{content:"\0025cb  "}.lst-kix_fcwam7tej5g7-4>li:before{content:"\0025cb  "}.lst-kix_fcwam7tej5g7-5>li:before{content:"\0025a0  "}.lst-kix_fcwam7tej5g7-6>li:before{content:"\0025cf  "}.lst-kix_fcwam7tej5g7-7>li:before{content:"\0025cb  "}.lst-kix_vxawk0r7ghg6-5>li:before{content:"\0025a0  "}.lst-kix_vxawk0r7ghg6-3>li:before{content:"\0025cf  "}.lst-kix_vxawk0r7ghg6-4>li:before{content:"\0025cb  "}.lst-kix_xkhi8rgu6wzw-0>li:before{content:"\0025cf  "}ul.lst-kix_ifa863wz6ytj-8{list-style-type:none}.lst-kix_vxawk0r7ghg6-6>li:before{content:"\0025cf  "}ul.lst-kix_ifa863wz6ytj-4{list-style-type:none}.lst-kix_vxawk0r7ghg6-7>li:before{content:"\0025cb  "}.lst-kix_vxawk0r7ghg6-8>li:before{content:"\0025a0  "}ul.lst-kix_ifa863wz6ytj-5{list-style-type:none}ul.lst-kix_ifa863wz6ytj-6{list-style-type:none}ul.lst-kix_ifa863wz6ytj-7{list-style-type:none}.lst-kix_xkhi8rgu6wzw-6>li:before{content:"\0025cf  "}.lst-kix_xkhi8rgu6wzw-5>li:before{content:"\0025a0  "}.lst-kix_xkhi8rgu6wzw-7>li:before{content:"\0025cb  "}ul.lst-kix_fcwam7tej5g7-0{list-style-type:none}.lst-kix_xkhi8rgu6wzw-4>li:before{content:"\0025cb  "}.lst-kix_xkhi8rgu6wzw-8>li:before{content:"\0025a0  "}ul.lst-kix_fcwam7tej5g7-1{list-style-type:none}ul.lst-kix_fcwam7tej5g7-2{list-style-type:none}ul.lst-kix_fcwam7tej5g7-3{list-style-type:none}.lst-kix_xkhi8rgu6wzw-2>li:before{content:"\0025a0  "}.lst-kix_xkhi8rgu6wzw-1>li:before{content:"\0025cb  "}.lst-kix_xkhi8rgu6wzw-3>li:before{content:"\0025cf  "}.lst-kix_83u84u8bseg8-4>li:before{content:"\0025cb  "}.lst-kix_83u84u8bseg8-5>li:before{content:"\0025a0  "}.lst-kix_fcwam7tej5g7-8>li:before{content:"\0025a0  "}.lst-kix_83u84u8bseg8-7>li:before{content:"\0025cb  "}.lst-kix_83u84u8bseg8-6>li:before{content:"\0025cf  "}.lst-kix_83u84u8bseg8-8>li:before{content:"\0025a0  "}ul.lst-kix_xkhi8rgu6wzw-8{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-7{list-style-type:none}.lst-kix_vxawk0r7ghg6-0>li:before{content:"\0025cf  "}ul.lst-kix_r4i0qesc268h-0{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-2{list-style-type:none}ul.lst-kix_r4i0qesc268h-1{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-1{list-style-type:none}ul.lst-kix_r4i0qesc268h-2{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-0{list-style-type:none}ul.lst-kix_r4i0qesc268h-3{list-style-type:none}ul.lst-kix_r4i0qesc268h-4{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-6{list-style-type:none}ul.lst-kix_r4i0qesc268h-5{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-5{list-style-type:none}ul.lst-kix_r4i0qesc268h-6{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-4{list-style-type:none}ul.lst-kix_r4i0qesc268h-7{list-style-type:none}ul.lst-kix_xkhi8rgu6wzw-3{list-style-type:none}ul.lst-kix_r4i0qesc268h-8{list-style-type:none}.lst-kix_scf1iqo0c4t0-0>li:before{content:"\0025cf  "}.lst-kix_83u84u8bseg8-3>li:before{content:"\0025cf  "}.lst-kix_scf1iqo0c4t0-2>li:before{content:"\0025a0  "}.lst-kix_83u84u8bseg8-2>li:before{content:"\0025a0  "}.lst-kix_scf1iqo0c4t0-1>li:before{content:"\0025cb  "}.lst-kix_scf1iqo0c4t0-3>li:before{content:"\0025cf  "}.lst-kix_83u84u8bseg8-1>li:before{content:"\0025cb  "}.lst-kix_scf1iqo0c4t0-6>li:before{content:"\0025cf  "}ul.lst-kix_fcwam7tej5g7-4{list-style-type:none}ul.lst-kix_fcwam7tej5g7-5{list-style-type:none}.lst-kix_83u84u8bseg8-0>li:before{content:"\0025cf  "}.lst-kix_scf1iqo0c4t0-5>li:before{content:"\0025a0  "}ul.lst-kix_fcwam7tej5g7-6{list-style-type:none}ul.lst-kix_fcwam7tej5g7-7{list-style-type:none}.lst-kix_scf1iqo0c4t0-4>li:before{content:"\0025cb  "}ul.lst-kix_fcwam7tej5g7-8{list-style-type:none}.lst-kix_scf1iqo0c4t0-7>li:before{content:"\0025cb  "}.lst-kix_scf1iqo0c4t0-8>li:before{content:"\0025a0  "}ul.lst-kix_scf1iqo0c4t0-8{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-7{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-6{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-5{list-style-type:none}.lst-kix_lzu3wmofz0ag-6>li:before{content:"\0025cf  "}.lst-kix_lzu3wmofz0ag-8>li:before{content:"\0025a0  "}ul.lst-kix_scf1iqo0c4t0-4{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-3{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-2{list-style-type:none}ul.lst-kix_scf1iqo0c4t0-1{list-style-type:none}.lst-kix_lzu3wmofz0ag-7>li:before{content:"\0025cb  "}ul.lst-kix_scf1iqo0c4t0-0{list-style-type:none}.lst-kix_ifa863wz6ytj-3>li:before{content:"\0025cf  "}.lst-kix_ifa863wz6ytj-4>li:before{content:"\0025cb  "}.lst-kix_ifa863wz6ytj-6>li:before{content:"\0025cf  "}.lst-kix_ifa863wz6ytj-5>li:before{content:"\0025a0  "}ul.lst-kix_vxawk0r7ghg6-4{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-3{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-6{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-5{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-0{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-2{list-style-type:none}ul.lst-kix_vxawk0r7ghg6-1{list-style-type:none}.lst-kix_lzu3wmofz0ag-0>li:before{content:"\0025cf  "}ul.lst-kix_vxawk0r7ghg6-8{list-style-type:none}.lst-kix_ifa863wz6ytj-2>li:before{content:"\0025a0  "}ul.lst-kix_vxawk0r7ghg6-7{list-style-type:none}.lst-kix_ifa863wz6ytj-1>li:before{content:"\0025cb  "}ul.lst-kix_lzu3wmofz0ag-4{list-style-type:none}.lst-kix_ifa863wz6ytj-0>li:before{content:"\0025cf  "}ul.lst-kix_lzu3wmofz0ag-5{list-style-type:none}ul.lst-kix_lzu3wmofz0ag-6{list-style-type:none}.lst-kix_lzu3wmofz0ag-2>li:before{content:"\0025a0  "}.lst-kix_lzu3wmofz0ag-4>li:before{content:"\0025cb  "}ul.lst-kix_lzu3wmofz0ag-7{list-style-type:none}ul.lst-kix_lzu3wmofz0ag-8{list-style-type:none}.lst-kix_lzu3wmofz0ag-1>li:before{content:"\0025cb  "}.lst-kix_lzu3wmofz0ag-5>li:before{content:"\0025a0  "}ul.lst-kix_lzu3wmofz0ag-0{list-style-type:none}ul.lst-kix_lzu3wmofz0ag-1{list-style-type:none}ul.lst-kix_lzu3wmofz0ag-2{list-style-type:none}.lst-kix_lzu3wmofz0ag-3>li:before{content:"\0025cf  "}ul.lst-kix_lzu3wmofz0ag-3{list-style-type:none}ul.lst-kix_83u84u8bseg8-0{list-style-type:none}ul.lst-kix_83u84u8bseg8-1{list-style-type:none}ul.lst-kix_83u84u8bseg8-2{list-style-type:none}ul.lst-kix_83u84u8bseg8-3{list-style-type:none}ul.lst-kix_83u84u8bseg8-4{list-style-type:none}.lst-kix_r4i0qesc268h-8>li:before{content:"\0025a0  "}.lst-kix_r4i0qesc268h-2>li:before{content:"\0025a0  "}.lst-kix_r4i0qesc268h-4>li:before{content:"\0025cb  "}.lst-kix_r4i0qesc268h-3>li:before{content:"\0025cf  "}.lst-kix_r4i0qesc268h-7>li:before{content:"\0025cb  "}ul.lst-kix_83u84u8bseg8-5{list-style-type:none}ul.lst-kix_83u84u8bseg8-6{list-style-type:none}ul.lst-kix_83u84u8bseg8-7{list-style-type:none}.lst-kix_r4i0qesc268h-6>li:before{content:"\0025cf  "}ul.lst-kix_83u84u8bseg8-8{list-style-type:none}.lst-kix_r4i0qesc268h-5>li:before{content:"\0025a0  "}.lst-kix_ifa863wz6ytj-8>li:before{content:"\0025a0  "}.lst-kix_ifa863wz6ytj-7>li:before{content:"\0025cb  "}.lst-kix_r4i0qesc268h-0>li:before{content:"\0025cf  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_r4i0qesc268h-1>li:before{content:"\0025cb  "}ol{margin:0;padding:0}table td,table th{padding:0}.c24{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:-30pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;margin-left:30pt;text-indent:-30pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c27{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:-9.8pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;margin-left:10pt;text-indent:-10pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c33{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:center;padding-right:0pt}.c35{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c16{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c6{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c21{-webkit-text-decoration-skip:none;color:#005f8b;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c0{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:42pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c13{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:25pt;font-family:"Times New Roman";font-style:normal}.c3{background-color:#eef2f6;-webkit-text-decoration-skip:none;color:#188038;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Courier New"}.c23{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman";font-style:normal}.c8{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Times New Roman";font-style:normal}.c9{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:10.5pt;font-family:"Times New Roman"}.c25{background-color:#eef2f6;color:#188038;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Courier New";font-style:normal}.c2{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c14{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Times New Roman";font-style:normal}.c18{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman"}.c20{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c5{margin-left:54pt;padding-top:18pt;padding-left:0pt;padding-bottom:66pt;line-height:1.75;orphans:2;widows:2;text-align:left}.c15{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman"}.c4{background-color:#eef2f6;-webkit-text-decoration-skip:none;color:#188038;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:10.5pt;font-family:"Courier New"}.c28{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c11{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c29{color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:43pt;font-family:"Times New Roman";font-style:normal}.c22{padding-top:48pt;padding-bottom:96pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c1{background-color:#ffffff;font-size:10.5pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c7{background-color:#ffffff;font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c17{background-color:#ffffff;font-size:10.5pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c12{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c34{background-color:#eef2f6;font-size:10.5pt;font-family:"Courier New";color:#188038;font-weight:400}.c32{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c26{text-decoration:none;vertical-align:baseline;font-style:italic}.c10{color:inherit;text-decoration:inherit}.c19{padding:0;margin:0}.c30{font-style:italic}.c36{background-color:#ffffff}.c31{background-color:#b2d6e7}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c32 doc-content"><p class="c33"><span class="c21">Chapter 16</span></p><h1 class="c16 c36" id="h.wasvzksnnz6o"><span class="c29">Databases and Storage Systems</span></h1><p class="c27"><span class="c2">IN THIS CHAPTER</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;</span><span class="c20">Testing and exploiting database flaws</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;</span><span class="c20">Finding storage weaknesses</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;</span><span class="c20">Ferreting out sensitive information</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 10.67px;"><img alt="Bullet" src="images/image2.png" style="width: 14.67px; height: 10.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;</span><span class="c20">Countering database and storage abuse</span></p><p class="c6"><span class="c2">Attacks against databases and storage systems can be very serious because that&rsquo;s where &ldquo;the goods&rdquo; are located, and those with ill intent are well aware of that fact. These attacks can occur across the Internet or on the internal network when external attackers and malicious insiders exploit any number of vulnerabilities. These attacks can also occur via the web application through SQL injection. This chapter covers some common vulnerabilities that, when exploited, can be very impactful to a business.</span></p><h2 class="c16" id="h.pdx54dgngs17"><span class="c13">Diving Into Databases</span></h2><p class="c6"><span class="c2">Database systems such as Microsoft SQL Server, MySQL, and Oracle have lurked behind the scenes, but their value and vulnerabilities have finally come to the forefront. Yes, even the mighty Oracle, which was once claimed to be unhackable, is as susceptible to exploits as its competition. With the slew of regulatory requirements governing database security, hardly any business can hide from the risks that lie within because practically every business (large and small) uses some sort of database, either in-house or hosted in the cloud.</span></p><h3 class="c16" id="h.1p27mdc8exvr"><span class="c14">Choosing tools</span></h3><p class="c6"><span class="c2">As with wireless networks, operating systems, and so on, you need good tools if you&rsquo;re going to find the database security issues that count. The following are my favorite tools for testing database security:</span></p><ul class="c19 lst-kix_83u84u8bseg8-0 start"><li class="c5 li-bullet-0"><span class="c1">Advanced SQL Password Recovery</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.elcomsoft.com/asqlpr.html&amp;sa=D&amp;source=editors&amp;ust=1681141910558154&amp;usg=AOvVaw1jfiGqCr3rPEhTWy62dvc-">www.elcomsoft.com/asqlpr.html</a></span><span class="c8">) for cracking Microsoft SQL Server passwords</span></li><li class="c5 li-bullet-0"><span class="c1">Cain &amp; Abel</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=https://web.archive.org/web/20160217062632/http:/www.oxid.it/projects.html&amp;sa=D&amp;source=editors&amp;ust=1681141910558835&amp;usg=AOvVaw00W-2u_I6CRYGpPmyFT4ci">https://web.archive.org/web/20160217062632/http://www.oxid.it/projects.html</a></span><span class="c8">) for cracking database password hashes</span></li><li class="c5 li-bullet-0"><span class="c1">Nessus</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.tenable.com/products/nessus&amp;sa=D&amp;source=editors&amp;ust=1681141910559350&amp;usg=AOvVaw0A8cZKkF30NyuDLRITq9sj">www.tenable.com/products/nessus</a></span><span class="c8">) for performing in-depth vulnerability scans</span></li><li class="c5 li-bullet-0"><span class="c1">SQLPing3</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.sqlsecurity.com/downloads&amp;sa=D&amp;source=editors&amp;ust=1681141910559822&amp;usg=AOvVaw0O18OP4tucMYjVrAAwcoV8">www.sqlsecurity.com/downloads</a></span><span class="c8">) for locating Microsoft SQL Servers on the network, checking for blank passwords for the sa account (the default SQL Server system administrator), and performing dictionary password-cracking attacks</span></li></ul><p class="c6"><span class="c2">You can also use exploit tools such as Metasploit for your database testing.</span></p><h3 class="c16" id="h.m9ut4a9naymr"><span class="c14">Finding databases on the network</span></h3><p class="c6"><span class="c2">The first step in discovering database vulnerabilities is figuring out where they&rsquo;re located on your network. It sounds funny, but many network admins I&rsquo;ve met aren&rsquo;t even aware of various databases running in their environments. This situation is especially true of the free SQL Server Express database software editions that users can download and run on your network.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;I can&rsquo;t tell you how often I find sensitive production data such as credit card and Social Security numbers being used in test databases that are wide open to abuse by curious insiders or even external attackers who have made their way into the network. Using sensitive production data in the uncontrolled areas of the network such as sales, software development, and quality assurance is a data breach waiting to happen.</span></p><p class="c6"><span class="c7">The best tool I&rsquo;ve found to discover Microsoft SQL Server systems is SQLPing3 (see </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0001&amp;sa=D&amp;source=editors&amp;ust=1681141910561161&amp;usg=AOvVaw270eJDDZiUUBA_ZoOTQvau">Figure 16-1</a></span><span class="c2">).</span></p><p class="c6"><span class="c2">SQLPing3 can even discover instances of SQL Server hidden behind personal firewalls such as Windows Firewall. This feature is nice because Windows Firewall is enabled by default in Windows 7 and later.</span></p><p class="c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 477.33px;"><img alt="Snapshot shows SQLPing3 can find SQL Server systems and check for missing sa account passwords." src="images/image7.png" style="width: 580.00px; height: 477.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c35"><span class="c18"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23rc16-fig-0001&amp;sa=D&amp;source=editors&amp;ust=1681141910561846&amp;usg=AOvVaw3ZRGzdAcKJJRFawYnBmXR8">FIGURE 16-1:</a></span><span class="c23">&nbsp;SQLPing3 can find SQL Server systems and check for missing sa account passwords.</span></p><h3 class="c16" id="h.p2yw1ny6jo76"><span class="c14">Cracking database passwords</span></h3><p class="c6"><span class="c7">SQLPing3 also serves as a nice dictionary-based SQL Server password-cracking program. As </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0001&amp;sa=D&amp;source=editors&amp;ust=1681141910562490&amp;usg=AOvVaw1SmZsRCB6FifbBpDREbPlB">Figure 16-1</a></span><span class="c7">&nbsp;shows, it checks for blank system adminiustrator (sa) passwords by default. Another free tool for cracking SQL Server, MySQL, and Oracle password hashes is Cain &amp; Abel, shown in </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0002&amp;sa=D&amp;source=editors&amp;ust=1681141910562850&amp;usg=AOvVaw3GT1oLMEKMYDbjDd2jbk3I">Figure 16-2</a></span><span class="c2">.</span></p><p class="c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 402.67px;"><img alt="Snapshot shows Using Cain &amp; Abel to crack Oracle password hashes." src="images/image6.png" style="width: 580.00px; height: 402.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c35"><span class="c18"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23rc16-fig-0002&amp;sa=D&amp;source=editors&amp;ust=1681141910563375&amp;usg=AOvVaw2bCDegYQOkvRKEasBuQ-lD">FIGURE 16-2:</a></span><span class="c23">&nbsp;Using Cain &amp; Abel to crack Oracle password hashes.</span></p><p class="c6"><span class="c2">You simply load Cain &amp; Abel, click the Cracker tab at the top, select Oracle Hashes in the bottom-left corner, and click the blue plus symbol at the top to load a user name and password hash to start the cracking. You can also select Oracle TNS Hashes at the bottom left and attempt to capture Transport Network Substrate hashes off the wire when capturing packets with Cain. You can do the same for MySQL password hashes.</span></p><p class="c6"><span class="c7">The commercial product ElcomSoft Distributed Password Recovery (</span><span class="c3"><a class="c10" href="https://www.google.com/url?q=http://www.elcomsoft.com/edpr.html&amp;sa=D&amp;source=editors&amp;ust=1681141910563950&amp;usg=AOvVaw2kQkN3pFhf7qKDk8-rH6z0">www.elcomsoft.com/edpr.html</a></span><span class="c7">) can also crack Oracle password hashes. If you have access to SQL Server </span><span class="c12">master.mdf</span><span class="c2">&nbsp;files (which are often readily available on the network due to weak share and file permissions, as I outline later in this chapter), you can use ElcomSoft&#39;s Advanced SQL Password Recovery to recover database passwords immediately.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;You may stumble across some legacy Microsoft Access database files that are password protected as well. No worries: The tool Advanced Office Password Recovery can get you right in. There are also many end-of-life or unsupported versions of Access still around. Running a vulnerability scanner such as Nexpose to uncover flaws can prove beneficial. Depending on the findings, you might then be able to use Metasploit to demonstrate what can happen.</span></p><p class="c6"><span class="c2">As you can imagine, these password-cracking tools are great ways to demonstrate the most basic of weaknesses in your database security. They&rsquo;re also nice ways to underscore the problems with critical files scattered across the network in an unprotected fashion.</span></p><p class="c6"><span class="c7">Another good way to demonstrate SQL Server weaknesses is to use SQL Server Management Studio (</span><span class="c3"><a class="c10" href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms&amp;sa=D&amp;source=editors&amp;ust=1681141910564916&amp;usg=AOvVaw2g6YEW-VsewLvq0haYTwMQ">https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms</a></span><span class="c2">) to connect to the database systems you now have the passwords for and to set up backdoor accounts or browse around to see (and show) what&rsquo;s available. Practically every unprotected SQL Server system I come across has sensitive personal financial or healthcare information available for the taking. It simply takes a query such as the following to access the records in any given table:</span></p><p class="c6 c31"><span class="c12">select * from </span><span class="c12 c26">tablename</span></p><h3 class="c16" id="h.ve51azhkbu8e"><span class="c14">Scanning databases for vulnerabilities</span></h3><p class="c6"><span class="c2">As with operating systems and web applications, some database-specific vulnerabilities can be rooted out only by using the right tools. I use Nexpose to find such issues as the following:</span></p><ul class="c19 lst-kix_fcwam7tej5g7-0 start"><li class="c5 li-bullet-0"><span class="c8">Buffer overflows</span></li><li class="c5 li-bullet-0"><span class="c8">Privilege escalations</span></li><li class="c5 li-bullet-0"><span class="c8">Password hashes accessible through default/unprotected accounts</span></li><li class="c5 li-bullet-0"><span class="c8">Weak authentication methods enabled</span></li></ul><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;A great all-in-one commercial database vulnerability scanner for performing in-depth database checks &mdash; including user-rights audits in SQL Server, Oracle, and so on &mdash; is AppDetectivePRO (</span><span class="c3"><a class="c10" href="https://www.google.com/url?q=http://www.trustwave.com/en-us/services/database-security/appdetectivepro/&amp;sa=D&amp;source=editors&amp;ust=1681141910566215&amp;usg=AOvVaw3V-0KyxolAWzca1_S-yMsM">www.trustwave.com/en-us/services/database-security/appdetectivepro/</a></span><span class="c2">). AppDetectivePRO can be a good addition to your security testing tool arsenal if you can justify the investment.</span></p><p class="c6"><span class="c2">Many vulnerabilities can be tested from both an unauthenticated outsider&rsquo;s perspective as well as a trusted insider&rsquo;s perspective. The important thing is to review the security of your databases from as many angles as reasonably possible. As I&rsquo;ve said before, if a database is out there and accessible, people are going to play with it.</span></p><h2 class="c16" id="h.vlms9h5quhv3"><span class="c13">Following Best Practices for Minimizing Database Security Risks</span></h2><p class="c6"><span class="c2">Keeping your databases secure is fairly simple if you do the following things:</span></p><ul class="c19 lst-kix_xkhi8rgu6wzw-0 start"><li class="c0 li-bullet-0"><span class="c8">Run your databases on dedicated servers (or workstations where necessary).</span></li><li class="c0 li-bullet-0"><span class="c17">Check the underlying operating systems for security vulnerabilities. (I cover operating system (OS) exploits for Windows and Linux in </span><span class="c9"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c12.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910567157&amp;usg=AOvVaw0zLrTrf5pVXRtxPQRLBlXW">chapters 12</a></span><span class="c17">&nbsp;and </span><span class="c9"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c13.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910567485&amp;usg=AOvVaw1cFoWSisQr_-8JsCmKVIAZ">13</a></span><span class="c8">, respectively.)</span></li><li class="c0 li-bullet-0"><span class="c8">Ensure that your databases fall within the scope of ongoing vulnerability scanning, patching, and system hardening.</span></li><li class="c0 li-bullet-0"><span class="c8">Seek out and replace (or otherwise segment off) end-of-life database systems. They&rsquo;re just too risky to leave around.</span></li><li class="c0 li-bullet-0"><span class="c8">Require strong passwords on every database system. Use multifactor authentication (MFA), too, because it can fill in the known gaps with traditional passwords. Most enterprise-ready databases, such as Oracle and SQL Server, allow you to use domain authentication (such as Active Directory or LDAP) so that you can tie in your existing domain policy and user accounts, including MFA, without having to worry about managing a separate set of credentials.</span></li><li class="c0 li-bullet-0"><span class="c8">Use appropriate file and share permissions to keep prying eyes away.</span></li><li class="c0 li-bullet-0"><span class="c8">De-identify any sensitive production data before it&rsquo;s used in nonproduction environments such as development or quality assurance.</span></li><li class="c0 li-bullet-0"><span class="c17">Check your web applications for SQL injection and related input validation vulnerabilities. (I cover web application security in </span><span class="c9"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c15.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910568585&amp;usg=AOvVaw3_76NyY2bCrlY_x7LhYPVe">Chapter 15</a></span><span class="c8">.)</span></li><li class="c0 li-bullet-0"><span class="c17">Use a network firewall, such as the type available from Fortinet (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.fortinet.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910569014&amp;usg=AOvVaw0jHRGVimfQaaJ6pa7otbY8">www.fortinet.com</a></span><span class="c17">) or WatchGuard (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.watchguard.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910569337&amp;usg=AOvVaw2viilx6O3Qxhn4yhYYc8zB">www.watchguard.com/</a></span><span class="c17">) and database-specific controls, such as those available from Imperva (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.imperva.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910569646&amp;usg=AOvVaw2-cgN1q02wP3upEv3KFX6b">www.imperva.com</a></span><span class="c17">) and IDERA (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.idera.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910569913&amp;usg=AOvVaw1sfGFmCVi9CMnVdEizsTYn">www.idera.com</a></span><span class="c8">).</span></li><li class="c0 li-bullet-0"><span class="c17">Perform related database hardening and management by using a tool such as Qualys Security Configuration Assessment (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=https://www.qualys.com/apps/security-configuration-assessment&amp;sa=D&amp;source=editors&amp;ust=1681141910570373&amp;usg=AOvVaw3gOk06PPNCqSd_33Ab4fRw">https://www.qualys.com/apps/security-configuration-assessment</a></span><span class="c17">) as well as the benchmarks provided by the Center for Internet Security (</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.cisecurity.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910570708&amp;usg=AOvVaw1_aK3RVSzKIrpdUmtcWzT5">www.cisecurity.com</a></span><span class="c8">).</span></li><li class="c0 li-bullet-0"><span class="c8">Run the latest version of database server software. The new security features in Oracle and SQL Server are great advancements toward better database security for on-premise databases as well as those in the cloud.</span></li></ul><h2 class="c16" id="h.eurcx5dx83cm"><span class="c13">Opening Up About Storage Systems</span></h2><p class="c6"><span class="c2">Attackers are carrying out a growing number of storage-related hacks and using various attack vectors and tools to break into the storage environment. (Surely you know what I&rsquo;m going to say next.) Therefore, you need to get to know the techniques and tools yourself and use them to test your own storage environment.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Warning" src="images/image1.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;A lot of misconceptions and myths are related to the security of such storage systems as Fibre Channel and iSCSI Storage Area Networks (SANs), CIFS, and NFS-based Network Attached Storage (NAS) systems, and so on. Many network and storage administrators believe that encryption or RAID equals storage security, an external attacker can&rsquo;t reach the company&rsquo;s storage environment, the company&rsquo;s systems are resilient, or security is handled elsewhere. All these beliefs are very dangerous, and I&rsquo;m confident that more attacks will target critical storage systems.</span></p><p class="c6"><span class="c2">As with databases, practically every business has some sort of network storage housing sensitive information that it can&rsquo;t afford to lose. For that reason, it&rsquo;s important to include both network storage (SAN and NAS systems) and traditional file shares in the scope of your security testing.</span></p><h3 class="c16" id="h.ix5gefkk3ayk"><span class="c14">Choosing tools</span></h3><p class="c6"><span class="c2">These are my favorite tools for testing storage security:</span></p><ul class="c19 lst-kix_ifa863wz6ytj-0 start"><li class="c5 li-bullet-0"><span class="c1">nmap</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://nmap.org/&amp;sa=D&amp;source=editors&amp;ust=1681141910572190&amp;usg=AOvVaw0cXfXzupTjJr7w8nCDvDEq">http://nmap.org</a></span><span class="c8">) for port scanning to find live storage hosts</span></li><li class="c5 li-bullet-0"><span class="c1">SoftPerfect Network Scanner</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.softperfect.com/products/networkscanner&amp;sa=D&amp;source=editors&amp;ust=1681141910572619&amp;usg=AOvVaw0dKJ49iKw06BaFGGE3_5br">www.softperfect.com/products/networkscanner</a></span><span class="c8">) for finding open and unprotected shares</span></li><li class="c5 li-bullet-0"><span class="c1">FileLocator Pro</span><span class="c17">&nbsp;(</span><span class="c4"><a class="c10" href="https://www.google.com/url?q=http://www.mythicsoft.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910573056&amp;usg=AOvVaw2AmUrpDJLAEDHxbRqjtmhS">www.mythicsoft.com</a></span><span class="c8">) for finding specific files and information</span></li><li class="c5 li-bullet-0"><span class="c1">Nessus</span><span class="c8">&nbsp;for performing in-depth vulnerability scans</span></li></ul><h3 class="c16" id="h.s3k3gf9wndmp"><span class="c14">Finding storage systems on the network</span></h3><p class="c6"><span class="c2">To seek out storage-related vulnerabilities, you first have to figure out what&rsquo;s where. The best way to get rolling is to use a port scanner and, ideally, an all-in-one vulnerability scanner such as Nessus or LanGuard. Also, given the fact that many storage servers have built-in web servers, you can use such tools as Acunetix Web Vulnerability Scanner and Netsparker to uncover web-based flaws. You can use these vulnerability scanners to gain good insight into areas that need further inspection, such as weak authentication, unpatched operating systems, and cross-site scripting.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;A commonly overlooked storage vulnerability is that many storage systems can be accessed from both the demilitarized zone (DMZ) segment and the internal network segment(s). This vulnerability poses risks to both sides of the network. Be sure to check manually to see whether you can reach the DMZ from the internal network and vice versa.</span></p><p class="c6"><span class="c7">You can also perform basic file permission and share scans (as outlined in </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c12.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910574250&amp;usg=AOvVaw2aA6a-aP5FtFQsooIzT14c">Chapter 12</a></span><span class="c7">) in conjunction with a text search tool to uncover sensitive information that no one on the network should have access to. Digging down further, a quick means for finding open network shares is to use SoftPerfect Network Scanner&rsquo;s share scanning capabilities, as shown in </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141910574632&amp;usg=AOvVaw2XNiYsWh6v_P_wAgDkEAuW">Figure 16-3</a></span><span class="c2">.</span></p><p class="c6"><span class="c7">As you can see in </span><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141910575105&amp;usg=AOvVaw35KMZe_MrpKh8ySRti_G3o">Figure 16-3</a></span><span class="c2">, Network Scanner enables you to perform a security and security permission scan for all devices or simply folders. I recommend selecting Specific Account in the Authentication section and then clicking Manage so that you can enter a domain account for the network that has general user permissions. This technique provides a good level of access to determine which shares are accessible.</span></p><p class="c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 506.67px; height: 466.67px;"><img alt="Snapshot shows Using SoftPerfect Network Scanner to search for network shares." src="images/image8.png" style="width: 506.67px; height: 466.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c35"><span class="c18"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23rc16-fig-0003&amp;sa=D&amp;source=editors&amp;ust=1681141910575766&amp;usg=AOvVaw3FMR9EX9wJ0QNgLWJXcnnQ">FIGURE 16-3:</a></span><span class="c23">&nbsp;Using SoftPerfect Network Scanner to search for network shares.</span></p><p class="c6"><span class="c2">When Network Scanner completes its scan, the shares showing Everyone in the Shared Folder Security column are the shares that need attention. I rarely complete a security assessment without coming across such shares open to the Windows Everyone group. Just as common is seeing the directories and files within these shares that are accessible to any logged-in Windows user to open, modify, delete, and do whatever else they please. How&rsquo;s that for accountability?</span></p><h3 class="c16" id="h.t0p215j4wht5"><span class="c14">Rooting out sensitive text in network files</span></h3><p class="c6"><span class="c7">When you find open network shares, scan for sensitive information stored in files such as </span><span class="c12">.pdf</span><span class="c7">, </span><span class="c12">.docx</span><span class="c7">, and </span><span class="c12">.xlsx</span><span class="c7">&nbsp;files. The process is as simple as using a text search utility such as FileLocator Pro. Alternatively, you can use Windows Explorer or the </span><span class="c12">find</span><span class="c2">&nbsp;command in Linux to scan for sensitive information, but that process is too slow and cumbersome for my liking.</span></p><p class="c6"><span class="c7">You&#39;ll be </span><span class="c7 c30">amazed</span><span class="c2">&nbsp;by what you come across stored insecurely on users&rsquo; desktops, server shares, and more, such as the following:</span></p><ul class="c19 lst-kix_scf1iqo0c4t0-0 start"><li class="c5 li-bullet-0"><span class="c8">Employee health records</span></li><li class="c5 li-bullet-0"><span class="c8">Customer credit card numbers</span></li><li class="c5 li-bullet-0"><span class="c8">Corporate financial reports</span></li><li class="c5 li-bullet-0"><span class="c8">Source code</span></li><li class="c5 li-bullet-0"><span class="c8">Master database files</span></li></ul><p class="c6"><span class="c2">The sky&rsquo;s the limit. Such sensitive information should be protected by good business practices, and it&rsquo;s also governed by state, federal, and international regulations, so make sure that you find it and secure it.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Tip" src="images/image5.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c7">&nbsp;Do your searches for sensitive text while you&rsquo;re logged in to the local system or domain as a regular user &mdash; </span><span class="c7 c30">not</span><span class="c2">&nbsp;as an administrator. This practice gives you a better view of regular users who have unauthorized access to sensitive files and shares that you thought were secure. When using a basic text search tool such as FileLocator Pro, look for the following text strings:</span></p><ul class="c19 lst-kix_vxawk0r7ghg6-0 start"><li class="c5 li-bullet-0"><span class="c8">DOB (for dates of birth)</span></li><li class="c5 li-bullet-0"><span class="c8">SSN (for Social Security numbers)</span></li><li class="c5 li-bullet-0"><span class="c8">License (for driver&rsquo;s-license information)</span></li><li class="c5 li-bullet-0"><span class="c8">Credit or CCV (for credit-card numbers)</span></li></ul><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Remember" src="images/image4.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Don&rsquo;t forget about your mobile devices when seeking sensitive, unprotected information. Everything from laptops to USB drives to external hard drives is fair game to the bad guys. A misplaced or stolen system can create a costly data breach. The same can be said for cloud-based file-sharing services such as OneDrive and Sharefile.</span></p><p class="c6"><span class="c2">The possibilities for information exposure are endless. Start with the basics, and peek only into common files that you know may have some juicy info in them. Limiting your search to these files will save you a ton of time:</span></p><ul class="c19 lst-kix_r4i0qesc268h-0 start"><li class="c5 li-bullet-0"><span class="c25">.txt</span></li><li class="c5 li-bullet-0"><span class="c34">.doc</span><span class="c17">&nbsp;and </span><span class="c25">.docx</span></li><li class="c5 li-bullet-0"><span class="c25">.rtf</span></li><li class="c5 li-bullet-0"><span class="c34">.xls</span><span class="c17">&nbsp;and </span><span class="c25">.xlsx</span></li><li class="c5 li-bullet-0"><span class="c25">.pdf</span></li></ul><p class="c6"><span class="c15"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23c16-fig-0004&amp;sa=D&amp;source=editors&amp;ust=1681141910579304&amp;usg=AOvVaw1iHg1g_xdDptDxj7VaOETJ">Figure 16-4</a></span><span class="c2">&nbsp;shows a basic text search with FileLocator Pro. Notice the files located on different parts of the server.</span></p><p class="c6"><span class="c7">FileLocator Pro can also search for content inside </span><span class="c12">.pdf</span><span class="c2">&nbsp;files to uncover sensitive data.</span></p><p class="c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 580.00px; height: 390.67px;"><img alt="Snapshot shows Using FileLocator Pro to search for sensitive text on unprotected shares." src="images/image3.png" style="width: 580.00px; height: 390.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c35"><span class="c18"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c16.xhtml%23rc16-fig-0004&amp;sa=D&amp;source=editors&amp;ust=1681141910580117&amp;usg=AOvVaw3gFRb74RMtSakjfWuojOLt">FIGURE 16-4:</a></span><span class="c23">&nbsp;Using FileLocator Pro to search for sensitive text on unprotected shares.</span></p><p class="c6"><span class="c7">You might also consider checking out Spirion&#39;s Sensitive Data Manager (</span><span class="c3"><a class="c10" href="https://www.google.com/url?q=https://www.spirion.com/&amp;sa=D&amp;source=editors&amp;ust=1681141910580518&amp;usg=AOvVaw2jleZByFLovHKowV94vYOI">https://www.spirion.com</a></span><span class="c2">). This product, formerly known as IdentityFinder and since rolled into the company&rsquo;s enterprise data discovery platform, is a neat tool designed for scanning storage devices for sensitive, personally identifiable information. It can also search inside binary files such as PDFs.</span></p><p class="c6"><span class="c2">For a second round of testing, you could perform your searches while logged in as an administrator. You&rsquo;re likely to find a lot of sensitive information scattered about. It might seem worthless at first, but it can highlight sensitive information stored in places where it shouldn&rsquo;t be stored or where network administrators shouldn&rsquo;t have access.</span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 60.00px; height: 78.67px;"><img alt="Remember" src="images/image4.png" style="width: 60.00px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;Testing is highly dependent on timing, searching for the right keywords, and looking at the right systems on the network. You likely won&rsquo;t root out every single bit of sensitive information, but this effort shows you where certain problems are, which helps you justify the need for stronger access controls and for better IT and security management processes.</span></p><h2 class="c16" id="h.qx7ea2dddao"><span class="c13">Following Best Practices for Minimizing Storage Security Risks</span></h2><p class="c6"><span class="c2">Like database security, storage security isn&rsquo;t brain surgery. Keeping your storage systems secure is simple, too, if you do the following things:</span></p><ul class="c19 lst-kix_lzu3wmofz0ag-0 start"><li class="c0 li-bullet-0"><span class="c17">Check the underlying operating systems for security vulnerabilities. I cover operating system exploits for Windows and Linux in </span><span class="c9"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c12.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910581573&amp;usg=AOvVaw263nXAfvYF2z1_hHy4_qcy">Chapters 12</a></span><span class="c17">&nbsp;and </span><span class="c9"><a class="c10" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-for-dummies/9781119872191/c13.xhtml&amp;sa=D&amp;source=editors&amp;ust=1681141910581914&amp;usg=AOvVaw0gQRmSazUeBHMQ22vuDjA3">13</a></span><span class="c8">.</span></li><li class="c0 li-bullet-0"><span class="c8">Ensure that your network storage (SAN and NAS systems) falls within the scope of patching and system hardening.</span></li><li class="c0 li-bullet-0"><span class="c8">Require strong passwords on every storage management interface.</span></li><li class="c0 li-bullet-0"><span class="c8">Use appropriate file and share permissions to keep prying eyes away.</span></li><li class="c0 li-bullet-0"><span class="c8">Use MFA on all critical systems and accounts.</span></li><li class="c0 li-bullet-0"><span class="c8">Educate your users on where to store sensitive information and the risks of mishandling it.</span></li><li class="c0 li-bullet-0"><span class="c8">De-identify any sensitive production data before it&rsquo;s used in development or quality assurance, using tools made for this purpose.</span></li><li class="c0 li-bullet-0"><span class="c8">Use a network access control lists or a firewall to ensure that only the people and systems with a business need to access your storage environment can do so &mdash; and do nothing more.</span></li></ul><p class="c28"><span class="c11"></span></p></body></html>