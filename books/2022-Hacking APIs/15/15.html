<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_ka1qbfkkzkpq-7{list-style-type:none}.lst-kix_qtpo7t81h9e8-7>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-7}ol.lst-kix_ka1qbfkkzkpq-8{list-style-type:none}.lst-kix_7llute2i4x9u-0>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-0,decimal) ". "}.lst-kix_7llute2i4x9u-2>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-2,lower-roman) ". "}ol.lst-kix_ka1qbfkkzkpq-3{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-7.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-7 0}ol.lst-kix_ka1qbfkkzkpq-4{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-5{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-6{list-style-type:none}.lst-kix_7llute2i4x9u-3>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-3,decimal) ". "}ol.lst-kix_ka1qbfkkzkpq-0{list-style-type:none}.lst-kix_exfeg2j6iqyd-6>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-6}ol.lst-kix_ka1qbfkkzkpq-1{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-2{list-style-type:none}.lst-kix_7llute2i4x9u-1>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-1,lower-latin) ". "}ol.lst-kix_1dig9kri0ggp-4.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-4 0}.lst-kix_jltigrvo69ye-6>li:before{content:"\0025cf  "}ol.lst-kix_qtpo7t81h9e8-6.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-6 0}.lst-kix_jltigrvo69ye-7>li:before{content:"\0025cb  "}.lst-kix_jltigrvo69ye-8>li:before{content:"\0025a0  "}ol.lst-kix_ka1qbfkkzkpq-1.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-1 0}.lst-kix_jltigrvo69ye-5>li:before{content:"\0025a0  "}.lst-kix_jltigrvo69ye-4>li:before{content:"\0025cb  "}ol.lst-kix_exfeg2j6iqyd-2.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-2 0}ol.lst-kix_exfeg2j6iqyd-8.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-8 0}.lst-kix_jltigrvo69ye-2>li:before{content:"\0025a0  "}.lst-kix_exfeg2j6iqyd-8>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-8}.lst-kix_jltigrvo69ye-1>li:before{content:"\0025cb  "}.lst-kix_jltigrvo69ye-3>li:before{content:"\0025cf  "}.lst-kix_7llute2i4x9u-8>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-8,lower-roman) ". "}.lst-kix_7llute2i4x9u-7>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-7,lower-latin) ". "}ol.lst-kix_qtpo7t81h9e8-0.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-0 0}.lst-kix_7llute2i4x9u-4>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-4,lower-latin) ". "}.lst-kix_7llute2i4x9u-6>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-6,decimal) ". "}ol.lst-kix_mtu8i8leszxw-4.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-4 0}.lst-kix_jltigrvo69ye-0>li:before{content:"\0025cf  "}.lst-kix_mtu8i8leszxw-0>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-0}ol.lst-kix_7llute2i4x9u-1.start{counter-reset:lst-ctn-kix_7llute2i4x9u-1 0}.lst-kix_7llute2i4x9u-5>li:before{content:"" counter(lst-ctn-kix_7llute2i4x9u-5,lower-roman) ". "}.lst-kix_qtpo7t81h9e8-0>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-0,decimal) ". "}.lst-kix_ka1qbfkkzkpq-8>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-8}.lst-kix_7llute2i4x9u-0>li{counter-increment:lst-ctn-kix_7llute2i4x9u-0}ol.lst-kix_1dig9kri0ggp-5.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-5 0}.lst-kix_qtpo7t81h9e8-4>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-4,lower-latin) ". "}ol.lst-kix_7llute2i4x9u-7.start{counter-reset:lst-ctn-kix_7llute2i4x9u-7 0}.lst-kix_mtu8i8leszxw-7>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-7}.lst-kix_qtpo7t81h9e8-5>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-5,lower-roman) ". "}ol.lst-kix_7llute2i4x9u-0.start{counter-reset:lst-ctn-kix_7llute2i4x9u-0 0}.lst-kix_qtpo7t81h9e8-3>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-3,decimal) ". "}.lst-kix_1dig9kri0ggp-3>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-3}.lst-kix_qtpo7t81h9e8-2>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-2,lower-roman) ". "}.lst-kix_qtpo7t81h9e8-1>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-1,lower-latin) ". "}ul.lst-kix_y5hezsbtves9-8{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-1.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-1 0}ul.lst-kix_y5hezsbtves9-6{list-style-type:none}ol.lst-kix_7llute2i4x9u-6{list-style-type:none}ul.lst-kix_y5hezsbtves9-7{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-5.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-5 0}ol.lst-kix_7llute2i4x9u-5{list-style-type:none}ul.lst-kix_y5hezsbtves9-4{list-style-type:none}ol.lst-kix_7llute2i4x9u-8{list-style-type:none}ul.lst-kix_y5hezsbtves9-5{list-style-type:none}ol.lst-kix_7llute2i4x9u-7{list-style-type:none}ul.lst-kix_y5hezsbtves9-2{list-style-type:none}ol.lst-kix_7llute2i4x9u-2{list-style-type:none}ul.lst-kix_y5hezsbtves9-3{list-style-type:none}ol.lst-kix_7llute2i4x9u-1{list-style-type:none}ul.lst-kix_y5hezsbtves9-0{list-style-type:none}ol.lst-kix_7llute2i4x9u-4{list-style-type:none}ul.lst-kix_y5hezsbtves9-1{list-style-type:none}ol.lst-kix_7llute2i4x9u-3{list-style-type:none}.lst-kix_7llute2i4x9u-4>li{counter-increment:lst-ctn-kix_7llute2i4x9u-4}ol.lst-kix_ka1qbfkkzkpq-8.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-8 0}ol.lst-kix_exfeg2j6iqyd-7.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-7 0}.lst-kix_exfeg2j6iqyd-4>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-4}ol.lst-kix_7llute2i4x9u-6.start{counter-reset:lst-ctn-kix_7llute2i4x9u-6 0}ol.lst-kix_ka1qbfkkzkpq-2.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-2 0}ol.lst-kix_1dig9kri0ggp-0.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-0 0}ol.lst-kix_7llute2i4x9u-2.start{counter-reset:lst-ctn-kix_7llute2i4x9u-2 0}.lst-kix_ka1qbfkkzkpq-5>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-5,lower-roman) ". "}.lst-kix_mtu8i8leszxw-4>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-4}ol.lst-kix_mtu8i8leszxw-5.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-5 0}ol.lst-kix_exfeg2j6iqyd-0{list-style-type:none}.lst-kix_ka1qbfkkzkpq-7>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-7,lower-latin) ". "}ol.lst-kix_exfeg2j6iqyd-2{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-3.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-3 0}.lst-kix_7llute2i4x9u-8>li{counter-increment:lst-ctn-kix_7llute2i4x9u-8}ol.lst-kix_exfeg2j6iqyd-1{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-4{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-3{list-style-type:none}ol.lst-kix_7llute2i4x9u-0{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-6{list-style-type:none}.lst-kix_mtu8i8leszxw-5>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-5}ol.lst-kix_exfeg2j6iqyd-5{list-style-type:none}ol.lst-kix_7llute2i4x9u-5.start{counter-reset:lst-ctn-kix_7llute2i4x9u-5 0}ol.lst-kix_exfeg2j6iqyd-8{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-7{list-style-type:none}ul.lst-kix_jyigqe3fy08m-0{list-style-type:none}.lst-kix_mtu8i8leszxw-6>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-6}.lst-kix_exfeg2j6iqyd-2>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-2}.lst-kix_qtpo7t81h9e8-6>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-6,decimal) ". "}.lst-kix_qtpo7t81h9e8-8>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-8,lower-roman) ". "}ol.lst-kix_1dig9kri0ggp-3.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-3 0}.lst-kix_1dig9kri0ggp-5>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-5}ol.lst-kix_1dig9kri0ggp-7{list-style-type:none}ol.lst-kix_1dig9kri0ggp-8{list-style-type:none}ol.lst-kix_1dig9kri0ggp-5{list-style-type:none}ol.lst-kix_1dig9kri0ggp-6{list-style-type:none}ol.lst-kix_1dig9kri0ggp-3{list-style-type:none}.lst-kix_qtpo7t81h9e8-0>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-0}ol.lst-kix_1dig9kri0ggp-4{list-style-type:none}ol.lst-kix_1dig9kri0ggp-1{list-style-type:none}ol.lst-kix_1dig9kri0ggp-2{list-style-type:none}ol.lst-kix_1dig9kri0ggp-0{list-style-type:none}.lst-kix_ka1qbfkkzkpq-6>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-6}.lst-kix_ab38c4514qrz-1>li:before{content:"\0025cb  "}.lst-kix_jyigqe3fy08m-4>li:before{content:"\0025cb  "}.lst-kix_ab38c4514qrz-3>li:before{content:"\0025cf  "}.lst-kix_exfeg2j6iqyd-3>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-3}ol.lst-kix_ka1qbfkkzkpq-5.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-5 0}ol.lst-kix_mtu8i8leszxw-3.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-3 0}ol.lst-kix_7llute2i4x9u-4.start{counter-reset:lst-ctn-kix_7llute2i4x9u-4 0}.lst-kix_jyigqe3fy08m-6>li:before{content:"\0025cf  "}.lst-kix_1dig9kri0ggp-1>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-1,lower-latin) ". "}.lst-kix_qtpo7t81h9e8-5>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-5}.lst-kix_ab38c4514qrz-7>li:before{content:"\0025cb  "}.lst-kix_ab38c4514qrz-5>li:before{content:"\0025a0  "}ol.lst-kix_1dig9kri0ggp-2.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-2 0}.lst-kix_jyigqe3fy08m-0>li:before{content:"\0025cf  "}ol.lst-kix_qtpo7t81h9e8-1.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-1 0}.lst-kix_ka1qbfkkzkpq-1>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-1}.lst-kix_jyigqe3fy08m-2>li:before{content:"\0025a0  "}.lst-kix_mtu8i8leszxw-3>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-3,decimal) ". "}ol.lst-kix_ka1qbfkkzkpq-6.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-6 0}ol.lst-kix_7llute2i4x9u-3.start{counter-reset:lst-ctn-kix_7llute2i4x9u-3 0}.lst-kix_1dig9kri0ggp-4>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-4}ol.lst-kix_1dig9kri0ggp-1.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-1 0}.lst-kix_ka1qbfkkzkpq-7>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-7}.lst-kix_1dig9kri0ggp-5>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-5,lower-roman) ". "}.lst-kix_mtu8i8leszxw-1>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-1,lower-latin) ". "}.lst-kix_1dig9kri0ggp-3>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-3,decimal) ". "}.lst-kix_7llute2i4x9u-2>li{counter-increment:lst-ctn-kix_7llute2i4x9u-2}ol.lst-kix_mtu8i8leszxw-2.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-2 0}.lst-kix_ka1qbfkkzkpq-3>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-3,decimal) ". "}ol.lst-kix_qtpo7t81h9e8-2.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-2 0}.lst-kix_mtu8i8leszxw-7>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-7,lower-latin) ". "}.lst-kix_jyigqe3fy08m-8>li:before{content:"\0025a0  "}.lst-kix_mtu8i8leszxw-5>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-5,lower-roman) ". "}.lst-kix_1dig9kri0ggp-7>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-7,lower-latin) ". "}.lst-kix_ka1qbfkkzkpq-1>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-1,lower-latin) ". "}.lst-kix_y5hezsbtves9-1>li:before{content:"\0025cb  "}.lst-kix_7llute2i4x9u-3>li{counter-increment:lst-ctn-kix_7llute2i4x9u-3}ol.lst-kix_mtu8i8leszxw-1.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-1 0}ol.lst-kix_mtu8i8leszxw-7{list-style-type:none}ol.lst-kix_mtu8i8leszxw-8{list-style-type:none}.lst-kix_y5hezsbtves9-2>li:before{content:"\0025a0  "}ol.lst-kix_mtu8i8leszxw-3{list-style-type:none}ol.lst-kix_mtu8i8leszxw-4{list-style-type:none}ol.lst-kix_mtu8i8leszxw-5{list-style-type:none}ol.lst-kix_mtu8i8leszxw-6{list-style-type:none}.lst-kix_y5hezsbtves9-7>li:before{content:"\0025cb  "}ol.lst-kix_mtu8i8leszxw-0{list-style-type:none}ol.lst-kix_mtu8i8leszxw-1{list-style-type:none}.lst-kix_y5hezsbtves9-0>li:before{content:"\0025cf  "}.lst-kix_y5hezsbtves9-8>li:before{content:"\0025a0  "}ol.lst-kix_mtu8i8leszxw-2{list-style-type:none}.lst-kix_aufcu529ytzc-3>li:before{content:"\0025cf  "}.lst-kix_aufcu529ytzc-1>li:before{content:"\0025cb  "}.lst-kix_aufcu529ytzc-2>li:before{content:"\0025a0  "}.lst-kix_y5hezsbtves9-6>li:before{content:"\0025cf  "}.lst-kix_y5hezsbtves9-5>li:before{content:"\0025a0  "}.lst-kix_aufcu529ytzc-0>li:before{content:"\0025cf  "}.lst-kix_1dig9kri0ggp-0>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-0}.lst-kix_y5hezsbtves9-3>li:before{content:"\0025cf  "}.lst-kix_y5hezsbtves9-4>li:before{content:"\0025cb  "}.lst-kix_qtpo7t81h9e8-8>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-8}ol.lst-kix_1dig9kri0ggp-7.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-7 0}ol.lst-kix_exfeg2j6iqyd-5.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-5 0}.lst-kix_exfeg2j6iqyd-1>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-1,lower-latin) ". "}.lst-kix_exfeg2j6iqyd-2>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-2,lower-roman) ". "}ol.lst-kix_mtu8i8leszxw-7.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-7 0}.lst-kix_exfeg2j6iqyd-0>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-0,decimal) ". "}.lst-kix_exfeg2j6iqyd-4>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-4,lower-latin) ". "}.lst-kix_exfeg2j6iqyd-5>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-5,lower-roman) ". "}.lst-kix_exfeg2j6iqyd-6>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-6,decimal) ". "}.lst-kix_exfeg2j6iqyd-7>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-7,lower-latin) ". "}ol.lst-kix_qtpo7t81h9e8-3.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-3 0}ol.lst-kix_ka1qbfkkzkpq-4.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-4 0}.lst-kix_ka1qbfkkzkpq-0>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-0}.lst-kix_exfeg2j6iqyd-5>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-5}.lst-kix_aufcu529ytzc-4>li:before{content:"\0025cb  "}.lst-kix_1dig9kri0ggp-2>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-2}ul.lst-kix_aufcu529ytzc-5{list-style-type:none}.lst-kix_aufcu529ytzc-5>li:before{content:"\0025a0  "}.lst-kix_aufcu529ytzc-6>li:before{content:"\0025cf  "}ul.lst-kix_aufcu529ytzc-6{list-style-type:none}.lst-kix_qtpo7t81h9e8-6>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-6}ul.lst-kix_aufcu529ytzc-7{list-style-type:none}ul.lst-kix_aufcu529ytzc-8{list-style-type:none}.lst-kix_aufcu529ytzc-7>li:before{content:"\0025cb  "}.lst-kix_aufcu529ytzc-8>li:before{content:"\0025a0  "}.lst-kix_exfeg2j6iqyd-3>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-3,decimal) ". "}ol.lst-kix_qtpo7t81h9e8-4.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-4 0}ol.lst-kix_mtu8i8leszxw-6.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-6 0}.lst-kix_ka1qbfkkzkpq-2>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-2}.lst-kix_qtpo7t81h9e8-4>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-4}.lst-kix_mtu8i8leszxw-1>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-1}.lst-kix_7llute2i4x9u-1>li{counter-increment:lst-ctn-kix_7llute2i4x9u-1}ol.lst-kix_mtu8i8leszxw-0.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-0 0}ul.lst-kix_jyigqe3fy08m-1{list-style-type:none}ul.lst-kix_jyigqe3fy08m-2{list-style-type:none}ul.lst-kix_jyigqe3fy08m-3{list-style-type:none}ul.lst-kix_jyigqe3fy08m-4{list-style-type:none}ul.lst-kix_jyigqe3fy08m-5{list-style-type:none}ul.lst-kix_jyigqe3fy08m-6{list-style-type:none}.lst-kix_exfeg2j6iqyd-7>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-7}ul.lst-kix_jyigqe3fy08m-7{list-style-type:none}ol.lst-kix_exfeg2j6iqyd-0.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-0 0}ul.lst-kix_jyigqe3fy08m-8{list-style-type:none}.lst-kix_exfeg2j6iqyd-1>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-1}.lst-kix_7llute2i4x9u-7>li{counter-increment:lst-ctn-kix_7llute2i4x9u-7}ol.lst-kix_qtpo7t81h9e8-7{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-8{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-3{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-4{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-5{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-6{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-0{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-1{list-style-type:none}ol.lst-kix_qtpo7t81h9e8-2{list-style-type:none}ol.lst-kix_ka1qbfkkzkpq-0.start{counter-reset:lst-ctn-kix_ka1qbfkkzkpq-0 0}ul.lst-kix_jltigrvo69ye-5{list-style-type:none}ul.lst-kix_jltigrvo69ye-6{list-style-type:none}ul.lst-kix_jltigrvo69ye-3{list-style-type:none}ol.lst-kix_mtu8i8leszxw-8.start{counter-reset:lst-ctn-kix_mtu8i8leszxw-8 0}ul.lst-kix_jltigrvo69ye-4{list-style-type:none}ul.lst-kix_jltigrvo69ye-1{list-style-type:none}.lst-kix_qtpo7t81h9e8-1>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-1}ul.lst-kix_jltigrvo69ye-2{list-style-type:none}ul.lst-kix_jltigrvo69ye-0{list-style-type:none}.lst-kix_ka1qbfkkzkpq-4>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-4,lower-latin) ". "}.lst-kix_ka1qbfkkzkpq-5>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-5}.lst-kix_ka1qbfkkzkpq-6>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-6,decimal) ". "}.lst-kix_qtpo7t81h9e8-2>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-2}.lst-kix_1dig9kri0ggp-6>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-6}ol.lst-kix_exfeg2j6iqyd-6.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-6 0}.lst-kix_ka1qbfkkzkpq-8>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-8,lower-roman) ". "}.lst-kix_exfeg2j6iqyd-0>li{counter-increment:lst-ctn-kix_exfeg2j6iqyd-0}ul.lst-kix_jltigrvo69ye-7{list-style-type:none}ul.lst-kix_jltigrvo69ye-8{list-style-type:none}.lst-kix_mtu8i8leszxw-3>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-3}ol.lst-kix_1dig9kri0ggp-6.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-6 0}ol.lst-kix_qtpo7t81h9e8-7.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-7 0}ol.lst-kix_7llute2i4x9u-8.start{counter-reset:lst-ctn-kix_7llute2i4x9u-8 0}.lst-kix_ka1qbfkkzkpq-3>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-3}.lst-kix_qtpo7t81h9e8-7>li:before{content:"" counter(lst-ctn-kix_qtpo7t81h9e8-7,lower-latin) ". "}ul.lst-kix_ab38c4514qrz-0{list-style-type:none}.lst-kix_qtpo7t81h9e8-3>li{counter-increment:lst-ctn-kix_qtpo7t81h9e8-3}ul.lst-kix_ab38c4514qrz-5{list-style-type:none}ul.lst-kix_ab38c4514qrz-6{list-style-type:none}ul.lst-kix_ab38c4514qrz-7{list-style-type:none}ul.lst-kix_ab38c4514qrz-8{list-style-type:none}.lst-kix_1dig9kri0ggp-8>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-8}ul.lst-kix_ab38c4514qrz-1{list-style-type:none}ul.lst-kix_ab38c4514qrz-2{list-style-type:none}ul.lst-kix_ab38c4514qrz-3{list-style-type:none}.lst-kix_7llute2i4x9u-6>li{counter-increment:lst-ctn-kix_7llute2i4x9u-6}ul.lst-kix_ab38c4514qrz-4{list-style-type:none}.lst-kix_jyigqe3fy08m-3>li:before{content:"\0025cf  "}ol.lst-kix_exfeg2j6iqyd-4.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-4 0}.lst-kix_ab38c4514qrz-2>li:before{content:"\0025a0  "}.lst-kix_jyigqe3fy08m-7>li:before{content:"\0025cb  "}ul.lst-kix_aufcu529ytzc-1{list-style-type:none}ul.lst-kix_aufcu529ytzc-2{list-style-type:none}ul.lst-kix_aufcu529ytzc-3{list-style-type:none}ul.lst-kix_aufcu529ytzc-4{list-style-type:none}.lst-kix_jyigqe3fy08m-5>li:before{content:"\0025a0  "}.lst-kix_ab38c4514qrz-0>li:before{content:"\0025cf  "}.lst-kix_ab38c4514qrz-8>li:before{content:"\0025a0  "}ul.lst-kix_aufcu529ytzc-0{list-style-type:none}.lst-kix_1dig9kri0ggp-2>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-2,lower-roman) ". "}.lst-kix_7llute2i4x9u-5>li{counter-increment:lst-ctn-kix_7llute2i4x9u-5}.lst-kix_exfeg2j6iqyd-8>li:before{content:"" counter(lst-ctn-kix_exfeg2j6iqyd-8,lower-roman) ". "}.lst-kix_mtu8i8leszxw-2>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-2}.lst-kix_ab38c4514qrz-6>li:before{content:"\0025cf  "}.lst-kix_jyigqe3fy08m-1>li:before{content:"\0025cb  "}.lst-kix_1dig9kri0ggp-0>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-0,decimal) ". "}.lst-kix_ab38c4514qrz-4>li:before{content:"\0025cb  "}.lst-kix_mtu8i8leszxw-8>li{counter-increment:lst-ctn-kix_mtu8i8leszxw-8}.lst-kix_mtu8i8leszxw-4>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-4,lower-latin) ". "}.lst-kix_1dig9kri0ggp-1>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-1}.lst-kix_ka1qbfkkzkpq-4>li{counter-increment:lst-ctn-kix_ka1qbfkkzkpq-4}.lst-kix_mtu8i8leszxw-0>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-0,decimal) ". "}.lst-kix_mtu8i8leszxw-8>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-8,lower-roman) ". "}.lst-kix_mtu8i8leszxw-2>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-2,lower-roman) ". "}.lst-kix_1dig9kri0ggp-4>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-4,lower-latin) ". "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_exfeg2j6iqyd-3.start{counter-reset:lst-ctn-kix_exfeg2j6iqyd-3 0}.lst-kix_1dig9kri0ggp-7>li{counter-increment:lst-ctn-kix_1dig9kri0ggp-7}ol.lst-kix_qtpo7t81h9e8-8.start{counter-reset:lst-ctn-kix_qtpo7t81h9e8-8 0}.lst-kix_ka1qbfkkzkpq-2>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-2,lower-roman) ". "}ol.lst-kix_1dig9kri0ggp-8.start{counter-reset:lst-ctn-kix_1dig9kri0ggp-8 0}.lst-kix_1dig9kri0ggp-6>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-6,decimal) ". "}.lst-kix_ka1qbfkkzkpq-0>li:before{content:"" counter(lst-ctn-kix_ka1qbfkkzkpq-0,decimal) ". "}.lst-kix_mtu8i8leszxw-6>li:before{content:"" counter(lst-ctn-kix_mtu8i8leszxw-6,decimal) ". "}.lst-kix_1dig9kri0ggp-8>li:before{content:"" counter(lst-ctn-kix_1dig9kri0ggp-8,lower-roman) ". "}ol{margin:0;padding:0}table td,table th{padding:0}.c3{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c13{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c23{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c27{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c5{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-top-style:solid;background-color:#ffffff;margin-left:54pt;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c16{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c17{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman";font-style:italic}.c1{background-color:#eef2f6;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Courier New";font-style:normal}.c28{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c21{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:40.5pt;font-family:"Times New Roman";font-style:normal}.c25{background-color:#ffffff;color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:54pt;font-family:"Times New Roman";font-style:normal}.c19{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:23.5pt;font-family:"Times New Roman";font-style:normal}.c4{color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c26{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c7{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c10{color:#3d3b49;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14.5pt;font-family:"Times New Roman";font-style:normal}.c18{padding-top:24pt;padding-bottom:24pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c14{padding-top:18pt;padding-bottom:18pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c2{font-size:12pt;font-family:"Times New Roman";font-style:italic;color:#3d3b49;font-weight:400}.c20{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:700}.c12{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c24{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:400}.c8{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c11{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c29{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{color:inherit;text-decoration:inherit}.c22{padding:0;margin:0}.c6{text-indent:12pt}.c15{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c29 doc-content"><h1 class="c27" id="h.l7ogcii7blna"><span class="c25">15</span></h1><h1 class="c27" id="h.l7ogcii7blna-1"><span class="c21">DATA BREACHES AND BUG BOUNTIES</span></h1><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 610.67px; height: 800.00px;"><img alt="" src="images/image3.png" style="width: 610.67px; height: 800.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">The real-world API breaches and bounties covered in this chapter should illustrate how actual hackers have exploited API vulnerabilities, how vulnerabilities can be combined, and the significance of the weaknesses you might discover.</span></p><p class="c3 c6"><span class="c4">Remember that an app&rsquo;s security is only as strong as the weakest link. If you&rsquo;re facing the best firewalled, multifactor-based, zero-trust app but the blue team hasn&rsquo;t dedicated resources to securing their APIs, there is a security gap equivalent to the Death Star&rsquo;s thermal exhaust port. Moreover, these insecure APIs and exhaust ports are often intentionally exposed to the outside universe, offering a clear pathway to compromise and destruction. Use common API weaknesses like the following to your advantage when hacking.</span></p><h2 class="c13" id="h.5i4mogyfvn93"><span class="c19">The Breaches</span></h2><p class="c3"><span class="c11">After a data breach, leak, or exposure, people often point fingers and cast blame. I like to think of them instead as costly learning opportunities. To be clear, a </span><span class="c2">data breach</span><span class="c11">&nbsp;refers to a confirmed instance of a criminal exploiting a system to compromise the business or steal data. A </span><span class="c2">leak</span><span class="c11">&nbsp;or </span><span class="c2">exposure</span><span class="c4">&nbsp;is the discovery of a weakness that could have led to the compromise of sensitive information, but it isn&rsquo;t clear whether an attacker actually did compromise the data.</span></p><p class="c3 c6"><span class="c4">When data breaches take place, attackers generally don&rsquo;t disclose their findings, as the ones who brag online about the details of their conquests often end up arrested. The organizations that were breached also rarely disclose what happened, either because they are too embarrassed, they&rsquo;re protecting themselves from additional legal recourse, or (in the worst case) they don&rsquo;t know about it. For that reason, I will provide my own guess as to how these compromises took place.</span></p><h3 class="c13" id="h.cuasq5cylqv"><span class="c10">Peloton</span></h3><ol class="c22 lst-kix_mtu8i8leszxw-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Data quantity:</span><span class="c4">&nbsp;More than three million Peloton subscribers</span></li><li class="c5 li-bullet-0"><span class="c8">Type of data:</span><span class="c4">&nbsp;User IDs, locations, ages, genders, weights, and workout information</span></li></ol><p class="c3"><span class="c4">In early 2021, security researcher Jan Masters disclosed that unauthenticated API users could query the API and receive information for all other users. This data exposure is particularly interesting, as US president Joe Biden was an owner of a Peloton device at the time of the disclosure.</span></p><p class="c3 c6"><span class="c11">As a result of the API data exposure, attackers could use three different methods to obtain sensitive user data: sending a request to the </span><span class="c2">/stats/workouts/details</span><span class="c11">&nbsp;endpoint, sending requests to the </span><span class="c2">/api/user/search</span><span class="c4">&nbsp;feature, and making unauthenticated GraphQL requests.</span></p><h4 class="c13" id="h.fd3lzdhazezt"><span class="c7">The /stats/workouts/details Endpoint</span></h4><p class="c3"><span class="c4">This endpoint is meant to provide a user&rsquo;s workout details based on their ID. If a user wanted their data to be private, they could select an option that was supposed to conceal it. The privacy feature did not properly function, however, and the endpoint returned data to any consumer regardless of authorization.</span></p><p class="c3 c6"><span class="c4">By specifying user IDs in the POST request body, an attacker would receive a response that included the user&rsquo;s age, gender, username, workout ID, and Peloton ID, as well as a value indicating whether their profile was private:</span></p><p class="c0"><span class="c1">POST /stats/workouts/details HTTP/1.1</span></p><p class="c0"><span class="c1">Host: api.onepeloton.co.uk</span></p><p class="c0"><span class="c1">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0</span></p><p class="c0"><span class="c1">Accept: application/json, text/plain, */*</span></p><p class="c0"><span class="c1">--snip--</span></p><p class="c14"><span class="c1">{&quot;ids&quot;:[&quot;10001&quot;,&quot;10002&quot;,&quot;10003&quot;,&quot;10004&quot;,&quot;10005&quot;,&quot;10006&quot;,]}</span></p><p class="c3 c6"><span class="c4">The IDs used in the attack could be brute-forced or, better yet, gathered by using the web application, which would automatically populate user IDs.</span></p><h4 class="c13" id="h.pgz4her4ffoy"><span class="c7">User Search</span></h4><p class="c3"><span class="c11">User search features can easily fall prey to business logic flaws. A GET request to the </span><span class="c2">/api/user/search/:&lt;username&gt;</span><span class="c4">&nbsp;endpoint revealed the URL that led to the user&rsquo;s profile picture, location, ID, profile privacy status, and social information such as their number of followers. Anyone could use this data exposure feature.</span></p><h4 class="c13" id="h.baptrm7ft02k"><span class="c7">GraphQL</span></h4><p class="c3"><span class="c4">Several GraphQL endpoints allowed the attacker to send unauthenticated requests. A request like the following would provide a user&rsquo;s ID, username, and location:</span></p><p class="c0"><span class="c1">POST /graphql HTTP/1.1</span></p><p class="c0"><span class="c1">Host: gql-graphql-gateway.prod.k8s.onepeloton.com</span></p><p class="c0"><span class="c1">--snip--</span></p><p class="c0"><span class="c1">{&quot;query&quot;:</span></p><p class="c14"><span class="c24">&quot;query SharedTags($currentUserID: ID!) (\n &nbsp;User: user(id: &quot;currentUserID&quot;) (\r\n__typename\n &nbsp;id\r\n &nbsp;location\r\n &nbsp;)\r\n)&quot;. &quot;variables&quot;: ( &quot;currentUserID&quot;: &quot;</span><span class="c20">REDACTED</span><span class="c1">&quot;)}</span></p><p class="c3 c6"><span class="c11">By using the </span><span class="c12">REDACTED</span><span class="c8">&nbsp;</span><span class="c4">user ID as a payload position, an unauthenticated attacker could brute-force user IDs to obtain private user data.</span></p><p class="c3 c6"><span class="c4">The Peloton breach is a demonstration of how using APIs with an adversarial mindset can result in significant findings. It also goes to show that if an organization is not protecting one of its APIs, you should treat this as a rallying call to test its other APIs for weaknesses.</span></p><h3 class="c13" id="h.2t4bs7d3cmyo"><span class="c10">USPS Informed Visibility API</span></h3><ol class="c22 lst-kix_ka1qbfkkzkpq-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Data quantity:</span><span class="c4">&nbsp;Approximately 60 million exposed USPS users</span></li><li class="c5 li-bullet-0"><span class="c8">Type of data:</span><span class="c4">&nbsp;Email, username, real-time package updates, mailing address, phone number</span></li></ol><p class="c3"><span class="c11">In November 2018, </span><span class="c2">KrebsOnSecurity</span><span class="c11">&nbsp;broke the story that the US Postal Service (USPS) website had exposed the data of 60 million users. A USPS program called Informed Visibility made an API available to authenticated users so that consumers could have near real-time data about all mail. The only problem was that any USPS authenticated user with access to the API could query it for any USPS account details. To make things worse, the API accepted wildcard queries. This means an attacker could easily request the user data for, say, every Gmail user by using a query like this one: </span><span class="c2">/api/v1/find?email=*@gmail.com</span><span class="c4">.</span></p><p class="c3 c6"><span class="c4">Besides the glaring security misconfigurations and business logic vulnerabilities, the USPS API was also vulnerable to an excessive data exposure issue. When the data for an address was requested, the API would respond with all records associated with that address. A hacker could have detected the vulnerability by searching for various physical addresses and paying attention to the results. For example, a request like the following could have displayed the records of all current and past occupants of the address:</span></p><p class="c0"><span class="c1">POST /api/v1/container/status</span></p><p class="c0"><span class="c1">Token: UserA</span></p><p class="c0"><span class="c1">--snip--</span></p><p class="c0 c15"><span class="c1"></span></p><p class="c0"><span class="c1">{</span></p><p class="c0"><span class="c1">&quot;street&quot;: &quot;475 L&#39; Enfant Plaza SW&quot;,</span></p><p class="c0"><span class="c1">&quot;city&quot;: Washington DC&quot;</span></p><p class="c14"><span class="c1">}</span></p><p class="c3 c6"><span class="c4">An API with this sort of excessive data exposure might respond with something like this:</span></p><p class="c0"><span class="c1">{</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;&quot;street&quot;:&quot;475 L&#39; Enfant Plaza SW&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;&quot;City&quot;:&quot;Washington DC&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;&quot;customer&quot;: [</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;name&quot;:&quot;Rufus Shinra&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;username&quot;:&quot;novp4me&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;email&quot;:&quot;rufus@shinra.com&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;phone&quot;:&quot;123-456-7890&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;name&quot;:&quot;Professor Hojo&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;username&quot;:&quot;sep-father&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;email&quot;:&quot;prof@hojo.com&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;phone&quot;:&quot;102-202-3034&quot;,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p><p class="c14"><span class="c1">}</span></p><p class="c3 c6"><span class="c11">The USPS data exposure is a great example of why more organizations need API-focused security testing, whether that be through a bug bounty program or penetration testing. In fact, the Office of Inspector General of the Informed Visibility program had conducted vulnerability assessment a month prior to the release of the </span><span class="c2">KrebsOnSecurity</span><span class="c11">&nbsp;article. The assessors failed to mention anything about any APIs, and in the Office of Inspector General&rsquo;s &ldquo;Informed Visibility Vulnerability Assessment,&rdquo; the testers determined that &ldquo;overall, the IV web application encryption and authentication were secure&rdquo; (</span><span class="c17"><a class="c9" href="https://www.google.com/url?q=https://www.uspsoig.gov/sites/default/files/document-library-files/2018/IT-AR-19-001.pdf&amp;sa=D&amp;source=editors&amp;ust=1681144529133980&amp;usg=AOvVaw05TShKL0LU6vN2YeQaC03L">https://www.uspsoig.gov/sites/default/files/document-library-files/2018/IT-AR-19-001.pdf</a></span><span class="c4">). The public report also includes a description of the vulnerability-scanning tools used in order to test the web application that provided the USPS testers with false-negative results. This means that their tools assured them that nothing was wrong when in fact there were massive problems.</span></p><p class="c3 c6"><span class="c4">If any security testing had focused on the API, the testers would have discovered glaring business logic flaws and authentication weaknesses. The USPS data exposure shows how APIs have been overlooked as a credible attack vector and how badly they need to be tested with the right tools and techniques.</span></p><h3 class="c13" id="h.xw5r1g77gzd4"><span class="c10">T-Mobile API Breach</span></h3><ol class="c22 lst-kix_1dig9kri0ggp-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Data quantity:</span><span class="c4">&nbsp;More than two million T-Mobile customers</span></li><li class="c5 li-bullet-0"><span class="c8">Type of data:</span><span class="c4">&nbsp;Name, phone number, email, date of birth, account number, billing ZIP code</span></li></ol><p class="c3"><span class="c4">In August 2018, T-Mobile posted an advisory to its website stating that its cybersecurity team had &ldquo;discovered and shut down an unauthorized access to certain information.&rdquo; T-Mobile also alerted 2.3 million customers over text message that their data was exposed. By targeting one of T-Mobile&rsquo;s APIs, the attacker was able to obtain customer names, phone numbers, emails, dates of birth, account numbers, and billing ZIP codes.</span></p><p class="c3 c6"><span class="c4">As is often the case, T-Mobile has not publicly shared the specific details of the breach, but we can go out on a limb and make a guess. One year earlier, a YouTube user discovered and disclosed an API vulnerability that may have been similar to the vulnerability that was exploited. In a video titled &ldquo;T-Mobile Info Disclosure Exploit,&rdquo; user &ldquo;moim&rdquo; demonstrated how to exploit the T-Mobile Web Services Gateway API. This earlier vulnerability allowed a consumer to access data by using a single authorization token and then adding any user&rsquo;s phone number to the URL. The following is an example of the data returned from the request:</span></p><p class="c0"><span class="c1">implicitPermissions:</span></p><p class="c0"><span class="c1">0:</span></p><p class="c0"><span class="c1">user:</span></p><p class="c0"><span class="c1">IAMEmail:</span></p><p class="c0"><span class="c1">&quot;rafae1530116@yahoo.com&quot;</span></p><p class="c0"><span class="c1">userid:</span></p><p class="c0"><span class="c1">&quot;U-eb71e893-9cf5-40db-a638-8d7f5a5d20f0&quot;</span></p><p class="c0"><span class="c1">lines:</span></p><p class="c0"><span class="c1">0:</span></p><p class="c0"><span class="c1">accountStatus: &quot;A&quot;</span></p><p class="c0"><span class="c1">ban:</span></p><p class="c0"><span class="c1">&quot;958100286&quot;</span></p><p class="c0"><span class="c1">customerType: &quot;GMP_NM_P&quot;</span></p><p class="c0"><span class="c1">givenName: &quot;Rafael&quot;</span></p><p class="c0"><span class="c1">insi:</span></p><p class="c0"><span class="c1">&quot;310260755959157&quot;</span></p><p class="c0"><span class="c1">isLineGrantable: &quot;true&quot;</span></p><p class="c0"><span class="c1">msison:</span></p><p class="c0"><span class="c1">&quot;19152538993&quot;</span></p><p class="c0"><span class="c1">permissionType: &quot;inherited&quot;</span></p><p class="c0"><span class="c1">1:</span></p><p class="c0"><span class="c1">accountStatus: &quot;A&quot;</span></p><p class="c0"><span class="c1">ban:</span></p><p class="c0"><span class="c1">&quot;958100286&quot;</span></p><p class="c0"><span class="c1">customerType: &quot;GMP_NM_P&quot;</span></p><p class="c0"><span class="c1">givenName: &quot;Rafael&quot;</span></p><p class="c0"><span class="c1">imsi:</span></p><p class="c0"><span class="c1">&quot;310260755959157&quot;</span></p><p class="c0"><span class="c1">isLineGrantable: &quot;false&quot;</span></p><p class="c0"><span class="c1">msisdn:</span></p><p class="c0"><span class="c1">&quot;19152538993&quot;</span></p><p class="c14"><span class="c1">permissionType: &quot;linked&quot;</span></p><p class="c3 c6"><span class="c11">As you look at the endpoint, I hope some API vulnerabilities are already coming to mind. If you can search for your own information using the </span><span class="c12">msisdn</span><span class="c2">&nbsp;</span><span class="c4">parameter, can you use it to search for other phone numbers? Indeed, you can! This is a BOLA vulnerability. What&rsquo;s worse, phone numbers are very predictable and often publicly available. In the exploit video, moim takes a random T-Mobile phone number from a dox attack on Pastebin and successfully obtains that customer&rsquo;s information.</span></p><p class="c3 c6"><span class="c4">This attack is only a proof of concept, but it has room for improvement. If you find an issue like this during an API test, I recommend working with the provider to obtain additional test accounts with separate phone numbers to avoid exposing actual customer data during your testing. Exploit the findings and then describe the impact a real attack could have on the client&rsquo;s environment, particularly if an attacker brute-forces phone numbers and breaches a significant amount of client data.</span></p><p class="c3 c6"><span class="c4">After all, if this API was the one responsible for the breach, the attacker could have easily brute-forced phone numbers to gather the 2.3 million that were leaked.</span></p><h2 class="c13" id="h.3lgnbe8l53bu"><span class="c19">The Bounties</span></h2><p class="c3"><span class="c4">Not only do bug bounty programs reward hackers for finding and reporting weaknesses that criminals would have otherwise compromised, but their write-ups are also an excellent source of API hacking lessons. If you pay attention to them, you might learn new techniques to use in your own testing. You can find write-ups on bug bounty platforms such as HackerOne and Bug Crowd or from independent sources like Pentester Land, ProgrammableWeb, and APIsecurity.io.</span></p><p class="c3 c6"><span class="c4">The reports I present here represent a small sample of the bounties out there. I selected these three examples to capture the diverse range of issues bounty hunters come across and the sorts of attacks they use. As you&rsquo;ll see, in some instances these hackers dive deep into an API by combining exploit techniques, following numerous leads, and implementing novel web application attacks. You can learn a lot from bounty hunters.</span></p><h3 class="c13" id="h.du3vrkx63ppe"><span class="c10">The Price of Good API Keys</span></h3><ol class="c22 lst-kix_qtpo7t81h9e8-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Bug bounty hunter:</span><span class="c4">&nbsp;Ace Candelario</span></li><li class="c5 li-bullet-0"><span class="c8">Bounty:</span><span class="c4">&nbsp;$2,000</span></li></ol><p class="c3"><span class="c11">Candelario began his bug hunt by investigating a JavaScript source file on his target, searching it for terms such as </span><span class="c2">api</span><span class="c11">, </span><span class="c2">secret</span><span class="c11">, and </span><span class="c2">key</span><span class="c4">&nbsp;that might have indicated a leaked secret. Indeed, he discovered an API key being used for BambooHR human resources software. As you can see in the JavaScript, the key was base64 encoded:</span></p><p class="c0"><span class="c1">function loadBambooHRUsers() {</span></p><p class="c0"><span class="c1">var uri = &#39;https://api.bamboohr.co.uk/api/gateway.php/example/v1/employees/directory&#39;);</span></p><p class="c0"><span class="c24">return $http.get(uri, { headers: {&#39;Authorization&#39;: &#39;Basic </span><span class="c20">VXNlcm5hbWU6UGFzc3dvcmQ=</span><span class="c1">&#39;};</span></p><p class="c14"><span class="c1">}</span></p><p class="c3 c6"><span class="c4">Because the code snippet includes the HR software endpoint as well, any attacker who discovered this code could try to pass this API key off as their own parameter in an API request to the endpoint. Alternatively, they could decode the base64-encoded key. In this example, you could do the following to see the encoded credentials:</span></p><p class="c0"><span class="c24">hAPIhacker@Kali:~$ </span><span class="c20">echo &#39;VXNlcm5hbWU6UGFzc3dvcmQ=&#39; | base64 -d</span></p><p class="c14"><span class="c1">Username:Password</span></p><p class="c3 c6"><span class="c4">At this point, you would likely already have a strong case for a vulnerability report. Still, you could go further. For example, you could attempt to use the credentials on the HR site to prove that you could access the target&rsquo;s sensitive employee data. Candelario did so and used a screen capture of the employee data as his proof of concept.</span></p><p class="c3 c6"><span class="c4">Exposed API keys like this one are an example of a broken authentication vulnerability, and you&rsquo;ll typically find them during API discovery. Bug bounty rewards for the discovery of these keys will depend on the severity of the attack in which they can be used.</span></p><p class="c3"><span class="c7">Lessons Learned</span></p><ul class="c22 lst-kix_y5hezsbtves9-0 start"><li class="c5 li-bullet-0"><span class="c4">Dedicate time to researching your target and discovering APIs.</span></li><li class="c5 li-bullet-0"><span class="c4">Always keep an eye out for credentials, secrets, and keys; then test what you can do with your findings.</span></li></ul><h3 class="c13" id="h.gh9xf6rvweda"><span class="c10">Private API Authorization Issues</span></h3><ol class="c22 lst-kix_7llute2i4x9u-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Bug bounty hunter:</span><span class="c4">&nbsp;Omkar Bhagwat</span></li><li class="c5 li-bullet-0"><span class="c8">Bounty:</span><span class="c4">&nbsp;$440</span></li></ol><p class="c3"><span class="c11">By performing directory enumeration, Bhagwat discovered an API and its documentation located at </span><span class="c2">academy.target.com/api/docs</span><span class="c11">. As an unauthenticated user, Omkar was able to find the API endpoints related to user and admin management. Moreover, when he sent a GET request for the </span><span class="c2">/ping </span><span class="c11">endpoint, Bhagwat noticed that the API responded to him without using any authorization tokens (see </span><span class="c17"><a class="c9" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c15.xhtml%23figure15-1&amp;sa=D&amp;source=editors&amp;ust=1681144529142058&amp;usg=AOvVaw3H04nqd5uWeTmfCFFdmaRC">Figure 15-1</a></span><span class="c4">). This piqued Bhagwat&rsquo;s interest in the API. He decided to thoroughly test its capabilities.</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 449.33px; height: 557.33px;"><img alt="Screenshot of API documentation for the /ping endpoint" src="images/image2.png" style="width: 449.33px; height: 557.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c23"><span class="c16">Figure 15-1</span><span class="c28">: An example Omkar Bhagwat provided for his bug bounty write-up that demonstrates the API responding to his /ping request with a &ldquo;pong&rdquo; response</span></p><p class="c3 c6"><span class="c4">While testing other endpoints, Bhagwat eventually received an API response containing the error &ldquo;authorization parameters are missing.&rdquo; He searched the site and found that many requests used an authorization Bearer token, which was exposed.</span></p><p class="c3 c6"><span class="c11">By adding that Bearer token to a request header, Bhagwat was able to edit user accounts (see </span><span class="c17"><a class="c9" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c15.xhtml%23figure15-2&amp;sa=D&amp;source=editors&amp;ust=1681144529143481&amp;usg=AOvVaw2NVqKaOwB1Ilw8bb9cymX0">Figure 15-2</a></span><span class="c4">). He could then perform administrative functions, such as deleting, editing, and creating new accounts.</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 584.00px; height: 314.67px;"><img alt="Screenshot of a POST request in Burp Suite submitting a token, ID, and username to the api/user/edit endpoint" src="images/image1.png" style="width: 584.00px; height: 314.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c23"><span class="c16">Figure 15-2</span><span class="c28">: Omkar&rsquo;s successful API request to edit a user&rsquo;s account password</span></p><p class="c3 c6"><span class="c4">Several API vulnerabilities led to this exploitation. The API documentation disclosed sensitive information about how the API operated and how to manipulate user accounts. There is no business purpose to making this documentation available to the public; if it weren&rsquo;t available, an attacker would have likely moved on to the next target without stopping to investigate.</span></p><p class="c3 c6"><span class="c4">By thoroughly investigating the target, Bhagwat was able to discover a broken authentication vulnerability in the form of an exposed authorization Bearer token. Using the Bearer token and documentation, he then found a BFLA.</span></p><p class="c3"><span class="c7">Lessons Learned</span></p><ul class="c22 lst-kix_aufcu529ytzc-0 start"><li class="c5 li-bullet-0"><span class="c4">Launch a thorough investigation of a web application when something piques your interest.</span></li><li class="c5 li-bullet-0"><span class="c4">API documentation is a gold mine of information; use it to your advantage.</span></li><li class="c5 li-bullet-0"><span class="c4">Combine your findings to discover new vulnerabilities.</span></li></ul><h3 class="c13" id="h.v1bbqj4kcbyd"><span class="c10">Starbucks: The Breach That Never Was</span></h3><ol class="c22 lst-kix_exfeg2j6iqyd-0 start" start="1"><li class="c5 li-bullet-0"><span class="c8">Bug bounty hunter:</span><span class="c4">&nbsp;Sam Curry</span></li><li class="c5 li-bullet-0"><span class="c8">Bounty:</span><span class="c4">&nbsp;$4,000</span></li></ol><p class="c3"><span class="c4">Curry is a security researcher and bug hunter. While participating in Starbucks&rsquo; bug bounty program, he discovered and disclosed a vulnerability that prevented a breach of nearly 100 million personally identifiable information (PII) records belonging to Starbucks&rsquo; customers. According to the Net Diligence breach calculator, a PII data breach of this size could have cost Starbucks $100 million in regulatory fines, $225 million in crisis management costs, and $25 million in incident investigation costs. Even at a conservative estimate of $3.50 per record, a breach of that size could have resulted in a bill of around $350 million. Sam&rsquo;s finding was epic, to say the least.</span></p><p class="c3 c6"><span class="c11">On his blog at </span><span class="c17"><a class="c9" href="https://www.google.com/url?q=https://samcurry.net/&amp;sa=D&amp;source=editors&amp;ust=1681144529146334&amp;usg=AOvVaw044_HFosL4yjStnI3dwRYh">https://samcurry.net</a></span><span class="c11">, Curry provides a play-by-play of his approach to hacking the Starbucks API. The first thing that caught his interest was the fact that the Starbucks gift card purchase process included API requests containing sensitive information to the endpoint </span><span class="c2">/bff/proxy</span><span class="c4">:</span></p><p class="c0"><span class="c1">POST /bff/proxy/orchestra/get-user HTTP/1.1</span></p><p class="c0"><span class="c1">HOST: app.starbucks.com</span></p><p class="c0 c15"><span class="c1"></span></p><p class="c0"><span class="c1">{</span></p><p class="c0"><span class="c1">&quot;data&quot;:</span></p><p class="c0"><span class="c1">&quot;user&quot;: {</span></p><p class="c0"><span class="c1">&quot;exId&quot;: &quot;77EFFC83-7EE9-4ECA-9849-A6A23BF1830F&quot;,</span></p><p class="c0"><span class="c1">&quot;firstName&quot;: &quot;Sam&quot;,</span></p><p class="c0"><span class="c1">&quot;lastName&quot;: &quot;Curry&quot;,</span></p><p class="c0"><span class="c1">&quot;email&quot;: &quot;samwcurry@gmail.com&quot;,</span></p><p class="c0"><span class="c1">&quot;partnerNumber&quot;: null,</span></p><p class="c0"><span class="c1">&quot;birthDay&quot;: null,</span></p><p class="c0"><span class="c1">&quot;birthMonth&quot;: null,</span></p><p class="c0"><span class="c1">&quot;loyaltyProgram&quot;: null</span></p><p class="c0"><span class="c1">}</span></p><p class="c14"><span class="c1">}</span></p><p class="c3 c6"><span class="c11">As Curry explains on his blog, </span><span class="c2">bff</span><span class="c4">&nbsp;stands for &ldquo;backend for frontend,&rdquo; meaning the application passes the request to another host to provide the functionality. In other words, Starbucks was using a proxy to transfer data between the external API and an internal API endpoint.</span></p><p class="c3 c6"><span class="c11">Curry attempted to probe this </span><span class="c2">/bff/proxy/orchestra</span><span class="c11">&nbsp;endpoint but found it wouldn&rsquo;t transfer user input back to the internal API. However, he discovered a</span><span class="c2">&nbsp;/bff/proxy/user:id</span><span class="c4">&nbsp;endpoint that did allow user input to make it beyond the proxy:</span></p><p class="c0"><span class="c1">GET /bff/proxy/stream/v1/users/me/streamItems/..\ HTTP/1.1</span></p><p class="c0"><span class="c1">Host: app.starbucks.com</span></p><p class="c0 c15"><span class="c1"></span></p><p class="c0"><span class="c1">{</span></p><p class="c0"><span class="c1">&quot;errors&quot;: [</span></p><p class="c0"><span class="c1">{</span></p><p class="c0"><span class="c1">&quot;message&quot;: &quot;Not Found&quot;,</span></p><p class="c0"><span class="c1">&quot;errorCode&quot;: 404</span></p><p class="c14"><span class="c1">}]}</span></p><p class="c3 c6"><span class="c11">By using </span><span class="c12">..\</span><span class="c4">&nbsp;at the end of the path, Curry was attempting to traverse the current working directory and see what else he could access on the server. He continued to test for various directory traversal vulnerabilities until he sent the following:</span></p><p class="c14"><span class="c1">GET /bff/proxy/stream/v1/me/stramItems/web\..\.\..\.\..\.\..\.\..\..\..\.\..\</span></p><p class="c3 c6"><span class="c4">This request resulted in a different error message:</span></p><p class="c0"><span class="c1">&quot;message&quot;: &quot;Bad Request&quot;,</span></p><p class="c14"><span class="c1">&quot;errorCode&quot;: 400</span></p><p class="c3 c6"><span class="c11">This sudden change in an error request meant Curry was onto something. He used Burp Suite Intruder to brute-force various directories until he came across a Microsoft Graph instance using </span><span class="c2">/search/v1/accounts</span><span class="c4">. Curry queried the Graph API and captured a proof of concept that demonstrated he had access to an internal customer database containing IDs, usernames, full names, emails, cities, addresses, and phone numbers.</span></p><p class="c3 c6"><span class="c11">Because he knew the syntax of the Microsoft Graph API, Curry found that he could include the query parameter </span><span class="c12">$count=true</span><span class="c4">&nbsp;to get a count of the number of entries, which came up to 99,356,059, just shy of 100 million.</span></p><p class="c3 c6"><span class="c4">Curry found this vulnerability by paying close attention to the API&rsquo;s responses and filtering results in Burp Suite, allowing him to find a unique status code of 400 among all the standard 404 errors. If the API provider hadn&rsquo;t disclosed this information, the response would have blended in with all the other 404 errors, and an attacker would likely have moved on to another target.</span></p><p class="c3 c6"><span class="c4">By combining the information disclosure and security misconfiguration, he was able to brute-force the internal directory structure and find the Microsoft Graph API. The additional BFLA vulnerability allowed Curry to use administrative functionality to perform user account queries.</span></p><p class="c3"><span class="c7">Lessons Learned</span></p><ul class="c22 lst-kix_jltigrvo69ye-0 start"><li class="c5 li-bullet-0"><span class="c4">Pay close attention to subtle differences between API responses. Use Burp Suite Comparer or carefully compare requests and responses to identify potential weaknesses in an API.</span></li><li class="c5 li-bullet-0"><span class="c4">Investigate how the application or WAF handles fuzzing and directory traversal techniques.</span></li><li class="c5 li-bullet-0"><span class="c4">Leverage evasive techniques to bypass security controls.</span></li></ul><h3 class="c13" id="h.uowpez8cy39v"><span class="c10">An Instagram GraphQL BOLA</span></h3><ul class="c22 lst-kix_ab38c4514qrz-0 start"><li class="c5 li-bullet-0"><span class="c8">Bug bounty hunter:</span><span class="c4">&nbsp;Mayur Fartade</span></li><li class="c5 li-bullet-0"><span class="c8">Bounty:</span><span class="c4">&nbsp;$30,000</span></li></ul><p class="c3"><span class="c11">In 2021, Fartade discovered a severe BOLA vulnerability in Instagram that allowed him to send POST requests to the GraphQL API located at </span><span class="c2">/api/v1/ads/graphql/</span><span class="c4">&nbsp;to view the private posts, stories, and reels of other users.</span></p><p class="c3 c6"><span class="c4">The issue stemmed from a lack of authorization security controls for requests involving a user&rsquo;s media ID. To discover the media ID, you could use brute force or capture the ID through other means, such as social engineering or XSS. For example, Fartade used a POST request like the following:</span></p><p class="c0"><span class="c1">POST /api/v1/ads/graphql HTTP/1.1</span></p><p class="c0"><span class="c1">Host: i.instagram.com</span></p><p class="c0"><span class="c1">Parameters:</span></p><p class="c14"><span class="c24">doc_id=[REDACTED]&amp;query_params={&quot;query_params&quot;:{&quot;access_token&quot;:&quot;&quot;,&quot;id&quot;:&quot;</span><span class="c20">[MEDIA_ID]</span><span class="c1">&quot;}}</span></p><p class="c3 c6"><span class="c11">By targeting the </span><span class="c12">MEDIA_ID</span><span class="c11">&nbsp;parameter and providing a null value for </span><span class="c12">access_token</span><span class="c4">, Fartade was able to view the details of other users&rsquo; private posts:</span></p><p class="c0"><span class="c1">&quot;data&quot;:{</span></p><p class="c0"><span class="c1">&quot;instagram_post_by_igid&quot;:{</span></p><p class="c0"><span class="c1">&quot;id&quot;:</span></p><p class="c0"><span class="c1">&quot;creation_time&quot;:1618732307,</span></p><p class="c0"><span class="c1">&quot;has_product_tags&quot;:false,</span></p><p class="c0"><span class="c1">&quot;has_product_mentions&quot;:false,</span></p><p class="c0"><span class="c1">&quot;instagram_media_id&quot;:</span></p><p class="c0"><span class="c1">006&quot;,</span></p><p class="c0"><span class="c1">&quot;instagram_media_owner_id&quot;:&quot;!</span></p><p class="c0"><span class="c1">&quot;instagram_actor&quot;: {</span></p><p class="c0"><span class="c1">&quot;instagram_actor_id&quot;:&quot;!</span></p><p class="c0"><span class="c1">&quot;id&quot;:&quot;1</span></p><p class="c0"><span class="c1">},</span></p><p class="c0"><span class="c1">&quot;inline_insights_node&quot;:{</span></p><p class="c0"><span class="c1">&quot;state&quot;: null,</span></p><p class="c0"><span class="c1">&quot;metrics&quot;:null,</span></p><p class="c0"><span class="c1">&quot;error&quot;:null</span></p><p class="c0"><span class="c1">},</span></p><p class="c0"><span class="c1">&quot;display_url&quot;:&quot;https:\/\/scontent.cdninstagram.com\/VV/t51.29350-15\/</span></p><p class="c0"><span class="c1">&quot;instagram_media_type&quot;:&quot;IMAGE&quot;,</span></p><p class="c0"><span class="c1">&quot;image&quot;:{</span></p><p class="c0"><span class="c1">&quot;height&quot;:640,</span></p><p class="c0"><span class="c1">&quot;width&quot;:360</span></p><p class="c0"><span class="c1">},</span></p><p class="c0"><span class="c1">&quot;comment_count&quot;:</span></p><p class="c0"><span class="c1">&quot;like_count&quot;:</span></p><p class="c0"><span class="c1">&quot;save_count&quot;:</span></p><p class="c0"><span class="c1">&quot;ad_media&quot;: null,</span></p><p class="c0"><span class="c1">&quot;organic_instagram_media_id&quot;:&quot;</span></p><p class="c0"><span class="c1">--snip--</span></p><p class="c0"><span class="c1">]</span></p><p class="c0"><span class="c1">}</span></p><p class="c14"><span class="c1">}</span></p><p class="c3 c6"><span class="c4">This BOLA allowed Fartade to make requests for information simply by specifying the media ID of a given Instagram post. Using this weakness, he was able to gain access to details such as likes, comments, and Facebook-linked pages of any user&rsquo;s private or archived posts.</span></p><p class="c3"><span class="c7">Lessons Learned</span></p><ul class="c22 lst-kix_jyigqe3fy08m-0 start"><li class="c5 li-bullet-0"><span class="c4">Make an effort to seek out GraphQL endpoints and apply the techniques covered in this book; the payout could be huge.</span></li><li class="c5 li-bullet-0"><span class="c4">When at first your attacks don&rsquo;t succeed, combine evasive techniques, such as by using null bytes with your attacks, and try again.</span></li><li class="c5 li-bullet-0"><span class="c4">Experiment with tokens to bypass authorization requirements.</span></li></ul><h2 class="c13" id="h.e2x5ott0zs7x"><span class="c19">Summary</span></h2><p class="c3"><span class="c4">This chapter used API breaches and bug bounty reports to demonstrate how you might be able to exploit common API vulnerabilities in real-world environments. Studying the tactics of adversaries and bug bounty hunters will help you expand your own hacking repertoire to better help secure the internet. These stories also reveal how much low-hanging fruit is out there. By combining easy techniques, you can create an API hacking masterpiece.</span></p><p class="c3 c6"><span class="c4">Become familiar with the common API vulnerabilities, perform thorough analysis of endpoints, exploit the vulnerabilities you discover, report your findings, and bask in the glory of preventing the next great API data breach.</span></p><p class="c0 c15"><span class="c26"></span></p></body></html>