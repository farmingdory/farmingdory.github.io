<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_sxxvgkgwgohh-1>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-1}ol.lst-kix_sxxvgkgwgohh-0{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-1{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-2{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-3{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-4{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-5{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-6{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-7{list-style-type:none}.lst-kix_dvs0t9kwly6c-1>li:before{content:"\0025cb  "}ol.lst-kix_sxxvgkgwgohh-6.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-6 0}ol.lst-kix_sxxvgkgwgohh-0.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-0 0}.lst-kix_dvs0t9kwly6c-0>li:before{content:"\0025cf  "}.lst-kix_dvs0t9kwly6c-2>li:before{content:"\0025a0  "}ol.lst-kix_6xsn64yt6ht6-7{list-style-type:none}ol.lst-kix_6xsn64yt6ht6-8{list-style-type:none}.lst-kix_sxxvgkgwgohh-2>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-2}ol.lst-kix_6xsn64yt6ht6-5{list-style-type:none}.lst-kix_ojb99r6iyu0u-3>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-3}ol.lst-kix_6xsn64yt6ht6-6{list-style-type:none}ol.lst-kix_6xsn64yt6ht6-3{list-style-type:none}.lst-kix_6xsn64yt6ht6-8>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-8}ol.lst-kix_6xsn64yt6ht6-4{list-style-type:none}ol.lst-kix_6xsn64yt6ht6-1{list-style-type:none}ol.lst-kix_6xsn64yt6ht6-2.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-2 0}ol.lst-kix_6xsn64yt6ht6-2{list-style-type:none}ol.lst-kix_6xsn64yt6ht6-0{list-style-type:none}.lst-kix_rebrvk9pye4v-2>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-2}ol.lst-kix_sxxvgkgwgohh-3.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-3 0}.lst-kix_rebrvk9pye4v-3>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-3}.lst-kix_dvs0t9kwly6c-8>li:before{content:"\0025a0  "}.lst-kix_rebrvk9pye4v-0>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-0}.lst-kix_dvs0t9kwly6c-5>li:before{content:"\0025a0  "}ol.lst-kix_6xsn64yt6ht6-5.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-5 0}.lst-kix_dvs0t9kwly6c-4>li:before{content:"\0025cb  "}ul.lst-kix_dvs0t9kwly6c-7{list-style-type:none}ol.lst-kix_rebrvk9pye4v-5.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-5 0}ol.lst-kix_ojb99r6iyu0u-3.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-3 0}ul.lst-kix_dvs0t9kwly6c-8{list-style-type:none}.lst-kix_dvs0t9kwly6c-3>li:before{content:"\0025cf  "}.lst-kix_ojb99r6iyu0u-2>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-2}.lst-kix_sxxvgkgwgohh-3>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-3}ol.lst-kix_6xsn64yt6ht6-8.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-8 0}.lst-kix_dvs0t9kwly6c-6>li:before{content:"\0025cf  "}ol.lst-kix_rebrvk9pye4v-2.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-2 0}ol.lst-kix_ojb99r6iyu0u-0.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-0 0}.lst-kix_sxxvgkgwgohh-0>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-0}.lst-kix_ojb99r6iyu0u-5>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-5}.lst-kix_dvs0t9kwly6c-7>li:before{content:"\0025cb  "}.lst-kix_6xsn64yt6ht6-6>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-6}ol.lst-kix_rebrvk9pye4v-1.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-1 0}.lst-kix_7cx6goav6px-0>li:before{content:"\0025cf  "}ol.lst-kix_6xsn64yt6ht6-1.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-1 0}ol.lst-kix_rebrvk9pye4v-8.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-8 0}.lst-kix_7cx6goav6px-2>li:before{content:"\0025a0  "}.lst-kix_7cx6goav6px-1>li:before{content:"\0025cb  "}.lst-kix_7cx6goav6px-3>li:before{content:"\0025cf  "}ol.lst-kix_sxxvgkgwgohh-5.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-5 0}ul.lst-kix_dvs0t9kwly6c-3{list-style-type:none}.lst-kix_7cx6goav6px-6>li:before{content:"\0025cf  "}ul.lst-kix_dvs0t9kwly6c-4{list-style-type:none}ul.lst-kix_dvs0t9kwly6c-5{list-style-type:none}.lst-kix_7cx6goav6px-5>li:before{content:"\0025a0  "}.lst-kix_7cx6goav6px-7>li:before{content:"\0025cb  "}ul.lst-kix_dvs0t9kwly6c-6{list-style-type:none}.lst-kix_7cx6goav6px-4>li:before{content:"\0025cb  "}.lst-kix_7cx6goav6px-8>li:before{content:"\0025a0  "}ul.lst-kix_dvs0t9kwly6c-0{list-style-type:none}ul.lst-kix_dvs0t9kwly6c-1{list-style-type:none}ul.lst-kix_dvs0t9kwly6c-2{list-style-type:none}.lst-kix_sxxvgkgwgohh-5>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-5}ol.lst-kix_6xsn64yt6ht6-7.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-7 0}ol.lst-kix_6xsn64yt6ht6-0.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-0 0}.lst-kix_ojb99r6iyu0u-4>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-4}.lst-kix_6xsn64yt6ht6-1>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-1}.lst-kix_6xsn64yt6ht6-7>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-7}ol.lst-kix_sxxvgkgwgohh-4.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-4 0}.lst-kix_ojb99r6iyu0u-7>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-7}.lst-kix_6xsn64yt6ht6-4>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-4}ol.lst-kix_rebrvk9pye4v-0.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-0 0}.lst-kix_ojb99r6iyu0u-1>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-1}ol.lst-kix_ojb99r6iyu0u-2.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-2 0}.lst-kix_rebrvk9pye4v-1>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-1}.lst-kix_rebrvk9pye4v-4>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-4}ol.lst-kix_ojb99r6iyu0u-8.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-8 0}.lst-kix_rebrvk9pye4v-7>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-7}ol.lst-kix_rebrvk9pye4v-7.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-7 0}ol.lst-kix_6xsn64yt6ht6-6.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-6 0}.lst-kix_ojb99r6iyu0u-8>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-8,lower-roman) ". "}.lst-kix_ojb99r6iyu0u-7>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-7,lower-latin) ". "}.lst-kix_6xsn64yt6ht6-0>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-0,decimal) ". "}.lst-kix_sxxvgkgwgohh-7>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-7}.lst-kix_6xsn64yt6ht6-2>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-2}.lst-kix_ojb99r6iyu0u-1>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-1,lower-latin) ". "}ul.lst-kix_7cx6goav6px-7{list-style-type:none}.lst-kix_6xsn64yt6ht6-6>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-6,decimal) ". "}ul.lst-kix_7cx6goav6px-6{list-style-type:none}.lst-kix_ojb99r6iyu0u-2>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-2,lower-roman) ". "}ul.lst-kix_7cx6goav6px-8{list-style-type:none}.lst-kix_ojb99r6iyu0u-3>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-3,decimal) ". "}ul.lst-kix_7cx6goav6px-3{list-style-type:none}.lst-kix_rebrvk9pye4v-8>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-8}.lst-kix_6xsn64yt6ht6-7>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-7,lower-latin) ". "}.lst-kix_6xsn64yt6ht6-8>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-8,lower-roman) ". "}ul.lst-kix_7cx6goav6px-2{list-style-type:none}ul.lst-kix_7cx6goav6px-5{list-style-type:none}ul.lst-kix_7cx6goav6px-4{list-style-type:none}.lst-kix_ojb99r6iyu0u-5>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-5,lower-roman) ". "}ol.lst-kix_rebrvk9pye4v-6.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-6 0}ol.lst-kix_ojb99r6iyu0u-4.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-4 0}.lst-kix_sxxvgkgwgohh-8>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-8}.lst-kix_ojb99r6iyu0u-4>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-4,lower-latin) ". "}.lst-kix_ojb99r6iyu0u-6>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-6,decimal) ". "}ol.lst-kix_rebrvk9pye4v-3.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-3 0}ol.lst-kix_ojb99r6iyu0u-1.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-1 0}.lst-kix_rebrvk9pye4v-4>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-4,lower-latin) ". "}.lst-kix_rebrvk9pye4v-5>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-5,lower-roman) ". "}.lst-kix_rebrvk9pye4v-6>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-6}.lst-kix_rebrvk9pye4v-2>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-2,lower-roman) ". "}.lst-kix_rebrvk9pye4v-6>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-6,decimal) ". "}ol.lst-kix_sxxvgkgwgohh-2.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-2 0}ol.lst-kix_ojb99r6iyu0u-7.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-7 0}.lst-kix_rebrvk9pye4v-0>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-0,decimal) ". "}.lst-kix_rebrvk9pye4v-1>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-1,lower-latin) ". "}.lst-kix_rebrvk9pye4v-8>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-8,lower-roman) ". "}ul.lst-kix_7cx6goav6px-1{list-style-type:none}ul.lst-kix_7cx6goav6px-0{list-style-type:none}.lst-kix_rebrvk9pye4v-7>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-7,lower-latin) ". "}.lst-kix_6xsn64yt6ht6-5>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-5,lower-roman) ". "}.lst-kix_sxxvgkgwgohh-6>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-6}.lst-kix_6xsn64yt6ht6-3>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-3,decimal) ". "}.lst-kix_6xsn64yt6ht6-4>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-4,lower-latin) ". "}.lst-kix_6xsn64yt6ht6-0>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-0}.lst-kix_6xsn64yt6ht6-2>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-2,lower-roman) ". "}ol.lst-kix_ojb99r6iyu0u-8{list-style-type:none}.lst-kix_ojb99r6iyu0u-8>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-8}.lst-kix_6xsn64yt6ht6-1>li:before{content:"" counter(lst-ctn-kix_6xsn64yt6ht6-1,lower-latin) ". "}.lst-kix_6xsn64yt6ht6-3>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-3}.lst-kix_rebrvk9pye4v-3>li:before{content:"" counter(lst-ctn-kix_rebrvk9pye4v-3,decimal) ". "}ol.lst-kix_ojb99r6iyu0u-2{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-3{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-0{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-1{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-6{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-7{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-4{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-5{list-style-type:none}ol.lst-kix_ojb99r6iyu0u-6.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-6 0}.lst-kix_ojb99r6iyu0u-6>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-6}.lst-kix_6xsn64yt6ht6-5>li{counter-increment:lst-ctn-kix_6xsn64yt6ht6-5}ol.lst-kix_sxxvgkgwgohh-1.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-1 0}.lst-kix_sxxvgkgwgohh-4>li{counter-increment:lst-ctn-kix_sxxvgkgwgohh-4}ol.lst-kix_6xsn64yt6ht6-4.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-4 0}.lst-kix_rebrvk9pye4v-5>li{counter-increment:lst-ctn-kix_rebrvk9pye4v-5}ol.lst-kix_rebrvk9pye4v-1{list-style-type:none}ol.lst-kix_rebrvk9pye4v-0{list-style-type:none}ol.lst-kix_rebrvk9pye4v-3{list-style-type:none}.lst-kix_ojb99r6iyu0u-0>li{counter-increment:lst-ctn-kix_ojb99r6iyu0u-0}ol.lst-kix_rebrvk9pye4v-2{list-style-type:none}ol.lst-kix_rebrvk9pye4v-5{list-style-type:none}ol.lst-kix_rebrvk9pye4v-4{list-style-type:none}ol.lst-kix_sxxvgkgwgohh-8.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-8 0}ol.lst-kix_rebrvk9pye4v-7{list-style-type:none}ol.lst-kix_rebrvk9pye4v-6{list-style-type:none}ol.lst-kix_rebrvk9pye4v-8{list-style-type:none}.lst-kix_sxxvgkgwgohh-5>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-5,lower-roman) ". "}.lst-kix_sxxvgkgwgohh-4>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-4,lower-latin) ". "}.lst-kix_sxxvgkgwgohh-6>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-6,decimal) ". "}.lst-kix_sxxvgkgwgohh-0>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-0,decimal) ". "}.lst-kix_sxxvgkgwgohh-8>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-8,lower-roman) ". "}.lst-kix_sxxvgkgwgohh-7>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-7,lower-latin) ". "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_sxxvgkgwgohh-8{list-style-type:none}ol.lst-kix_rebrvk9pye4v-4.start{counter-reset:lst-ctn-kix_rebrvk9pye4v-4 0}.lst-kix_ojb99r6iyu0u-0>li:before{content:"" counter(lst-ctn-kix_ojb99r6iyu0u-0,decimal) ". "}ol.lst-kix_6xsn64yt6ht6-3.start{counter-reset:lst-ctn-kix_6xsn64yt6ht6-3 0}.lst-kix_sxxvgkgwgohh-1>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-1,lower-latin) ". "}.lst-kix_sxxvgkgwgohh-2>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-2,lower-roman) ". "}ol.lst-kix_sxxvgkgwgohh-7.start{counter-reset:lst-ctn-kix_sxxvgkgwgohh-7 0}.lst-kix_sxxvgkgwgohh-3>li:before{content:"" counter(lst-ctn-kix_sxxvgkgwgohh-3,decimal) ". "}ol.lst-kix_ojb99r6iyu0u-5.start{counter-reset:lst-ctn-kix_ojb99r6iyu0u-5 0}ol{margin:0;padding:0}table td,table th{padding:0}.c0{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;text-indent:12pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c18{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c16{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c24{border-right-style:solid;padding-top:6pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.125;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c26{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.0;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c30{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c34{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c1{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.75;border-top-style:solid;background-color:#ffffff;margin-left:54pt;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c8{background-color:#ffffff;-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:9pt;font-family:"Times New Roman";font-style:italic}.c5{background-color:#eef2f6;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Courier New";font-style:normal}.c21{background-color:#ffffff;color:#3d3b49;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman"}.c13{-webkit-text-decoration-skip:none;color:#d3002d;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman"}.c17{padding-top:24pt;padding-bottom:24pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c15{padding-top:18pt;padding-bottom:18pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c3{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:700}.c12{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:54pt;font-family:"Times New Roman"}.c33{background-color:#000000;color:#ffffff;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c11{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#188038;font-weight:400}.c36{background-color:#ffffff;color:#3d3b49;font-weight:700;font-size:40.5pt;font-family:"Times New Roman"}.c29{background-color:#eef2f6;font-size:12pt;font-family:"Courier New";color:#3d3b49;font-weight:400}.c25{background-color:#000000;color:#ffffff;font-weight:700;font-size:10pt;font-family:"Arial"}.c14{color:#3d3b49;font-weight:700;font-size:14.5pt;font-family:"Times New Roman"}.c28{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c23{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:700}.c20{color:#3d3b49;font-weight:700;font-size:23.5pt;font-family:"Times New Roman"}.c2{font-size:12pt;font-family:"Times New Roman";color:#3d3b49;font-weight:400}.c6{text-decoration:none;vertical-align:baseline;font-style:normal}.c22{background-color:#eef2f6;font-size:12pt;color:#188038}.c27{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c19{color:inherit;text-decoration:inherit}.c37{font-family:"Courier New";font-weight:400}.c31{text-decoration:none;vertical-align:baseline}.c32{color:#3d3b49;font-size:12pt}.c10{padding:0;margin:0}.c35{font-weight:400;font-family:"Arial"}.c9{font-style:italic}.c7{height:11pt}.c38{background-color:#ffffff}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c27 doc-content"><h1 class="c34" id="h.ykhrqulgske2"><span class="c6 c12">9</span></h1><h1 class="c34" id="h.ykhrqulgske2-1"><span class="c36 c6">FUZZING</span></h1><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 610.67px; height: 800.00px;"><img alt="" src="images/image6.png" style="width: 610.67px; height: 800.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c16"><span class="c2 c6">In this chapter, you&rsquo;ll explore using fuzzing techniques to discover several of the top API vulnerabilities discussed in Chapter 3. The secret to successfully discovering most API vulnerabilities is knowing where to fuzz and what to fuzz with. In fact, you&rsquo;ll likely discover many API vulnerabilities by fuzzing input sent to API endpoints.</span></p><p class="c0"><span class="c2 c6">Using Wfuzz, Burp Suite Intruder, and Postman&rsquo;s Collection Runner, we&rsquo;ll cover two strategies to increase your success: fuzzing wide and fuzzing deep. We&rsquo;ll also discuss how to fuzz for improper assets management vulnerabilities, find the accepted HTTP methods for a request, and bypass input sanitization.</span></p><h2 class="c18" id="h.v5hm51hmuyj0"><span class="c20 c6">Effective Fuzzing</span></h2><p class="c16"><span class="c2 c6">In earlier chapters, we defined API fuzzing as the process of sending requests with various types of input to an endpoint in order to provoke an unintended result. While &ldquo;various types of input&rdquo; and &ldquo;unintended result&rdquo; might sound vague, that&rsquo;s only because there are so many possibilities. Your input could include symbols, numbers, emojis, decimals, hexadecimal, system commands, SQL input, and NoSQL input, for instance. If the API has not implemented validation checks to handle harmful input, you could end up with a verbose error, a unique response, or (in the worst case) some sort of internal server error indicating that your fuzz caused a denial of service, killing the app.</span></p><p class="c0"><span class="c2 c6">Fuzzing successfully requires a careful consideration of the app&rsquo;s likely expectations. For example, take a banking API call intended to allow users to transfer money from one account to another. The request could look something like this:</span></p><p class="c4"><span class="c5">POST /account/balance/transfer</span></p><p class="c4"><span class="c5">Host: bank.com</span></p><p class="c4"><span class="c5">x-access-token: hapi_token</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">{</span></p><p class="c4"><span class="c5">&quot;userid&quot;: 12345,</span></p><p class="c4"><span class="c5">&quot;account&quot;: 224466,</span></p><p class="c4"><span class="c5">&quot;transfer-amount&quot;: 1337.25,</span></p><p class="c15"><span class="c5">}</span></p><p class="c0"><span class="c2">To fuzz this request, you could easily set up Burp Suite or Wfuzz to submit huge payloads as the </span><span class="c11">userid</span><span class="c2">, </span><span class="c11">account</span><span class="c2">, and </span><span class="c11">transfer-amount</span><span class="c2 c6">&nbsp;values. However, this could set off defensive mechanisms, resulting in stronger rate limiting or your token being blocked. If the API lacks these security controls, by all means release the krakens. Otherwise, your best bet is to send a few targeted requests to only one of the values at a time.</span></p><p class="c0"><span class="c2">Consider the fact that the </span><span class="c11">transfer-amount</span><span class="c2 c6">&nbsp;value likely expects a relatively small number. Bank.com isn&rsquo;t anticipating an individual user to transfer an amount larger than the global GDP. It also likely expects a decimal value. Thus, you might want to evaluate what happens when you send the following:</span></p><ul class="c10 lst-kix_7cx6goav6px-0 start"><li class="c1 li-bullet-0"><span class="c2 c6">A value in the quadrillions</span></li><li class="c1 li-bullet-0"><span class="c2 c6">String of letters instead of numbers</span></li><li class="c1 li-bullet-0"><span class="c2 c6">A large decimal number or a negative number</span></li><li class="c1 li-bullet-0"><span class="c2">Null values like </span><span class="c11">null</span><span class="c2">, </span><span class="c11">(null)</span><span class="c2">, </span><span class="c11">%00</span><span class="c2">, and </span><span class="c11 c6">0x00</span></li><li class="c1 li-bullet-0"><span class="c2">Symbols like the following: </span><span class="c11 c6">!@#$%^&amp;*();&#39;:&#39;&#39;|,./?&gt;</span></li></ul><p class="c0"><span class="c2 c6">These requests could easily lead to verbose errors that reveal more about the application. A value in the quadrillions could additionally cause an unhandled SQL database error to be sent back as a response. This one piece of information could help you target values across the API for SQL injection vulnerabilities.</span></p><p class="c0"><span class="c2 c6">Thus, the success of your fuzzing will depend on where you are fuzzing and what you are fuzzing with. The trick is to look for API inputs that are leveraged for a consumer to interact with the application and send input that is likely to result in errors. If these inputs do not have sufficient input handling and error handling, they can often lead to exploitation. Examples of this sort of API input include the fields involved in requests used for authentication forms, account registration, uploading files, editing web application content, editing user profile information, editing account information, managing users, searching for content, and so on.</span></p><p class="c0"><span class="c2 c6">The types of input to send really depend on the type of input you are attacking. Generically, you can send all sorts of symbols, strings, and numbers that could cause errors, and then you could pivot your attack based on the errors received. All of the following could result in interesting responses:</span></p><ul class="c10 lst-kix_dvs0t9kwly6c-0 start"><li class="c1 li-bullet-0"><span class="c2 c6">Sending an exceptionally large number when a small number is expected</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Sending database queries, system commands, and other code</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Sending a string of letters when a number is expected</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Sending a large string of letters when a small string is expected</span></li><li class="c1 li-bullet-0"><span class="c2">Sending various symbols (</span><span class="c11">-_\!@#$%^&amp;*();&#39;:&#39;&#39;|,./?&gt;</span><span class="c2 c6">)</span></li><li class="c1 li-bullet-0"><span class="c2">Sending characters from unexpected languages (&#28450;, &#12373;, </span><span class="c32">&#1046;</span><span class="c2">, </span><span class="c32">&#1130;</span><span class="c2">, </span><span class="c32">&#1132;</span><span class="c2">, </span><span class="c32">&#1126;</span><span class="c2">, </span><span class="c32">&#1128;</span><span class="c2">, </span><span class="c32">&#1134;</span><span class="c2 c6">)</span></li></ul><p class="c0"><span class="c2 c6">If you are blocked or banned while fuzzing, you might want to deploy evasion techniques discussed in Chapter 13 or else further limit the number of fuzzing requests you send.</span></p><h3 class="c18" id="h.dvurflm6gx9v"><span class="c14 c6">Choosing Fuzzing Payloads</span></h3><p class="c16"><span class="c2">Different fuzzing payloads can incite various types of responses. You can use either generic fuzzing payloads or more targeted ones. </span><span class="c2 c9">Generic payloads</span><span class="c2 c6">&nbsp;are those we&rsquo;ve discussed so far and contain symbols, null bytes, directory traversal strings, encoded characters, large numbers, long strings, and so on.</span></p><p class="c0"><span class="c2 c9">Targeted </span><span class="c2 c6">fuzzing payloads are aimed at provoking a response from specific technologies and types of vulnerabilities. Targeted fuzzing payload types might include API object or variable names, cross-site scripting (XSS) payloads, directories, file extensions, HTTP request methods, JSON or XML data, SQL or No SQL commands, or commands for particular operating systems. We&rsquo;ll cover examples of fuzzing with these payloads in this and future chapters.</span></p><p class="c0"><span class="c2 c6">You&rsquo;ll typically move from generic to targeted fuzzing based on the information received in API responses. Similar to reconnaissance efforts in Chapter 6, you will want to adapt your fuzzing and focus your efforts based on the results of generic testing. Targeted fuzzing payloads are more useful once you know the technologies being used. If you&rsquo;re sending SQL fuzzing payloads to an API that leverages only NoSQL databases, your testing won&rsquo;t be as effective.</span></p><p class="c0"><span class="c2">One of the best sources for fuzzing payloads is SecLists (</span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://github.com/danielmiessler/SecLists&amp;sa=D&amp;source=editors&amp;ust=1681144477870084&amp;usg=AOvVaw0VYM-jQuaOMtBR07J984ND">https://github.com/danielmiessler/SecLists</a></span><span class="c2">). SecLists has a whole section dedicated to fuzzing, and its </span><span class="c2 c9">big-list-of-naughty-strings.txt</span><span class="c2">&nbsp;wordlist is excellent at causing useful responses. The fuzzdb project is another good source for fuzzing payloads (</span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://github.com/fuzzdb-project/fuzzdb&amp;sa=D&amp;source=editors&amp;ust=1681144477871107&amp;usg=AOvVaw2jjyOV9vJGQ4nXdkZNjP17">https://github.com/fuzzdb-project/fuzzdb</a></span><span class="c2">). Also, Wfuzz has many useful payloads (</span><span class="c9 c13"><a class="c19" href="https://www.google.com/url?q=https://github.com/xmendez/wfuzz&amp;sa=D&amp;source=editors&amp;ust=1681144477871843&amp;usg=AOvVaw0fHv56Fb_i31utBh9LeIc9">https://github.com/xmendez/wfuzz</a></span><span class="c2">), including a great list that combines several targeted payloads in their injection directory, called </span><span class="c2 c9">All_attack.txt</span><span class="c2 c6">.</span></p><p class="c0"><span class="c2 c6">Additionally, you can always quickly and easily create your own generic fuzzing payload list. In a text file, combine symbols, numbers, and characters to create each payload as line-separated entries, like this:</span></p><ol class="c10 lst-kix_rebrvk9pye4v-0 start" start="1"><li class="c1 li-bullet-0"><span class="c11 c6">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></li><li class="c1 li-bullet-0"><span class="c11 c6">9999999999999999999999999999999999999999</span></li><li class="c1 li-bullet-0"><span class="c11 c6">~&#39;!@#$%^&amp;*()-_+</span></li><li class="c1 li-bullet-0"><span class="c11 c6">{}[]|\:&#39;&#39;; &#39;&lt;&gt;?,./</span></li><li class="c1 li-bullet-0"><span class="c11 c6">%00</span></li><li class="c1 li-bullet-0"><span class="c11 c6">0x00</span></li><li class="c1 li-bullet-0"><span class="c11 c6">$ne</span></li><li class="c1 li-bullet-0"><span class="c11 c6">%24ne</span></li><li class="c1 li-bullet-0"><span class="c11 c6">$gt</span></li><li class="c1 li-bullet-0"><span class="c11 c6">%24gt</span></li><li class="c1 li-bullet-0"><span class="c11 c6">|whoami</span></li><li class="c1 li-bullet-0"><span class="c11 c6">-- -</span></li><li class="c1 li-bullet-0"><span class="c11 c6">&#39; &#39;&#39;</span></li><li class="c1 li-bullet-0"><span class="c11 c6">&#39; OR 1=1-- -</span></li><li class="c1 li-bullet-0"><span class="c11 c6">&#39;&#39; &#39;&#39;&#39;&#39;&#39;&#39;</span></li><li class="c1 li-bullet-0"><span class="c11">&#28450;, &#12373;, </span><span class="c22">&#1046;</span><span class="c11">, </span><span class="c22">&#1130;</span><span class="c11">, </span><span class="c22">&#1132;</span><span class="c11">, </span><span class="c22">&#1126;</span><span class="c11">, </span><span class="c22">&#1128;</span><span class="c11">, </span><span class="c6 c22 c35">&#1134;</span></li><li class="c1 li-bullet-0"><span class="c2 c6">&#x1f600; &#x1f603; &#x1f604; &#x1f601; &#x1f606;</span></li></ol><p class="c0"><span class="c2">Note that instead of 40 instances of </span><span class="c11">A</span><span class="c2">&nbsp;or </span><span class="c11">9</span><span class="c2 c6">, you could write payloads consisting of hundreds them. Using a small list like this as a fuzzing payload can cause all sorts of useful and interesting responses from an API.</span></p><h3 class="c18" id="h.9z5e2ycnfqwa"><span class="c6 c14">Detecting Anomalies</span></h3><p class="c16"><span class="c2 c6">When fuzzing, you&rsquo;re attempting to cause the API or its supporting technologies to send you information that you can leverage in additional attacks. When an API request payload is handled properly, you should receive some sort of HTTP response code and message indicating that your fuzzing did not work. For example, sending a request with a string of letters when numbers are expected could result in a simple response like the following:</span></p><p class="c4"><span class="c5">HTTP/1.1 400 Bad Request</span></p><p class="c4"><span class="c5">{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &quot;error&quot;: &quot;number required&quot;</span></p><p class="c15"><span class="c5">}</span></p><p class="c0"><span class="c2 c6">From this response, you can deduce that the developers configured the API to properly handle requests like yours and prepared a tailored response.</span></p><p class="c0"><span class="c2">When input is not handled properly and causes an error, the server will often return that error in the response. For example, if you sent input like </span><span class="c11">~&#39;!@#$%^&amp;*()-_+</span><span class="c2 c6">&nbsp;to an endpoint that improperly handles it, you could receive an error like this:</span></p><p class="c4"><span class="c5">HTTP/1.1 200 OK</span></p><p class="c4"><span class="c5">--snip--</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c15"><span class="c5">SQL Error: There is an error in your SQL syntax.</span></p><p class="c0"><span class="c2 c6">This response immediately reveals that you&rsquo;re interacting with an API request that does not handle input properly and that the backend of the application is utilizing a SQL database.</span></p><p class="c0"><span class="c2 c6">You&rsquo;ll typically be analyzing hundreds or thousands of responses, not just two or three. Therefore, you need to filter your responses in order to detect anomalies. One way to do this is to understand what ordinary responses look like. You can establish this baseline by sending a set of expected requests or, as you&rsquo;ll see later in the lab, by sending requests that you expect to fail. Then you can review the results to see if a majority of them are identical. For example, if you issue 100 API requests and 98 of those result in an HTTP 200 response code with a similar response size, you can consider those requests to be your baseline. Also examine a few of the baseline responses to get a sense of their content. Once you know that the baseline responses have been properly handled, review the two anomalous responses. Figure out what input caused the difference, paying particular attention to the HTTP response code, response size, and the content of the response.</span></p><p class="c0"><span class="c2">In some cases, the differences between baseline and anomalous requests will be miniscule. For example, the HTTP response codes might all be identical, but a few requests might result in a response size that is a few bytes larger than the baseline responses. When small differences like this come up, use Burp Suite&rsquo;s Comparer to get a side-by-side comparison of the differences within the responses. Right-click the result you&rsquo;re interested in and choose </span><span class="c23">Send to Comparer (Response)</span><span class="c2">. You can send as many responses as you&rsquo;d like to Comparer, but you&rsquo;ll at least need to send two. Then migrate to the Comparer tab, as shown in </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-1&amp;sa=D&amp;source=editors&amp;ust=1681144477882317&amp;usg=AOvVaw3vkjG_DpZ23zpRol7kMnnE">Figure 9-1</a></span><span class="c2 c6">.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 394.67px;"><img alt="screenshot of the burp suite comparer tab that lists results to be selected for comparison" src="images/image9.png" style="width: 624.00px; height: 394.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-1</span><span class="c21 c9">: Burp Suite&rsquo;s Comparer</span></p><p class="c0"><span class="c2">Select the two results you would like to compare and use the </span><span class="c23">Compare Words</span><span class="c2">&nbsp;button (located at the bottom right of the window) to pull up a side-by-side comparison of the responses (see </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-2&amp;sa=D&amp;source=editors&amp;ust=1681144477883731&amp;usg=AOvVaw1ExGgG_AfqAj21lhIKkytr">Figure 9-2</a></span><span class="c2 c6">).</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 298.67px;"><img alt="screenshot of the burp suite compare words window that shows the responses for the results previously selected" src="images/image13.png" style="width: 624.00px; height: 298.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-2</span><span class="c21 c9">: Comparing two API responses with Comparer</span></p><p class="c0"><span class="c2 c6">A useful option located at the bottom-right corner, called Sync Views, will help you synchronize the two responses. Sync Views is especially useful when you&rsquo;re looking for small differences in large responses, as it will automatically highlight differences between the two responses. The highlights signify whether the difference has been modified, deleted, or added.</span></p><h2 class="c18" id="h.ladswzg9s583"><span class="c20 c6">Fuzzing Wide and Deep</span></h2><p class="c16"><span class="c2">This section will introduce you to two fuzzing techniques: fuzzing wide and fuzzing deep. </span><span class="c2 c9">Fuzzing wide</span><span class="c2">&nbsp;is the act of sending an input across all of an API&rsquo;s unique requests in an attempt to discover a vulnerability. </span><span class="c2 c9">Fuzzing deep</span><span class="c2 c6">&nbsp;is the act of thoroughly testing an individual request with a variety of inputs, replacing headers, parameters, query strings, endpoint paths, and the body of the request with your payloads. You can think of fuzzing wide as testing a mile wide but an inch deep and fuzzing deep as testing an inch wide but a mile deep.</span></p><p class="c0"><span class="c2 c6">Wide and deep fuzzing can help you adequately evaluate every feature of larger APIs. When you&rsquo;re hacking, you&rsquo;ll quickly discover that APIs can greatly vary in size. Certain APIs could have only a few endpoints and a handful of unique requests, so you may be able to easily test them by sending a few requests. An API can have many endpoints and unique requests, however. Alternatively, a single request could be filled with many headers and parameters.</span></p><p class="c0"><span class="c2 c6">This is where the two fuzzing techniques come into play. Fuzzing wide is best used to test for issues across all unique requests. Typically, you can fuzz wide to test for improper assets management (more on this later in this chapter), finding all valid request methods, token-handling issues, and other information disclosure vulnerabilities. Fuzzing deep is best used for testing many aspects of individual requests. Most other vulnerability discovery will be done by fuzzing deep. In later chapters, we will use the fuzzing-deep technique to discover different types of vulnerabilities, including BOLA, BFLA, injection, and mass assignment.</span></p><h3 class="c18" id="h.95xu9lbrqidb"><span class="c14 c6">Fuzzing Wide with Postman</span></h3><p class="c16"><span class="c2 c6">I recommend using Postman to fuzz wide for vulnerabilities across an API, as the tool&rsquo;s Collection Runner makes it easy to run tests against all API requests. If an API includes 150 unique requests across all the endpoints, you can set a variable to a fuzzing payload entry and test it across all 150 requests. This is particularly easy to do when you&rsquo;ve built a collection or imported API requests into Postman. For example, you might use this strategy to test whether any of the requests fail to handle various &ldquo;bad&rdquo; characters. Send a single payload across the API and check for anomalies.</span></p><p class="c0"><span class="c2">Create a Postman environment in which to save a set of fuzzing variables. This lets you seamlessly use the environmental variables from one collection to the next. Once the fuzzing variables are set, just as they are in </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-3&amp;sa=D&amp;source=editors&amp;ust=1681144477887288&amp;usg=AOvVaw0mTkg-Bw0vgElBMTyRirjt">Figure 9-3</a></span><span class="c2 c6">, you can save or update the environment.</span></p><p class="c0"><span class="c2">At the top right, select the fuzzing environment and then use the variable shortcut </span><span class="c11">{{</span><span class="c32 c37">variable name</span><span class="c11">}}</span><span class="c2">&nbsp;wherever you would like to test a value in a given collection. In </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-4&amp;sa=D&amp;source=editors&amp;ust=1681144477888509&amp;usg=AOvVaw1TmLgNcjSczntC27kh4AjD">Figure 9-4</a></span><span class="c2">, I&rsquo;ve replaced the </span><span class="c11">x-access-token</span><span class="c2 c6">&nbsp;header with the first fuzzing variable.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 441.33px;"><img alt="screenshot of postman&rsquo;s manage environments window that lists fuzzing variables, their initial values, and their current values" src="images/image1.png" style="width: 624.00px; height: 441.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-3</span><span class="c21 c9">: Creating fuzzing variables in the Postman environment editor</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 346.67px;"><img alt="screenshot of the postman&rsquo;s edit collection window&rsquo;s authorization tab that shows the x-access-token header is replaced with fuzz1" src="images/image5.png" style="width: 624.00px; height: 346.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-4</span><span class="c21 c9">: Fuzzing a collection token header</span></p><p class="c0"><span class="c2 c6">Additionally, you could replace parts of the URL, the other headers, or any custom variables you&rsquo;ve set in the collection. Then you use the Collection Runner to test every request within the collection.</span></p><p class="c0"><span class="c2">Another useful Postman feature when fuzzing wide is Find and Replace, found at the bottom left of Postman. Find and Replace lets you search a collection (or all collections) and replace certain terms with a replacement of your choice. If you were attacking the Pixi API, for example, you might notice that many placeholder parameters use tags like </span><span class="c11">&lt;email&gt;</span><span class="c2">, </span><span class="c11">&lt;number&gt;</span><span class="c2">, </span><span class="c11">&lt;string&gt;</span><span class="c2">, and </span><span class="c11">&lt;boolean&gt;</span><span class="c2">. This makes it easy to search for these values and replace them with either legitimate ones or one of your fuzzing variables, like </span><span class="c11">{{fuzz1}}</span><span class="c2 c6">.</span></p><p class="c0"><span class="c2 c6">Next, try creating a simple test in the Tests panel to help you detect anomalies. For instance, you could set up the test covered in Chapter 4 for a status code of 200 across a collection:</span></p><p class="c4"><span class="c5">pm.test(&quot;Status code is 200&quot;, function () {</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; pm.response.to.have.status(200);</span></p><p class="c15"><span class="c5">});</span></p><p class="c0"><span class="c2 c6">With this test, Postman will check that responses have a status code of 200, and when a response is 200, it will pass the test. You can easily customize this test by replacing 200 with your preferred status code.</span></p><p class="c0"><span class="c2">There are several ways to launch the Collection Runner. You can click the </span><span class="c23">Runner Overview</span><span class="c2">&nbsp;button, the arrow next to a collection, or the </span><span class="c23">Run</span><span class="c2">&nbsp;button. As mentioned earlier, you&rsquo;ll need to develop a baseline of normal responses by sending requests with no values or expected values to the targeted field. An easy way to get such a baseline is to unselect the checkbox </span><span class="c23">Keep Variable Values</span><span class="c2 c6">. With this option turned off, your variables won&rsquo;t be used in the first collection run.</span></p><p class="c0"><span class="c2 c6">When we run this sample collection with the original request values, 13 requests pass our status code test and 5 fail. There is nothing extraordinary about this. The 5 failed attempts may be missing parameters or other input values, or they may just have response codes that are not 200. Without us making additional changes, this test result could function as a baseline.</span></p><p class="c0"><span class="c2">Now let&rsquo;s try fuzzing the collection. Make sure your environment is set up correctly, responses are saved for our review, that </span><span class="c23">Keep Variable Values</span><span class="c2">&nbsp;is checked, and that any responses that generate new tokens are disabled (we can test those requests with deep fuzzing techniques). In </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-5&amp;sa=D&amp;source=editors&amp;ust=1681144477893457&amp;usg=AOvVaw3WRjdam_MwwuvhROzKgnCx">Figure 9-5</a></span><span class="c2 c6">, you can see these settings applied.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 242.67px;"><img alt="screenshot of postman&rsquo;s collection runner results that shows requests and their responses" src="images/image10.png" style="width: 624.00px; height: 242.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-5</span><span class="c21 c9">: Postman Collection Runner results</span></p><p class="c0"><span class="c2">Run the collection and then look for deviations from the baseline responses. Also watch for changes in the request behavior. For example, when we ran the requests using the value </span><span class="c11">Fuzz1(&#39;OR 1=1-- -)</span><span class="c2 c6">, the Collection Runner passed three tests and then failed to process any additional requests. This is an indication that the web application took issue with the fuzzing attempt involved in the fourth request. Although we did not receive an interesting response, the behavior itself is an indication that you may have discovered a vulnerability.</span></p><p class="c0"><span class="c2 c6">Once you&rsquo;ve cycled through a collection run, update the fuzzing value to the next variable you would like to test, perform another collection run, and compare results. You could detect several vulnerabilities by fuzzing wide with Postman, such as improper assets management, injection weaknesses, and other information disclosures that could lead to more interesting findings. When you&rsquo;ve exhausted your fuzzing-wide attempts or found an interesting response, it is time to pivot your testing to fuzzing deep.</span></p><h3 class="c18" id="h.1m81ybc1u730"><span class="c14 c6">Fuzzing Deep with Burp Suite</span></h3><p class="c16"><span class="c2 c6">You should fuzz deep whenever you want to drill down into specific requests. The technique is especially useful for thoroughly testing each individual API request. For this task, I recommend using Burp Suite or Wfuzz.</span></p><p class="c0"><span class="c2">In Burp Suite, you can use Intruder to fuzz every header, parameter, query string, and endpoint path, along with any item included in the body of the request. For example, in a request like the one in </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-6&amp;sa=D&amp;source=editors&amp;ust=1681144477896060&amp;usg=AOvVaw2cdGTSv7gyIMvwi-kaWiX-">Figure 9-6</a></span><span class="c2 c6">, shown in Postman, with many fields in the request body, you can perform a deep fuzz that passes hundreds or even thousands of fuzzing inputs into each value to see how the API responds.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 418.67px;"><img alt="screenshot of a request in postman under edit user information; the body of the request contains the following: &ldquo;user&rdquo;: &ldquo;&lt;email&gt;&rdquo;, / &ldquo;pass&rdquo;: &ldquo;&lt;string&gt;&rdquo;, / &ldquo;id&rdquo;: &ldquo;&lt;number&gt;&rdquo;, &ldquo;name&rdquo;: &ldquo;&lt;string&gt;&rdquo;, &ldquo;is_admin&rdquo;: &ldquo;&lt;boolean&gt;&rdquo;, &ldquo;account_balance&rdquo;: &ldquo;&lt;number&gt;&rdquo;" src="images/image4.png" style="width: 624.00px; height: 418.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-6</span><span class="c21 c9">: A PUT request in Postman</span></p><p class="c0"><span class="c2 c6">While you might initially craft your requests in Postman, make sure to proxy the traffic to Burp Suite. Start Burp Suite, configure the Postman proxy settings, send the request, and make sure it was intercepted. Then forward it to Intruder. Using the payload position markers, select every field&rsquo;s value to send a payload list as each of those values. A sniper attack will cycle a single wordlist through each attack position. The payload for an initial fuzzing attack could be similar to the list described in the &ldquo;Choosing Fuzzing Payloads&rdquo; section of this chapter.</span></p><p class="c0"><span class="c2">Before you begin, consider whether a request&rsquo;s field expects any particular value. For example, take a look at the following PUT request, where the tags (</span><span class="c11">&lt; &gt;</span><span class="c2 c6">) suggest that the API is configured to expect certain values:</span></p><p class="c4"><span class="c5">PUT /api/user/edit_info HTTP/1.1</span></p><p class="c4"><span class="c5">Host: 192.168.195.132:8090</span></p><p class="c4"><span class="c5">Content-Type: application/json</span></p><p class="c4"><span class="c5">x-access-token: eyJhbGciOiJIUzI1NiIsInR5cCI...</span></p><p class="c4"><span class="c5">--snip--</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;user&quot;: &quot;&sect;&lt;email&gt;&sect;&quot;,</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;pass&quot;: &quot;&sect;&lt;string&gt;&sect;&quot;,</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;id&quot;: &quot;&sect;&lt;number&gt;&sect;&quot;,</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;name&quot;: &quot;&sect;&lt;string&gt;&sect;&quot;,</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;is_admin&quot;: &quot;&sect;&lt;boolean&gt;&sect;&quot;,</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &quot;account_balance&quot;: &quot;&sect;&lt;number&gt;&sect;&quot;</span></p><p class="c15"><span class="c5">}</span></p><p class="c0"><span class="c2 c6">When you&rsquo;re fuzzing, it is always worthwhile to request the unexpected. If a field expects an email, send numbers. If it expects numbers, send a string. If it expects a small string, send a huge string. If it expects a Boolean value (true/false), send anything else. Another useful tip is to send the expected value and include a fuzzing attempt following that value. For example, email fields are fairly predictable, and developers often nail down the input validation to make sure that you are sending a valid-looking email. Since this is the case, when you fuzz an email field, you may receive the same response for all your attempts: &ldquo;not a valid email.&rdquo; In this case, check to see what happens if you send a valid-looking email followed by a fuzzing payload. That would look something like this:</span></p><p class="c15"><span class="c5">&quot;user&quot;: &quot;hapi@hacker.com&sect;test&sect;&quot;</span></p><p class="c0"><span class="c2 c6">If you receive the same response (&ldquo;not a valid email&rdquo;), it is likely time to try a different payload or move on to a different field.</span></p><p class="c0"><span class="c2 c6">When fuzzing deep, be aware of how many requests you&rsquo;ll be sending. A sniper attack containing a list of 12 payloads across 6 payload positions will result in 72 total requests. This is a relatively small number of requests.</span></p><p class="c0"><span class="c2 c6">When you receive your results, Burp Suite has a few tools to help detect anomalies. First, organize the requests by column, such as status code, length of the response, and request number, each of which can yield useful information. Additionally, Burp Suite Pro allows you to filter by search terms.</span></p><p class="c0"><span class="c2">If you notice an interesting response, select the result and choose the </span><span class="c23">Response </span><span class="c2">tab to dissect how the API provider responded. In </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-7&amp;sa=D&amp;source=editors&amp;ust=1681144477901952&amp;usg=AOvVaw0iOh7bLvUMbzQhfY4723Q0">Figure 9-7</a></span><span class="c2">, fuzzing any field with the payload </span><span class="c11">{}[]|\:&quot;;&#39;&lt;&gt;?,./</span><span class="c2">&nbsp;resulted in an HTTP 400 response code and the response </span><span class="c11">SyntaxError: Unexpected token in JSON at position 32</span><span class="c2 c6">.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 622.67px; height: 478.67px;"><img alt="screenshot of burp suite showing an http 400 response code and a syntaxerror" src="images/image12.png" style="width: 622.67px; height: 478.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-7</span><span class="c21 c9">: Burp Suite attack results</span></p><p class="c0"><span class="c2 c6">Once you have an interesting error like this one, you could improve your payloads to narrow down exactly what is causing the error. If you figure out the exact symbol or combination of symbols causing the issue, attempt to pair other payloads with it to see if you can get additional interesting responses. For instance, if the resulting responses indicate a database error, you could use payloads that target those databases. If the error indicates an operating system or specific programming language, use a payload targeting it. In this situation, the error is related to an unexpected JSON token, so it would be interesting to see how this endpoint handles JSON fuzzing payloads and what happens when additional payloads are added.</span></p><h3 class="c18" id="h.b201b91fvv8u"><span class="c14 c6">Fuzzing Deep with Wfuzz</span></h3><p class="c16"><span class="c2 c6">If you&rsquo;re using Burp Suite CE, Intruder will limit the rate you can send requests, so you should use Wfuzz when sending a larger number of payloads. Using Wfuzz to send a large POST or PUT request can be intimidating at first due to the amount of information you&rsquo;ll need to correctly add to the command line. However, with a few tips, you should be able to migrate back and forth between Burp Suite CE and Wfuzz without too many challenges.</span></p><p class="c0"><span class="c2">One advantage of Wfuzz is that it&rsquo;s considerably faster than Burp Suite, so we can increase our payload size. The following example uses a SecLists payload called </span><span class="c2 c9">big-list-of-naughty-strings.txt</span><span class="c2 c6">, which contains over 500 values:</span></p><p class="c15"><span class="c29">$ </span><span class="c3 c6">wfuzz -z file,/home/hapihacker/big-list-of-naughty-strings.txt</span></p><p class="c0"><span class="c2">Let&rsquo;s build our Wfuzz command step-by-step. First, to match the Burp Suite example covered in the previous section, we will need to include the </span><span class="c11">Content-Type</span><span class="c2">&nbsp;and </span><span class="c11">x-access-token</span><span class="c2">&nbsp;headers in order to receive authenticated results from the API. Each header is specified with the option </span><span class="c11">-H</span><span class="c2 c6">&nbsp;and surrounded by quotes.</span></p><p class="c15"><span class="c29">$ </span><span class="c3 c6">wfuzz -z file,/home/hapihacker/big-list-of-naughty-strings.txt -H &quot;Content-Type: application/json&quot; -H &quot;x-access-token: [...]&quot;</span></p><p class="c0"><span class="c2">Next, note that the request method is PUT. You can specify it with the </span><span class="c11">-X</span><span class="c2">&nbsp;option. Also, to filter out responses with a status code of 400, use the </span><span class="c11">--hc 400</span><span class="c2 c6">&nbsp;option:</span></p><p class="c15"><span class="c29">$ </span><span class="c3 c6">wfuzz -z file,/home/hapihacker/big-list-of-naughty-strings.txt -H &quot;Content-Type: application/json&quot; -H &quot;x-access-token: [...]&quot; -p 127.0.0.1:8080:HTTP --hc 400 -X PUT</span></p><p class="c0"><span class="c2">Now, to fuzz a request body using Wfuzz, specify the request body with the </span><span class="c11">-d</span><span class="c2">&nbsp;option and paste the body into the command, surrounded by quotes. Note that Wfuzz will normally remove quotes, so use backslashes to keep them in the request body. As usual, we replace the parameters we would like to fuzz with the term </span><span class="c11">FUZZ</span><span class="c2">. Finally, we use </span><span class="c11">-u</span><span class="c2 c6">&nbsp;to specify the URL we&rsquo;re attacking:</span></p><p class="c4"><span class="c29">$ </span><span class="c3">wfuzz -z file,/home/hapihacker/big-list-of-naughty-strings.txt -H &quot;Content-Type: application/json&quot; -H &quot;x-access-token: [...]&quot; --hc 400 -X PUT -d &quot;{</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;user\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;pass\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;id\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;name\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;is_admin\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;account_balance\&quot;: \&quot;FUZZ\&quot;</span></p><p class="c15"><span class="c3 c6">}&quot; -u http://192.168.195.132:8090/api/user/edit_info</span></p><p class="c0"><span class="c2">This is a decent-sized command with plenty of room to make mistakes. If you need to troubleshoot it, I recommend proxying the requests to Burp Suite, which should help you visualize the requests you&rsquo;re sending. To proxy traffic back to Burp, use the </span><span class="c11">-p</span><span class="c2 c6">&nbsp;proxy option with your IP address and the port on which Burp Suite is running:</span></p><p class="c4"><span class="c29">$ </span><span class="c3">wfuzz -z file,/home/hapihacker/big-list-of-naughty-strings.txt -H &quot;Content-Type: application/json&quot; -H &quot;x-access-token: [...]&quot; -p 127.0.0.1:8080 --hc 400 -X PUT -d &quot;{</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;user\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;pass\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;id\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;name\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;is_admin\&quot;: \&quot;FUZZ\&quot;,</span></p><p class="c4"><span class="c3">&nbsp; &nbsp; \&quot;account_balance\&quot;: \&quot;FUZZ\&quot;</span></p><p class="c15"><span class="c3 c6">}&quot; -u http://192.168.195.132:8090/api/user/edit_info</span></p><p class="c0"><span class="c2 c6">In Burp Suite, inspect the intercepted request and send it to Repeater to see if there are any typos or mistakes. If your Wfuzz command is operating properly, run it and review the results, which should look like this:</span></p><p class="c4"><span class="c5">********************************************************</span></p><p class="c4"><span class="c5">* Wfuzz - The Web Fuzzer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</span></p><p class="c4"><span class="c5">********************************************************</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">Target: http://192.168.195.132:8090/api/user/edit_info</span></p><p class="c4"><span class="c5">Total requests: 502</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">==========================================================</span></p><p class="c4"><span class="c5">ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Response &nbsp; Lines &nbsp; &nbsp;Word &nbsp; &nbsp; &nbsp; Chars &nbsp; &nbsp; &nbsp; Payload</span></p><p class="c4"><span class="c5">==========================================================</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">000000001: &nbsp; 200 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;3 W &nbsp; &nbsp; &nbsp; &nbsp;39 Ch &nbsp; &nbsp; &nbsp; &quot;undefined - undefined - undefined - undefined - undefined - undefined&quot;</span></p><p class="c4"><span class="c5">000000012: &nbsp; 200 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;3 W &nbsp; &nbsp; &nbsp; &nbsp;39 Ch &nbsp; &nbsp; &nbsp; &quot;TRUE - TRUE - TRUE - TRUE - TRUE - TRUE&quot;</span></p><p class="c4"><span class="c5">000000017: &nbsp; 200 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;3 W &nbsp; &nbsp; &nbsp; &nbsp;39 Ch &nbsp; &nbsp; &nbsp; &quot;\\ - \\ - \\ - \\ - \\ - \\&quot;</span></p><p class="c15"><span class="c5">000000010: &nbsp; 302 &nbsp; &nbsp; &nbsp; &nbsp;10 L &nbsp; &nbsp;63 W &nbsp; &nbsp; &nbsp; &nbsp;1014 Ch &nbsp; &nbsp; &nbsp; &quot;&lt;a href=&#39;\xE2\x80...&quot;</span></p><p class="c0"><span class="c2 c6">Now you can seek out the anomalies and conduct additional requests to analyze what you&rsquo;ve found. In this case, it would be worth seeing how the API provider responds to the payload that caused a 302 response code. Use this payload in Burp Suite&rsquo;s Repeater or Postman.</span></p><h3 class="c18" id="h.smkjmk7022eo"><span class="c14 c6">Fuzzing Wide for Improper Assets Management</span></h3><p class="c16"><span class="c2 c6">Improper assets management vulnerabilities arise when an organization exposes APIs that are either retired, in a test environment, or still in development. In any of these cases, there is a good chance the API has fewer protections than its supported production counterparts. Improper assets management might affect only a single endpoint or request, so it&rsquo;s often useful to fuzz wide to test if improper assets management exists for any request across an API.</span></p><h2 class="c26" id="h.egloara665w4"><span class="c6 c25">NOTE</span></h2><p class="c30"><span class="c2 c31 c9 c38">In order to fuzz wide for this problem, it helps to have a specification of the API or a collection file that will make the requests available in Postman. This section assumes you have an API collection available.</span></p><p class="c0"><span class="c2 c6">As discussed in Chapter 3, you can find improper assets management vulnerabilities by paying close attention to outdated API documentation. If an organization&rsquo;s API documentation has not been updated along with the organization&rsquo;s API endpoints, it could contain references to portions of the API that are no longer supported. Also, check any sort of changelog or GitHub repository. A changelog that says something along the lines of &ldquo;resolved broken object level authorization vulnerability in v3&rdquo; will make finding an endpoint still using v1 or v2 all the sweeter.</span></p><p class="c0"><span class="c2">Other than using documentation, you can discover improper assets vulnerabilities through the use of fuzzing. One of the best ways to do this is to watch for patterns in the business logic and test your assumptions. For example, in </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-8&amp;sa=D&amp;source=editors&amp;ust=1681144477922333&amp;usg=AOvVaw0lBB818bOBQq8DZ72ci_9e">Figure 9-8</a></span><span class="c2">, you can see that the </span><span class="c11">baseURL</span><span class="c2">&nbsp;variable used within all requests for this collection is </span><span class="c2 c9">https://petstore.swagger.io/v2</span><span class="c2">. Try replacing</span><span class="c2 c9">&nbsp;v2</span><span class="c2">&nbsp;with </span><span class="c2 c9">v1</span><span class="c2 c6">&nbsp;and using Postman&rsquo;s Collection Runner.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 228.00px;"><img alt="screenshot of postman showing the variables tab within a collection" src="images/image11.png" style="width: 624.00px; height: 228.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-8</span><span class="c21 c9">: Editing the collection variables within Postman</span></p><p class="c0"><span class="c2">The production version of the sample API is </span><span class="c2 c9">v2</span><span class="c2">, so it would be a good idea to test a few keywords, like </span><span class="c2 c9">v1</span><span class="c2">, </span><span class="c2 c9">v3</span><span class="c2">, </span><span class="c2 c9">test</span><span class="c2">, </span><span class="c2 c9">mobile</span><span class="c2">, </span><span class="c2 c9">uat</span><span class="c2">, </span><span class="c2 c9">dev</span><span class="c2">, and </span><span class="c2 c9">old</span><span class="c2">, as well as any interesting paths discovered during analysis or reconnaissance testing. Additionally, some API providers will allow access to administrative functionality by adding </span><span class="c2 c9">/internal/</span><span class="c2 c6">&nbsp;to the path before or after the versioning, which would look like this:</span></p><ol class="c10 lst-kix_sxxvgkgwgohh-0 start" start="1"><li class="c1 li-bullet-0"><span class="c2 c9">/api/v2/</span><span class="c9 c23">internal</span><span class="c2 c31 c9">/users</span></li><li class="c1 li-bullet-0"><span class="c2 c9">/api/</span><span class="c23 c9">internal</span><span class="c2 c9 c31">/v2/users</span></li></ol><p class="c0"><span class="c2 c6">As discussed earlier in the section, begin by developing a baseline for how the API responds to typical requests using the Collection Runner with the API&rsquo;s expected version path. Figure out how an API responds to a successful request and how it responds to bad ones (or requests for resources that do not exist).</span></p><p class="c0"><span class="c2 c6">To make our testing easier, we&rsquo;ll set up the same test for status codes of 200 we used earlier in this chapter. If the API provider typically responds with status code 404 for nonexistent resources, a 200 response for those resources would likely indicate that the API is vulnerable. Make sure to insert this test at the collection level so that it will be run on every request when you use the Collection Runner.</span></p><p class="c0"><span class="c2 c6">Now save and run your collection. Inspect the results for any requests that pass this test. Once you&rsquo;ve reviewed the results, rinse and repeat with a new keyword. If you discover an improper asset management vulnerability, your next step will be to test the non-production endpoint for additional weaknesses. This is where your information-gathering skills will be put to good use. On the target&rsquo;s GitHub or in a changelog, you might discover that the older version of the API was vulnerable to a BOLA attack, so you could attempt such an attack on the vulnerable endpoint. If you don&rsquo;t find any leads during reconnaissance, combine the other techniques found in this book to leverage the vulnerability.</span></p><h2 class="c18" id="h.5qwt3d45dlgn"><span class="c20 c6">Testing Request Methods with Wfuzz</span></h2><p class="c16"><span class="c2 c6">One practical way to use fuzzing is to determine all the HTTP request methods available for a given API request. You can use several of the tools we&rsquo;ve introduced to perform this task, but this section will demonstrate it with Wfuzz.</span></p><p class="c0"><span class="c2 c6">First, capture or craft the API request whose acceptable HTTP methods you would like to test. In this example, we&rsquo;ll use the following:</span></p><p class="c4"><span class="c5">GET /api/v2/account HTTP/1.1</span></p><p class="c4"><span class="c5">HOST: restfuldev.com</span></p><p class="c4"><span class="c5">User-Agent: Mozilla/5.0</span></p><p class="c15"><span class="c5">Accept: application/json</span></p><p class="c0"><span class="c2">Next, create your request with Wfuzz, using </span><span class="c11">-X FUZZ</span><span class="c2 c6">&nbsp;to specifically fuzz the HTTP method. Run Wfuzz and review the results:</span></p><p class="c4"><span class="c29">$ </span><span class="c3">wfuzz -z list,GET-HEAD-POST-PUT-PATCH-TRACE-OPTIONS-CONNECT- -X FUZZ http://testsite.com/api/v2/account</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">********************************************************</span></p><p class="c4"><span class="c5">* Wfuzz 3.1.0 - The Web Fuzzer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</span></p><p class="c4"><span class="c5">********************************************************</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">Target: http://testsite.com/api/v2/account</span></p><p class="c4"><span class="c5">Total requests: 8</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">==========================================================</span></p><p class="c4"><span class="c5">ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Response &nbsp; Lines &nbsp; &nbsp;Word &nbsp; &nbsp; &nbsp; Chars &nbsp; &nbsp; &nbsp; Payload</span></p><p class="c4"><span class="c5">==========================================================</span></p><p class="c4 c7"><span class="c5"></span></p><p class="c4"><span class="c5">000000008: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;7 L &nbsp; &nbsp; &nbsp;11 W &nbsp; &nbsp; &nbsp; 163 Ch &nbsp; &nbsp; &nbsp;&quot;CONNECT&quot;</span></p><p class="c4"><span class="c5">000000004: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;7 L &nbsp; &nbsp; &nbsp;11 W &nbsp; &nbsp; &nbsp; 163 Ch &nbsp; &nbsp; &nbsp;&quot;PUT&quot;</span></p><p class="c4"><span class="c5">000000005: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;7 L &nbsp; &nbsp; &nbsp;11 W &nbsp; &nbsp; &nbsp; 163 Ch &nbsp; &nbsp; &nbsp;&quot;PATCH&quot;</span></p><p class="c4"><span class="c5">000000007: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;7 L &nbsp; &nbsp; &nbsp;11 W &nbsp; &nbsp; &nbsp; 163 Ch &nbsp; &nbsp; &nbsp;&quot;OPTIONS&quot;</span></p><p class="c4"><span class="c5">000000006: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;7 L &nbsp; &nbsp; &nbsp;11 W &nbsp; &nbsp; &nbsp; 163 Ch &nbsp; &nbsp; &nbsp;&quot;TRACE&quot;</span></p><p class="c4"><span class="c5">000000002: &nbsp; 200 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;0 W &nbsp; &nbsp; &nbsp; &nbsp;0 Ch &nbsp; &nbsp; &nbsp; &nbsp;&quot;HEAD&quot;</span></p><p class="c4"><span class="c5">000000001: &nbsp; 200 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;107 W &nbsp; &nbsp; &nbsp;2610 Ch &nbsp; &nbsp; &quot;GET&quot;</span></p><p class="c15"><span class="c5">000000003: &nbsp; 405 &nbsp; &nbsp; &nbsp; &nbsp;0 L &nbsp; &nbsp; &nbsp;84 W &nbsp; &nbsp; &nbsp; 1503 Ch &nbsp; &nbsp; &quot;POST&quot;</span></p><p class="c0"><span class="c2">Based on these results, you can see that the baseline response tends to include a 405 status code (Method Not Allowed) and a response length of 163 characters. The anomalous responses include the two request methods with 200 response codes. This confirms that GET and HEAD requests both work, which doesn&rsquo;t reveal much of anything new. However, this test also reveals that you can use a POST request to the </span><span class="c2 c9">api/v2/account</span><span class="c2 c6">&nbsp;endpoint. If you were testing an API that did not include this request method in its documentation, there is a chance you may have discovered functionality that was not intended for end users. Undocumented functionality is a good find that should be tested for additional vulnerabilities.</span></p><h2 class="c18" id="h.adg2i1wzblkd"><span class="c20 c6">Fuzzing &ldquo;Deeper&rdquo; to Bypass Input Sanitization</span></h2><p class="c16"><span class="c2 c6">When fuzzing deep, you&rsquo;ll want to be strategic about setting payload positions. For example, for an email field in a PUT request, an API provider may do a pretty decent job at requiring that the contents of the request body match the format of an email address. In other words, anything sent as a value that isn&rsquo;t an email address might result in the same 400 Bad Request error. Similar restrictions likely apply to integer and Boolean values. If you&rsquo;ve thoroughly tested a field and it doesn&rsquo;t yield any interesting results, you may want to leave it out of additional tests or save it for more thorough testing in a separate attack.</span></p><p class="c0"><span class="c2">Alternatively, to fuzz even deeper into a specific field, you could try to escape whatever restrictions are in place. By </span><span class="c2 c9">escaping</span><span class="c2 c6">, I mean tricking the server&rsquo;s input sanitization code into processing a payload it should normally restrict. There are a few tricks you could use against restricted fields.</span></p><p class="c0"><span class="c2 c6">First, try sending something that takes the form of the restricted field (if it&rsquo;s an email field, include a valid-looking email), add a null byte, and then add another payload position for fuzzing payloads to be inserted. Here&rsquo;s an example:</span></p><p class="c15"><span class="c5">&quot;user&quot;: &quot;a@b.com%00&sect;test&sect;&quot;</span></p><p class="c0"><span class="c2">Instead of a null byte, try sending a pipe (</span><span class="c11">|</span><span class="c2 c6">), quotes, spaces, and other escape symbols. Better yet, there are enough possible symbols to send that you could add a second payload position for typical escape characters, like this:</span></p><p class="c15"><span class="c5">&quot;user&quot;: &quot;a@b.com&sect;escape&sect;&sect;test&sect;&quot;</span></p><p class="c0"><span class="c2">Use a set of potential escape symbols for the </span><span class="c11">&sect;escape&sect;</span><span class="c2 c9">&nbsp;</span><span class="c2">payload and the payload you want to execute as the </span><span class="c11">&sect;test&sect;</span><span class="c2 c6">. To perform this test, use Burp Suite&rsquo;s cluster bomb attack, which will cycle through multiple payload lists and attempt every other payload against it:</span></p><ol class="c10 lst-kix_6xsn64yt6ht6-0 start" start="1"><li class="c1 li-bullet-0"><span class="c2 c6">Escape1</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Escape1</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Escape1</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Escape2</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Escape2</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Escape2</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload1</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload2</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload3</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload1</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload2</span></li><li class="c1 li-bullet-0"><span class="c2 c6">Payload3</span></li></ol><p class="c0"><span class="c2 c6">The cluster bomb fuzzing attack is excellent at exhausting certain combinations of payloads, but be aware that the request quantity will grow exponentially. We will spend more time with the style of fuzzing when we are attempting injection attacks in Chapter 12.</span></p><h2 class="c18" id="h.ehl3std6lr3f"><span class="c6 c20">Fuzzing for Directory Traversal</span></h2><p class="c16"><span class="c2">Another weakness you can fuzz for is directory traversal. Also known as path traversal, </span><span class="c2 c9">directory traversal</span><span class="c2">&nbsp;is a vulnerability that allows an attacker to direct the web application to move to a parent directory using some form of the expression </span><span class="c11">../</span><span class="c2 c6">&nbsp;and then read arbitrary files. You could leverage a series of path traversal dots and slashes in place of the escape symbols described in the previous section, like the following ones:</span></p><ol class="c10 lst-kix_ojb99r6iyu0u-0 start" start="1"><li class="c1 li-bullet-0"><span class="c11 c6">..</span></li><li class="c1 li-bullet-0"><span class="c11 c6">..\</span></li><li class="c1 li-bullet-0"><span class="c11 c6">../</span></li><li class="c1 li-bullet-0"><span class="c11 c6">\..\</span></li><li class="c1 li-bullet-0"><span class="c11 c6">\..\.\</span></li></ol><p class="c0"><span class="c2 c6">This weakness has been around for many years, and all sorts of security controls, including user input sanitization, are normally in place to prevent it, but with the right payload, you might be able to avoid these controls and web application firewalls. If you&rsquo;re able to exit the API path, you may be able to access sensitive information such as application logic, usernames, passwords, and additional personally identifiable information (like names, phone numbers, emails, and addresses).</span></p><p class="c0"><span class="c2 c6">Directory traversal can be conducted using both wide and deep fuzzing techniques. Ideally, you would fuzz deeply across all of an API&rsquo;s requests, but since this can be an enormous task, try fuzzing wide and then focusing in on specific request values. Make sure to enrich your payloads with information collected from reconnaissance, endpoint analysis, and API responses containing errors or other information disclosures.</span></p><h2 class="c18" id="h.84wwhbjdxfhk"><span class="c20 c6">Summary</span></h2><p class="c16"><span class="c2 c6">This chapter covered the art of fuzzing APIs, one of the most important attack techniques you&rsquo;ll need to master. By sending the right inputs to the right parts of an API request, you can discover a variety of API weaknesses. We covered two strategies, fuzzing wide and deep, useful for testing the entire attack surface of large APIs. In the following chapters, we&rsquo;ll return to the fuzzing deep technique to discover and attack many API vulnerabilities.</span></p><h2 class="c18" id="h.7we0da82tof4"><span class="c6 c33">Lab #6: Fuzzing for Improper Assets Management Vulnerabilities</span></h2><p class="c16"><span class="c2 c6">In this lab, you&rsquo;ll put your fuzzing skills to the test against crAPI. If you haven&rsquo;t done so already, build a crAPI Postman collection, as we did in Chapter 7, and obtain a valid token. Now we can start by fuzzing wide and then pivot to fuzzing deep based on our findings.</span></p><p class="c0"><span class="c2">Let&rsquo;s begin by fuzzing for improper assets management vulnerabilities. First, we&rsquo;ll use Postman to fuzz wide for various API versions. Open Postman and navigate to the environmental variables (use the eye icon located at the top right of Postman as a shortcut). Add a variable named </span><span class="c11">path</span><span class="c2">&nbsp;to your Postman environment and set the value to </span><span class="c2 c9">v3</span><span class="c2">. Now you can update to test for various versioning-related paths (such as </span><span class="c2 c9">v1</span><span class="c2">,</span><span class="c2 c9">&nbsp;v2, internal</span><span class="c2 c6">, and so on).</span></p><p class="c0"><span class="c2">To get better results from the Postman Collection Runner, we&rsquo;ll configure a test using the Collection Editor. Select the crAPI collection options, choose </span><span class="c23">Edit</span><span class="c2">, and select the </span><span class="c23">Tests </span><span class="c2 c6">tab. Add a test that will detect when a status code 404 is returned so that anything that does not result in a 404 Not Found response will stick out as anomalous. You can use the following test:</span></p><p class="c4"><span class="c5">pm.test(&quot;Status code is 404&quot;, function () {</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; pm.response.to.have.status(404);</span></p><p class="c15"><span class="c5">});</span></p><p class="c0"><span class="c2">Run a baseline scan of the crAPI collection with the Collection Runner. First, make sure that your environment is up-to-date and </span><span class="c23">Save Responses</span><span class="c2">&nbsp;is checked (see </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-9&amp;sa=D&amp;source=editors&amp;ust=1681144477945344&amp;usg=AOvVaw2Z5iRdfCFLIlVk_uxEjJx6">Figure 9-9</a></span><span class="c2 c6">).</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 358.67px; height: 533.33px;"><img alt="screenshot of postman&rsquo;s collection runner window that shows save responses as checked" src="images/image8.png" style="width: 358.67px; height: 533.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-9</span><span class="c21 c9">: Postman Collection Runner</span></p><p class="c0"><span class="c2">Since we&rsquo;re on the hunt for improper assets management vulnerabilities, we&rsquo;ll only test API requests that contain versioning information in the path. Using Postman&rsquo;s Find and Replace feature, replace the values </span><span class="c2 c9">v2</span><span class="c2">&nbsp;and </span><span class="c2 c9">v3</span><span class="c2">&nbsp;across the collection with the </span><span class="c11">path</span><span class="c2">&nbsp;variable (see </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-10&amp;sa=D&amp;source=editors&amp;ust=1681144477947341&amp;usg=AOvVaw1k0eCtuEvqw-f53kCn8oVo">Figure 9-10</a></span><span class="c2 c6">).</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 397.33px; height: 444.00px;"><img alt="screenshot of postman&rsquo;s find and replace window that shows v2 in the find box and {{path}} in the replace box" src="images/image7.png" style="width: 397.33px; height: 444.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-10</span><span class="c9 c21">: Replacing version information in the path with a Postman variable</span></p><p class="c0"><span class="c2">You may have noticed a matter of interest regarding our collection: all of the endpoints have </span><span class="c2 c9">v2</span><span class="c2">&nbsp;in their paths except for the password reset endpoint, </span><span class="c2 c9">/identity/api/auth/v3/check-otp</span><span class="c2">, which is using </span><span class="c2 c9">v3</span><span class="c2 c6">.</span></p><p class="c0"><span class="c2">Now that the variable is set, run a baseline scan with a path that we expect to fail across the board. As shown in </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-11&amp;sa=D&amp;source=editors&amp;ust=1681144477949525&amp;usg=AOvVaw1yupUC4ThqIgmDI0I-y5UO">Figure 9-11</a></span><span class="c2">, the </span><span class="c11">path</span><span class="c2">&nbsp;variable is set to a current value of </span><span class="c11">fail12345</span><span class="c2">, which is not likely to be a valid value in any endpoint. Knowing how the API reacts when it fails will help us understand how the API responds to requests for nonexistent paths. This baseline will aid our attempts to fuzz wide with the Collection Runner (see </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-12&amp;sa=D&amp;source=editors&amp;ust=1681144477950661&amp;usg=AOvVaw344ZCN7hCXJpeqNVaop9iw">Figure 9-12</a></span><span class="c2 c6">). If requests to paths that do not exist result in Success 200 responses, we&rsquo;ll have to look out for other indicators to use to detect anomalies.</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 210.67px;"><img alt="screenshot of postman&rsquo;s manage environments window that shows the variable as path, the initial value as v2, and the current value as fail12345" src="images/image3.png" style="width: 624.00px; height: 210.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-11</span><span class="c21 c9">: The improper assets management variable</span></p><p class="c17"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 305.33px;"><img alt="screenshot of postman&rsquo;s collection runner test that shows all nine requests have failed" src="images/image2.png" style="width: 624.00px; height: 305.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c24"><span class="c8">Figure 9-12</span><span class="c21 c9">: A baseline Postman Collection Runner test</span></p><p class="c0"><span class="c2">As expected, </span><span class="c13 c9"><a class="c19" href="https://www.google.com/url?q=https://learning.oreilly.com/library/view/hacking-apis/9781098130244/c09.xhtml%23figure9-12&amp;sa=D&amp;source=editors&amp;ust=1681144477952406&amp;usg=AOvVaw1fhOAAIJT4YKaLOzas50du">Figure 9-12</a></span><span class="c2">&nbsp;shows that all nine requests failed the test, as the API provider returned a status code 404. Now we can easily spot anomalies when testing for paths such as </span><span class="c2 c9">test</span><span class="c2">, </span><span class="c2 c9">mobile</span><span class="c2">, </span><span class="c2 c9">uat</span><span class="c2">, </span><span class="c2 c9">v1</span><span class="c2">, </span><span class="c2 c9">v2</span><span class="c2">, and </span><span class="c2 c9">v3</span><span class="c2">. Update the current value of the </span><span class="c11">path</span><span class="c2 c6">&nbsp;variable to these other potentially unsupported paths and run the Collection Runner again. To quickly update a variable, click the eye icon found at the top right of Postman.</span></p><p class="c0"><span class="c2">Things should start to get interesting when you return to the path values </span><span class="c2 c9">/v2</span><span class="c2">&nbsp;and </span><span class="c2 c9">/v3</span><span class="c2">. When the </span><span class="c11">path</span><span class="c2">&nbsp;variable is set to </span><span class="c2 c9">/v3</span><span class="c2">, all requests fail the test. This is slightly odd, because we noted earlier that the password reset request was using </span><span class="c2 c9">/v3</span><span class="c2 c6">. Why is that request failing now? Well, based on the Collection Runner, the password reset request is actually receiving a 500 Internal Server Error, while all other requests are receiving a 404 Not Found status code. Anomaly!</span></p><p class="c0"><span class="c2">Investigating the password reset request further will show that an HTTP 500 error is issued using the </span><span class="c2 c9">/v3</span><span class="c2">&nbsp;path because the application has a control that limits the number of times you can attempt to send the one-time passcode (OTP). Sending the same request to </span><span class="c2 c9">/v2</span><span class="c2">&nbsp;also results in an HTTP 500 error, but the response is slightly larger. It may be worth retrying the two requests back in Burp Suite and using Comparer to see the small differences. The </span><span class="c2 c9">/v3</span><span class="c2">&nbsp;password reset request responds with </span><span class="c11">{&quot;message&quot;:&quot;ERROR..&quot;,&quot;status&quot;:500}</span><span class="c2">. The </span><span class="c2 c9">/v2</span><span class="c2">&nbsp;password reset request responds with </span><span class="c11">{&quot;message&quot;:&quot;Invalid OTP! Please try again..&quot;,&quot;status&quot;:500}</span><span class="c2 c6">.</span></p><p class="c0"><span class="c2">The password reset request does not align with the baseline we have developed by responding with a 404 status code when a URL path is not in use. Instead, we have discovered an improper assets management vulnerability! The impact of this vulnerability is that </span><span class="c2 c9">/v2</span><span class="c2">&nbsp;does not have a limitation on the number of times we can guess the OTP. With a four-digit OTP, we should be able to fuzz deep and discover any OTP within 10,000 requests. Eventually, you&rsquo;ll receive a message indicating your victory: </span><span class="c11">{&quot;message&quot;:&quot;OTP verified&quot;,&quot;status&quot;:200}</span><span class="c2">.</span></p></body></html>